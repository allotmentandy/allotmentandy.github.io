<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>Allotment Andy</title>
    <link href="https://allotmentandy.github.io/blog" />
    <link type="application/atom+xml" rel="self" href="https://allotmentandy.github.io/blog/feed.atom" />
    <updated>2024-03-17T08:57:12+00:00</updated>
    <id>https://allotmentandy.github.io/blog/feed.atom</id>
    <author>
        <name>Allotment Andy</name>
    </author>
                <entry>
    <id>https://allotmentandy.github.io/blog/2024-03-05-Changing-my-Wordpress-theme-to-Go-by-Godaddy</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2024-03-05-Changing-my-Wordpress-theme-to-Go-by-Godaddy" />
    <title>Changing my Wordpress theme to Go from Go Daddy</title>
    <published>2024-03-05T00:00:00+00:00</published>
    <updated>2024-03-05T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I decided I needed to find a new theme for my wordpress website and I searched for an open source theme which was fast. I also wanted a plain looking template which worked with the modern blocks approach to Wordpress that I have been resisting.

This is......</summary>
    <content type="html"><![CDATA[
        <p>I decided I needed to find a new theme for my wordpress website and I searched for an open source theme which was fast. I also wanted a plain looking template which worked with the modern blocks approach to Wordpress that I have been resisting.</p>

<p>This is a screenshot of the original frontpage, which looks a little clumsy. <a href="https://co.wordpress.org/themes/minimal-grid/">Minimal Grid</a></p>

<p><img src="/assets/images/ilminster_blog_minimal.jpg" alt="Minimal Grid Wordpress Theme" /></p>

<p>To test the loading time of the current site i installed this <a href="https://wordpress.org/plugins/code-profiler">wp-cli extension called code-profiler</a></p>

<pre><code>wp code-profiler run --url=https://ilminster.net/

 ➤ 15 plugins and 1 theme
 ➤ Execution time: 0.4013s
 ➤ Peak memory: 64.43 MB
 ➤ File I/O operations: 7,343
 ➤ SQL queries: 51
 ➤ Accuracy: Highest
</code></pre>

<p>After testing out a few Wordpress themes, I settled on <a href="https://wordpress.org/themes/go/">Go</a> which is fast, free and powerful. It is also a simple design. There is an activate <a href="https://wordpress.org/support/theme/go/">go support page</a></p>

<p>The features i want over the old theme include:</p>

<ul>
<li>a top navigation bar</li>
<li>more obvious search facility</li>
<li>featured image integration as a hero banner</li>
<li>simple menu management for the header and footer</li>
<li>faster loading</li>
<li>no css in the html</li>
</ul>

<p>So I set about updating my localhost version to see how it works.</p>

<p>to install the go theme with wp-cli i entered</p>

<pre><code>wp theme install go
</code></pre>

<p>and activated it in the themes page.</p>

<p>It required a bit of change to a few pages as it also uses the new guttenburg blocks editor and I had been resisting changing to that so I disabled the classic editor plugin.</p>

<p><img src="/assets/images/ilminster_blog_go.png" alt="Minimal Grid Wordpress Theme" /></p>

<p>I like the look of it and hope you do to.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2024-02-02-Seo-Awesome-Perplexity-ai-github-repo</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2024-02-02-Seo-Awesome-Perplexity-ai-github-repo" />
    <title>Seo Awesome Perplexity.ai Github Repo</title>
    <published>2024-02-02T00:00:00+00:00</published>
    <updated>2024-02-02T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">My last post was about making the &#039;Awesome perplexity.ai&#039; page on Github.

It was indexed within an hour on both DuckDuckGo and Bing, but still not indexed directly on Google.

I have written a tweet about it, but wanted to try out the different AI&#039;s to......</summary>
    <content type="html"><![CDATA[
        <p>My last post was about making the <a href="https://github.com/allotmentandy/Awesome-perplexity.ai">'Awesome perplexity.ai'</a> page on Github.</p>

<p>It was indexed within an hour on both DuckDuckGo and Bing, but still not indexed directly on Google.</p>

<p>I have written a tweet about it, but wanted to try out the different AI's to try and solve why it isnt featured in Google.</p>

<p><img src="/assets/images/awesome_perplexity-ai.jpg" alt="twitter post" /></p>

<p>So firstly I asked Google Bard and it couldnt see the page</p>

<p><img src="/assets/images/bard_awesome_perplexity_ai.png" alt="google bard" /></p>

<p>After having a good search, I basically discovered I cannot submit a github repo and will have to wait for google to index it with time.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2024-01-26-Awesome-perplexity-ai</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2024-01-26-Awesome-perplexity-ai" />
    <title>Awesome perplexity ai</title>
    <published>2024-01-26T00:00:00+00:00</published>
    <updated>2024-01-26T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I have been using perplexity.ai which is a LLM ai tool which is a lot better than a search engine.

I have made an &#039;Awesome perplexity.ai&#039; page on github which is a list of awesome links to perplexity.ai and the world it is creating.

I have......</summary>
    <content type="html"><![CDATA[
        <p>Today I have been using perplexity.ai which is a LLM ai tool which is a lot better than a search engine.</p>

<p>I have made an <a href="https://github.com/allotmentandy/Awesome-perplexity.ai">'Awesome perplexity.ai'</a> page on github which is a list of awesome links to perplexity.ai and the world it is creating.</p>

<p>I have changed the default search engine in my broswer to perplexity.ai</p>

<p>and made a <a href="https://twitter.com/i/lists/1750921775251071019">twitter list</a> with links to twitter perplexity staff</p>

<p>and now i want to know how long it will take until perplexity.ai knows about the <a href="https://github.com/allotmentandy/Awesome-perplexity.ai">'Awesome perplexity.ai'</a> page on github</p>

<p>Here is a link to a search looking for the <a href="https://www.perplexity.ai/search/is-there-an-07.GAJrgQvarajPdxYItcA?s=c#d3bf8600-9ae0-42f6-ab6a-33ddc5822d70">awesome perplexity.ai</a> page, but i am not sure if it will update in realtime.</p>

<p>very cool</p>

<p>update 18.14 <a href="https://www.bing.com/search?form=&amp;q=awesome+perplexity.ai+github">Bing has found it</a></p>

<p>update 18.23 <a href="https://duckduckgo.com/?q=+github+awesome+perplexity.ai&amp;ia=web">Duckduckgo has found it</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2024-01-06-Update-on-yesterdays-article-about-seo-301-redirect-issue</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2024-01-06-Update-on-yesterdays-article-about-seo-301-redirect-issue" />
    <title>Update on yesterdays article about seo 301 redirect issue</title>
    <published>2024-01-06T00:00:00+00:00</published>
    <updated>2024-01-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Yesterdays post on SEO terms that I wrote about keyword targetting has been indexed by Google, Bing and DuckDuckGo, but there are issues with a 301 redirect.





It is good that it has been indexed so quickly and is the top result for this search, but......</summary>
    <content type="html"><![CDATA[
        <p>Yesterdays post on SEO terms that I wrote about keyword targetting has been indexed by Google, Bing and DuckDuckGo, but there are issues with a 301 redirect.</p>

<p><img src="/assets/images/ddg301.png" alt="ddg 301 redirect error" /></p>

<p><img src="/assets/images/bing301.png" alt="bing 301 redirect" /></p>

<p>It is good that it has been indexed so quickly and is the top result for this search, but the fix seems to be adding the end slash to the url.</p>

<p>the <a href="https://github.com/tighten/jigsaw/issues/679">last github issue</a> was an issue about trailing slashes, so my fix is to hardcode the endslash in the blog list and the pagination which i think is the problem.</p>

<p>I will monitor the situation with these links and see what happens as this is indexed over the next 24 hours.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2024-01-05-Finding-work-via-SEO-Ansible-Linux-Devops-PHP-CSS</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2024-01-05-Finding-work-via-SEO-Ansible-Linux-Devops-PHP-CSS" />
    <title>Finding work via SEO Ansible Linux Devops PHP CSS</title>
    <published>2024-01-05T00:00:00+00:00</published>
    <updated>2024-01-05T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">SEO terms and what people search for when looking for a Ansible Linux Devops PHP CSS worker...</summary>
    <content type="html"><![CDATA[
        <p>One thing that interests me today is the idea of the industry and the market. The industry is what is on offer to the world and the market is the people looking for a product or service. These dont really match as the industry tries to provide things they think will be in demand, and the market wants things that isnt exactly produced.</p>

<p>This blog is an attempt by me to match what i can offer to those that want some sort of service that i offer.</p>

<p>I have written about the things I can offer on <a href="https://allotmentandy.github.io/blog/2023-11-28-The-sort-of-jobs-I-am-looking-for/">this blog</a> which is currently linked from each of these pages in the icon bar at the top of the page.</p>

<p>What this blog is about is exploring how people search for people who use these technologies and try and get them to find me. A fair number of these skillsets overlap, but I have tried to focus on logical units</p>

<h2>Ansible Terraform</h2>

<details>
<summary>Ansible Terraform SEO keywords</summary>
<pre>
Infrastructure as Code 
Cloud automation
Ansible freelancer
Ansible consultant
DevOps automation freelancer
Infrastructure automation freelancer
Configuration management freelancer
Ansible playbooks
Ansible roles
Ansible modules
Ansible Galaxy
Ansible Tower
Terraform providers
Terraform modules
Terraform state
Terraform Cloud
Terraform freelancer UK
Terraform consultant 
Terraform infrastructure as code expert
DevOps with Terraform
Cloud automation with Terraform
AWS Terraform freelancer
Azure Terraform consultant
GCP Terraform specialist
Multi-cloud Terraform expertise
Terraform security best practices
</pre>
</details>

<h2>AWS Debian Linux</h2>

<details>
<summary>Debian Linux SEO keywords</summary>
<pre>
AWS Linux freelance
AWS Linux consulting
Linux on AWS
AWS for startups
Cloud migration Linux
AWS DevOps
AWS automation
Security hardening AWS Linux
AWS CloudFormation consulting
Ansible automation Linux on AWS
Terraform configuration for AWS Linux
Jenkins configuration for AWS
Cloudwatch monitoring for AWS Linux
AWS Lambda development
Cloudtrail logging configuration
AWS security groups and IAM roles
Troubleshooting AWS Linux issues
AWS Linux for healthcare
AWS Linux for SaaS
</pre>
</details>

<h2>Linux Bash Shell Scripting</h2>

<details>
<summary>Linux Bash Shell SEO keywords</summary>
<pre>
Linux Bash shell scripting
Bash shell scripting freelancer
Bash scripting expert
Automation scripting Linux
Shell scripting services
Hire Bash scripter
Linux script writer
Shell scripting for DevOps
System administration scripting
Bash scripting for automation
Cloud automation scripting
Network automation scripting
Security scripting Linux
Big data scripting Bash
Scripting for web development
</pre>
</details>

<h2>Docker Kubernetes Devops</h2>

<details>
<summary>Devops SEO keywords</summary>
<pre>
DevOps freelancer
DevOps Engineer 
Automation Specialist
IT automation
Infrastructure as code
AWS Devops
Azure Devops
GCP Devops 
</pre>
</details>

<h2>PHP Laravel</h2>

<details>
<summary>PHP Laravel SEO keywords</summary>
<pre>
Laravel developer freelance
PHP freelance developer
Web development freelance Laravel
Hire Laravel freelancer
Expert Laravel programmer freelance
PHP/Laravel consultant
</pre>
</details>

<h2>Tailwind CSS</h2>

<details>
<summary>Tailwind CSS SEO keywords</summary>
<pre>
Tailwind CSS developer
Tailwind CSS designer
Front-end developer
UI/UX designer 
Responsive web design 
Pixel-perfect development 
Custom website design 
Landing page design 
Web app development 
Shopify website development 
WordPress website development 
CSS framework
Utility-first CSS
Rapid prototyping
Performance optimization
Pixel perfect design
Mobile-first design
</pre>
</details>

<h2>Wordpress</h2>

<details>
<summary>Wordpress SEO Keywords</summary>
<pre>
WordPress freelancer
WordPress developer
WordPress designer
Hire a WordPress expert
WordPress website development
WordPress website maintenance
WordPress e-commerce development
WordPress theme customization
WordPress plugin development
WordPress security
WordPress SEO optimization
WordPress speed optimization
WordPress website migration
WordPress content creation
WordPress backup and recovery
WordPress troubleshooting
</pre>
</details>

<p>What I am actually interested in, is what people ACTUALLY type into search engines when looking for roles in these areas.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-12-16-Setting-up-Docker,-Kubernetes,-AWS-and-the-environment-for-my-adventure</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-12-16-Setting-up-Docker,-Kubernetes,-AWS-and-the-environment-for-my-adventure" />
    <title>Setting up Docker, Kubernetes and AWS</title>
    <published>2023-12-16T00:00:00+00:00</published>
    <updated>2023-12-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">The first task I have undertaken is to update my Ansible repo to install the Docker and Kubernetes software I will need for this adventure.

I have used Docker quite a bit in the past and it allows one to create a Dockerfile which is a set of......</summary>
    <content type="html"><![CDATA[
        <p>The first task I have undertaken is to update my <a href="https://github.com/allotmentandy/ansible-debian-install-desktop/blob/main/roles/aws/tasks/main.yml">Ansible repo</a> to install the Docker and Kubernetes software I will need for this adventure.</p>

<p>I have used Docker quite a bit in the past and it allows one to create a Dockerfile which is a set of instructions to build an image which should work in any docker environment. I come from a PHP / Laravel background, so I think my first project will be to get a Kubernetes install to serve a Laravel app on AWS with a single node.</p>

<iframe src="https://youtube.com/embed/T6C4EuVtYbw" style="width:600px; height:400px;"></iframe>

<p>This is the <a href="https://github.com/LeVadim/kubernetes-react-js/blob/master/Dockerfile">corresponding github repo</a> and is the dockerfile i will use as i follow <a href="https://www.youtube.com/playlist?list=PLThHiP8CCGTKjQzqGrPyOWAvSWM_7ty0f">this video series</a>.</p>

<p>To get up and running with kubernetes, i decided to try minikube. I have added this to the ansible playbook but the first run of the <code>minikube start</code> command compalined that there was no driver</p>

<p>then i used <code>minikube start --driver=docker</code> which resulted in a permission error like so:</p>

<pre><code>Exiting due to PROVIDER_DOCKER_NEWGRP: "docker version --format -:" exit status 1: permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.24/version": dial unix /var/run/docker.sock: connect: permission denied

Suggestion: Add your user to the 'docker' group: 'sudo usermod -aG docker $USER &amp;&amp; newgrp docker'
</code></pre>

<p>so i added the user, but this didnt fix the issue, but this did</p>

<pre><code>chmod 666 /var/run/docker.sock
</code></pre>

<p>now i can set the default to docker with <code>minikube config set driver docker</code> so now starting minikube produced:</p>

<pre><code>😄  minikube v1.30.1 on Debian kali-rolling
✨  Using the docker driver based on user configuration
📌  Using Docker driver with root privileges
👍  Starting control plane node minikube in cluster minikube
🚜  Pulling base image ...
💾  Downloading Kubernetes v1.26.3 preload ...
    &gt; preloaded-images-k8s-v18-v1...:  397.02 MiB / 397.02 MiB  100.00% 4.14 Mi
    &gt; gcr.io/k8s-minikube/kicbase...:  373.53 MiB / 373.53 MiB  100.00% 3.09 Mi



🔥  Creating docker container (CPUs=2, Memory=2800MB) ...
🐳  Preparing Kubernetes v1.26.3 on Docker 23.0.2 ...
    ▪ Generating certificates and keys ...
    ▪ Booting up control plane ...
    ▪ Configuring RBAC rules ...
🔗  Configuring bridge CNI (Container Networking Interface) ...
🔎  Verifying Kubernetes components...
❗  Executing "docker container inspect minikube --format={{.State.Status}}" took an unusually long time: 18.517914147s
💡  Restarting the docker service may improve performance.
🌟  Enabled addons: storage-provisioner, default-storageclass

❗  /usr/bin/kubectl is version 1.28.2, which may have incompatibilities with Kubernetes 1.26.3.
    ▪ Want kubectl v1.26.3? Try 'minikube kubectl -- get pods -A'
🏄  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
</code></pre>

<p>but  <code>minikube dashboard</code> didnt fancy it.</p>

<pre><code>❗  Executing "docker container inspect minikube --format={{.State.Status}}" took an unusually long time: 2.222619049s
💡  Restarting the docker service may improve performance.
🔌  Enabling dashboard ...
    ▪ Using image docker.io/kubernetesui/dashboard:v2.7.0
    ▪ Using image docker.io/kubernetesui/metrics-scraper:v1.0.8
💡  Some dashboard features require the metrics-server addon. To enable all features please run:

    minikube addons enable metrics-server


🤔  Verifying dashboard health ...
🚀  Launching proxy ...
🤔  Verifying proxy health ...
panic: send on closed channel

goroutine 107 [running]:
k8s.io/minikube/cmd/minikube/cmd.readByteWithTimeout.func2()
    /app/cmd/minikube/cmd/dashboard.go:192 +0x67
created by k8s.io/minikube/cmd/minikube/cmd.readByteWithTimeout
    /app/cmd/minikube/cmd/dashboard.go:187 +0x158
</code></pre>

<p>I think there was an issue with the ram, as i had so many browser windows searching for the answers, but shutting most of them down, allowed me to start the dashboard and i saw this</p>

<p><img src="/assets/images/minikube_dashboard.png" alt="Minikube dashboard" /></p>

<p>Which is a great start, I am now going to work out how to deploy a Dockerfile app! wish me luck</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-12-15-The-Mysteries-of-Docker-and-Kubernetes-A-Christmas-Learning-Adventure</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-12-15-The-Mysteries-of-Docker-and-Kubernetes-A-Christmas-Learning-Adventure" />
    <title>The Mysteries of Docker and Kubernetes A Christmas Learning Adventure</title>
    <published>2023-12-15T00:00:00+00:00</published>
    <updated>2023-12-15T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">As the festive season approaches, bringing with it a lull in the usual hustle and bustle of work and life, it&#039;s the perfect time to embark on a journey of learning and self-improvement. And what better way to enhance tech skills and prepare for the......</summary>
    <content type="html"><![CDATA[
        <p>As the festive season approaches, bringing with it a lull in the usual hustle and bustle of work and life, it's the perfect time to embark on a journey of learning and self-improvement. And what better way to enhance tech skills and prepare for the future of software development than by diving into the world of Kubernetes?</p>

<p>Kubernetes, a container orchestration platform, has revolutionized the way applications are deployed, managed, and scaled. Its popularity has soared in recent years, making it an essential skill for anyone seeking to advance their career in DevOps or cloud computing.</p>

<p>Why Choose Christmas for Kubernetes Learning?</p>

<p>The Christmas break offers a unique opportunity to delve into the intricacies of Kubernetes without the distractions of everyday commitments. With ample time on your hands, you can dedicate yourself to learning at your own pace and focus on mastering the core concepts without the pressure of deadlines or meetings.</p>

<p>Benefits of Learning Kubernetes This Winter</p>

<p>Enhance Your Tech Skills: Kubernetes is a complex technology, but mastering it can significantly elevate your skillset. Learning Kubernetes will make you a more valuable asset to any organization, opening up new career opportunities and earning potential.</p>

<p>Stay Ahead of the Curve: Kubernetes is the de-facto standard for container orchestration, and its adoption is only going to grow in the years to come. By learning Kubernetes now, you'll be well-positioned to ride this wave of technological innovation.</p>

<p>Personal Accomplishment: Mastering a challenging technology like Kubernetes is a significant personal achievement. It will boost your confidence and resilience, preparing you for future learning and professional challenges.</p>

<p>How to Embark on Your Kubernetes Learning Journey</p>

<p>Start with the Basics: Begin by understanding the fundamentals of containers and Docker, the foundation upon which Kubernetes is built.</p>

<p>Explore Online Courses and Tutorials: There are numerous high-quality online resources available to guide you through the learning process. Choose courses that align with your learning style and experience level.</p>

<p>Practice and Experiment: Hands-on practice is essential for solidifying your understanding of Kubernetes. Set up a personal Kubernetes cluster and experiment with deploying, managing, and scaling applications.</p>

<p>Join the Kubernetes Community: Engage with the active Kubernetes community through forums, online groups, and social media. Seek help, share knowledge, and contribute to the open-source project.</p>

<p>Learning Kubernetes during the Christmas break is an excellent way to invest in your future and prepare for the ever-evolving landscape of software development. With dedication and perseverance, you can master this powerful technology and reap the rewards of a rewarding career in cloud computing and DevOps. So, grab your laptop, embrace the spirit of learning, and embark on your Kubernetes journey today!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-12-12-Support-for-windows-11-and-10-from-a-linux-debian-user</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-12-12-Support-for-windows-11-and-10-from-a-linux-debian-user" />
    <title>Support for Windows 11 and 10 from a Linux Debian user</title>
    <published>2023-12-12T00:00:00+00:00</published>
    <updated>2023-12-12T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have been using Debian Linux and similar flavours of Linux for many years as my main desktop, but supporting ordinary people, I have to use windows too. So i decided i needed a new windows machine to experiment with and I got one. It is a lovely Dell......</summary>
    <content type="html"><![CDATA[
        <p>I have been using Debian Linux and similar flavours of Linux for many years as my main desktop, but supporting ordinary people, I have to use windows too. So i decided i needed a new windows machine to experiment with and I got one. It is a lovely Dell XPS which is much lighter than this Acer laptop, and today I set it up.</p>

<p>One of the best features of the Debian Linux environment is apt-get, apt or aptitude. You can search for and install software with ease, you can update the system when you want and it is reliable. With this in mind, I have discovered <a href="https://chocolatey.org/">Chocolatey</a> the package manager for windows and it is great.</p>

<p>So far i have installed Filezilla, Firefox, QuiteRss, Sublime Text and VS Code with this sort of command I will use to install some more</p>

<pre><code>choco install chocolateygui
choco install libreoffice-fresh
choco install opera
choco install zeal
</code></pre>

<p>There is a <a href="https://community.chocolatey.org/packages">chocolatey search engine</a> where you can search for software. or you can search with</p>

<pre><code>choco search wordpress
</code></pre>

<p>which provides a similar search to 'apt-cache search wordpress'</p>

<p>I tried to install 'googlechrome' but there was an error with the checksum, so that didn't work, but i have Edge, Firefox, Brave and Opera Browsers to use too, so thats no biggie!</p>

<p>I have used Windows a lot in the past and after installing Git, I managed to use Git Bash, which is more like a normal linux terminal.</p>

<p>It would be nice to have a WAMP type PHP and mysql server to play with too, i wonder what is installed with just composer, will it install dependencies?</p>

<pre><code>choco install composer
</code></pre>

<p>There are also windows only tools, so I can also install this seo tool:</p>

<pre><code>choco install screamingfrog
</code></pre>

<p>and also try this</p>

<pre><code>choco install photogimp
</code></pre>

<p>This all makes it a breeze to install software in a predictable manner.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-12-04-Scraping-Racing-Post-Horse-Prediction-System-Tips</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-12-04-Scraping-Racing-Post-Horse-Prediction-System-Tips" />
    <title>Scraping Racing Post Horse Prediction System Tips</title>
    <published>2023-12-04T00:00:00+00:00</published>
    <updated>2023-12-04T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I discovered a tool for scraping the racing post on github and it worked. It was simple to download the entire days racing cards into a json file with the command



So my weekends coding project was a php parser to analyse this json and suggest the......</summary>
    <content type="html"><![CDATA[
        <p>I discovered a tool for <a href="https://github.com/joenano/rpscrape/">scraping the racing post</a> on github and it worked. It was simple to download the entire days racing cards into a json file with the command</p>

<pre><code>./racecards.py today
</code></pre>

<p>So my weekends coding project was a php parser to analyse this json and suggest the horses who will win.</p>

<p>I installed 2 packages with composer</p>

<pre><code>composer require cerbero/json-parser
composer require nunomaduro/termwind
</code></pre>

<p>The parser was to simplify the json parsing and the termwind to colorize the output.</p>

<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

use Cerbero\JsonParser\JsonParser;
use function Termwind\{render};

$source = '../racecards/2023-12-04.json';

$json = JsonParser::parse($source);

foreach ($json as $key =&gt; $value) {

    if ($key == "GB"){

        foreach ($value as $key =&gt; $value) {

        echo "-----------------------" . PHP_EOL;
        render('&lt;div class="px-1 text-red"&gt;' . $key . '&lt;/div&gt;');
        echo "-----------------------" . PHP_EOL;

            foreach ($value as $key =&gt; $value) {
                render("&lt;p class='text-blue'&gt;". $key ." " . $value['race_name'] ." ". "&lt;span class='text-green'&gt;". $value['prize']. "&lt;/span&gt;&lt;/p&gt;"); // time
                    foreach ($value as $key =&gt; $value) {
                        if ($key == "runners"){
                            foreach ( $value as $horse) {

                                $firstOrSecondOrThird = substr_count($horse['form'], '1') + substr_count($horse['form'], '2') + substr_count($horse['form'], '3')  ;
                                $BadForm = substr_count($horse['form'], 'P');
                                $negs = - $BadForm;
                                if (!$horse['rpr']) {$negs--;}
                                if (!$horse['ts']) {$negs--;}
                                if (!$horse['trainer_rtf']) {$negs--;}

                                $score =  $horse['ofr'] + $horse['rpr'] + $horse['ts']; 

                                $darkout = "";
                                if ($negs &lt; 0){$darkout = "text-gray-700";}
                                if ($firstOrSecondOrThird &lt; 1){$darkout = "text-gray-700";}

                                render(" &lt;p class='p-0 pl-1 m-0 ".$darkout ." '&gt; ". 
                                        str_pad($horse['number'], 2, ".", STR_PAD_LEFT) . " " . 
                                        str_pad($horse['form'], 6, ".", STR_PAD_LEFT) . " " . 
                                        '&lt;span class="text-yellow"&gt;' . str_pad( $horse['name'], 20, ".", STR_PAD_RIGHT ) . '&lt;/span&gt; ' . " " .  

                                        str_pad($horse['age'], 2, ".", STR_PAD_LEFT) . " " . 
                                        str_pad($horse['lbs'], 3, ".", STR_PAD_LEFT) . " " . 

                                        str_pad($horse['ofr'], 3, ".", STR_PAD_LEFT) . " " . 
                                        str_pad($horse['rpr'], 3, ".", STR_PAD_LEFT) . " " . 
                                        str_pad($horse['ts'], 3, ".", STR_PAD_LEFT) . " " . 
                                        str_pad($horse['last_run'], 10, ".", STR_PAD_LEFT) . " " . 

                                        str_pad($horse['jockey'], 22, ".", STR_PAD_RIGHT) . " " . 

                                        str_pad($horse['trainer'], 34, ".", STR_PAD_RIGHT) . " " . 
                                        str_pad($horse['trainer_location'], 28, ".", STR_PAD_RIGHT) . " " . 
                                        str_pad($horse['trainer_rtf'], 3, ".", STR_PAD_LEFT) . " " . 

                                        $firstOrSecondOrThird . " " .
                                        $score . " " .
                                        $negs .

                                        "&lt;/p&gt;". PHP_EOL);
                            }
                        }
                    }
            }
        }
    }
}

</code></pre>

<p>This provided a pretty output with a basic value to predict the best horses judging by the form.</p>

<p><img src="/assets/images/horse-racing-system-tips.jpg" alt="racing post horse racing tip system" /></p>

<p>the last 3 columns are a positive factor, total ratings and a negative factor. The greyed out horses are those that failed the basic tests I have coded which are rather basic, but a start.</p>

<p>The next version will load the horses for the race into and array and output them in the order of the score, also it will fade out non-runners and calculate the score in a function. I would also like to output a header for the columns/</p>

<p>I couldn't get the str_pad function to work with spaces, so I used dots which is ok.</p>

<p>I am interested in how people weight the factors, at the moment, it is all a factor of 1, with a negative sign being a missing value. I am going to test it out over the next few days and see how it works.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-11-28-The-sort-of-jobs-I-am-looking-for</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-11-28-The-sort-of-jobs-I-am-looking-for" />
    <title>The sort of work I am looking for</title>
    <published>2023-11-28T00:00:00+00:00</published>
    <updated>2023-11-28T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Skills I have to offer employers and the sort of roles I am available for....</summary>
    <content type="html"><![CDATA[
        <p>I am an all rounder with a wide range of skills acquired over 25 years working in the IT world and online. I enjoy using computers and support a number of people locally using Macs, Windows and Linux. I am looking for more work and would like to describe some of the things I am good at, so the sort of job I would like to find involves some of the following:</p>

<h2>Website Management</h2>

<p>I can assist you in running your website in several ways. I can help you create content for your website, such as blog posts, articles, and marketing materials. I can also help you optimize your website for search engines so that it appears higher in search results. Additionally, I can help you monitor your website's traffic and performance so that you can make data-driven decisions about how to improve your website.</p>

<h2>IT Support</h2>

<p>I have used Macs, Windows and Linux for over 25 years and have a vast range of knowledge which can be useful to any firm. I can fix most problems and get you up and running. visit my <a href="https://ilminster.net/it-support/">IT Support page on ilminster.net</a></p>

<h2>Ansible &amp; Terraform</h2>

<p>This is a configuration tool which allows you to run a command to setup 1 or more computers in a logical and systematic way. I really like it and have used it to setup my main computer. Here is a link to my <a href="https://github.com/allotmentandy/ansible-debian-install-desktop">ansible playbook on github</a></p>

<h2>Bash Shell Scripting</h2>

<p>Bash shell scripting is a powerful tool for DevOps engineers and system administrators to automate tasks, manage infrastructure, and perform backups. Bash scripts are simple text files that contain a series of commands that are executed by the Bash shell. They can be used to perform a wide variety of tasks, such as installing software, configuring servers, and backing up data.</p>

<h2>PHP, Laravel &amp; Wordpress website management</h2>

<p>My main language is PHP and I have used Laravel and Wordpress for many years. Get in touch if you need help with your website.</p>

<h2>Web Design and Development</h2>

<p>I am comfortable with PHP and Laravel, CSS, Bootstrap, Tailwind CSS and understand web technologies.</p>

<h2>Linux, Devops, AWS and the Cloud</h2>

<p>I moved to using Debian Linux as my main computer many years ago, and have a fair amount of knowledge of running linux as a desktop. As part of my focus on Devops, I have also experience with Centos, Ubuntu and other Linux systems (alongside Windows and Apple Mac)</p>

<p>If you need any of these services I am available to work at the moment. Get in touch...</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-11-13-Hard-Drive-Failure-rebuilding-Debian-from-Backups</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-11-13-Hard-Drive-Failure-rebuilding-Debian-from-Backups" />
    <title>Hard Drive Failure rebuilding Debian from Backups</title>
    <published>2023-11-13T00:00:00+00:00</published>
    <updated>2023-11-13T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Yesterday afternoon, my hard drive failed. I had made a comprehensive backup the day before, but it is still a pain to build a new system from scratch. The hard drive had been quite noisy and I had been toying with the idea of starting a new machine, but......</summary>
    <content type="html"><![CDATA[
        <p>Yesterday afternoon, my hard drive failed. I had made a comprehensive backup the day before, but it is still a pain to build a new system from scratch. The hard drive had been quite noisy and I had been toying with the idea of starting a new machine, but this event forced me to.</p>

<p>Starting with a new hard drive, i installed the latest Debian 12 os with a usb stick. It is far quicker than years ago, and i had an OS installed in less than an hour.</p>

<p>I also used an <a href="https://github.com/allotmentandy/ansible-debian-install-desktop">ansible playbook</a> I made in the past, which installed browsers, text editors, games and more. This makes the process much easier, but I had to update it a little to add a few more apps to be installed and remove a couple that have disappeared from the debian repo. Another example is the rapid rate of new php versions. I have been using php 8.1 but now version 8.3 of php is available in the debian repo.</p>

<p>So after about an hour, ansible had installed all the software including a lamp server stack, including php versions 8.0, 8.1 and 8.2, apache and a maria/mysql database.</p>

<p>I keep regular backups of the /www directory with the 4 main projects I work on and backups of the databases are easy to reimport.</p>

<p>But one problem I found was the computer didnt sleep / suspend properly. I noticed that the kernel image was only 6.1 so I have decided to add a Kali Linux repo into the apt sources which should give me a 6.5 kernel which hopefully will let me fix the suspend problem. This was solved by changing the default display manager to gdm3 from lightdm as this was set in the install and it did work as I wanted</p>

<p>edit '/etc/X11/default-display-manager' and change it to</p>

<pre><code>/usr/sbin/gdm3
</code></pre>

<p>in the setup process i had to chose between the window manager lightdm and gdm3. changing it to gdm3 fixed my shutdown, brightness and boot issue.</p>

<h2>Ansible playbook improvements to look into</h2>

<ul>
<li>check for deb repos existing in the sources. (duplicates seem to appear)</li>
<li>install more browsers, opera, microsoft edge, palemoon</li>
<li>add php 8.3</li>
<li>browser extensions</li>
<li>VS code extensions</li>
<li>add mysql root user to the mysql setup<br />
<code>ALTER USER 'root'@'localhost' IDENTIFIED BY 'newPassword';
flush privileges;
exit;</code></li>
</ul>

<h2>Backup improvements to do</h2>

<ul>
<li>zip up the thunderbird archive, instead of thousands of files.</li>
<li>browser extensions, install for each browser</li>
<li>dump bookmarks from each browser</li>
<li>automate a db dump of the key mysql dbs/tables</li>
<li>create zips of the web server files without the 'node_modules' and 'vendor' directories</li>
<li>ssh keys</li>
</ul>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-10-31-Using-Linkedin-for-social-interaction-and-Wordpress-part-time-or-contract-job-hunting</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-10-31-Using-Linkedin-for-social-interaction-and-Wordpress-part-time-or-contract-job-hunting" />
    <title>Using Linkedin for social interaction and Wordpress part time or contract job hunting</title>
    <published>2023-10-31T00:00:00+00:00</published>
    <updated>2023-10-31T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Last night on Twitter, I was disussing the lack of interaction on my tweets and someone suggested Linkedin was much better for getting more comments, messages and replies. I havent used Linkedin much, but I had been meaning to give it a try in my attempt......</summary>
    <content type="html"><![CDATA[
        <p>Last night on Twitter, I was disussing the lack of interaction on my tweets and someone suggested Linkedin was much better for getting more comments, messages and replies. I havent used Linkedin much, but I had been meaning to give it a try in my attempt to find a new project to work on.</p>

<p>I have over 25 years of web experience and recently moved to Somerset for a simpler life. I am looking for a project (possibly Wordpress based) to get my teeth into. I have a vast range of experience from Graphics, Design, Web Development, Copywriting, Web Servers, Cloud Computing and more.</p>

<p>The reason I like Wordpress, is that I started with a website for the local festival, it was running well, but just needed tidying up. I found a new theme and improved all the content and the festival went well.</p>

<p>Then I registered a domain to try and sell my services and developed a theme from scratch and started work on a plugin. This is going live this week and is a mix of pages for the services, with blog posts about the jobs I have done as I do them. I like this combination as it means I can write more posts without the pages being changed.</p>

<p>But this leads me to a number of questions:</p>

<pre><code>What plugin features would you like to see? 
I have developed a basic plugin using a few hooks and subpages, but would like to hear about what should I build to impress you. 

What theme specs are you looking for? 
I have worked with both tailwind css and bootstrap alongside jquery, but again, what would you like to see.
</code></pre>

<p>If you have any wordpress roles or projects, lets discuss them. I tend to use cv-library for job searches, so my cv is on there.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-10-25-Using-WP-CLI-to-manage-a-wordpress-website</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-10-25-Using-WP-CLI-to-manage-a-wordpress-website" />
    <title>Using WP CLI to manage a Wordpress website</title>
    <published>2023-10-25T00:00:00+00:00</published>
    <updated>2023-10-25T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I am a big fan of the command line and often have 7 terminal tabs open on my computer. I found the wp-cli tool to manage a Worpdress website from the command line and i love it. It is much faster to use and the WP-CLI tool offers great improvements to......</summary>
    <content type="html"><![CDATA[
        <p>I am a big fan of the command line and often have 7 terminal tabs open on my computer. I found the wp-cli tool to manage a Worpdress website from the command line and i love it. It is much faster to use and the WP-CLI tool offers great improvements to manage my wordpress websites from the command-line.</p>

<pre><code class="language-sh"># update the wp-cli tool itself
wp cli update

# update wordpress core
wp core update

# update all the plugins
wp plugin update --all

# update all the themes
wp theme update --all

# export database (to directory)
wp db export /home/andy/wp.sql

# install plugin
wp plugin install wp-statistics

# activate plugin
wp plugin activate wp-statistics

</code></pre>

<p>you can see extensive documentation <a href="https://developer.wordpress.org/cli/commands/">here</a></p>

<p>It is also possible to extend the wp-cli tool and I have added these 2 tools as well which provide background as to potential problems.</p>

<h3>wp doctor</h3>

<p><a href="https://managingwp.io/2023/03/31/wp-cli-doctor-command-an-essential-tool-for-wordpress-troubleshooting/">https://managingwp.io/2023/03/31/wp-cli-doctor-command-an-essential-tool-for-wordpress-troubleshooting/</a></p>

<h3>wp vunerability</h3>

<p><a href="https://github.com/javiercasares/wpvulnerability">https://github.com/javiercasares/wpvulnerability</a></p>

<p>all round it is a great tool to manage the wordpress site from the command line.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-10-18-Wordpress-Theme-using-Underscores</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-10-18-Wordpress-Theme-using-Underscores" />
    <title>Wordpress Theme using Underscores</title>
    <published>2023-10-18T00:00:00+00:00</published>
    <updated>2023-10-18T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">WordPress, with its user-friendly interface and endless possibilities, has become the platform of choice for many website owners and developers. When it comes to creating a unique, tailor-made website, customizing a WordPress theme is the way to go. One......</summary>
    <content type="html"><![CDATA[
        <h1>A Guide to Customizing a WordPress Theme Using the Underscores Theme Template</h1>

<p>WordPress, with its user-friendly interface and endless possibilities, has become the platform of choice for many website owners and developers. When it comes to creating a unique, tailor-made website, customizing a WordPress theme is the way to go. One of the best starting points for this journey is the Underscores theme template (also known as "_s"). In this guide, we'll explore how to leverage Underscores as a solid foundation for your WordPress project.</p>

<h2>What Is Underscores?</h2>

<p>Underscores is a lightweight, minimalistic starter theme developed by Automattic, the company behind WordPress. It's designed to give you a clean slate for building your custom WordPress theme. Here are some of the key features that make Underscores an excellent choice:</p>

<ol>
<li><p><strong>Bare Minimum</strong>: Underscores provides just the essentials - the basic structure, template files, and a well-organized directory structure. This makes it easier to understand and build upon.</p></li>
<li><p><strong>Mobile-First</strong>: The theme is designed with a mobile-first approach, ensuring that your site will look and perform well on all devices.</p></li>
<li><p><strong>Developer-Friendly</strong>: Underscores is developer-focused, which means it's well-documented and designed to be extended and customized to your heart's content.</p></li>
<li><p><strong>Accessibility-Ready</strong>: It places a strong emphasis on web accessibility, ensuring your site is usable for all visitors, regardless of disabilities.</p></li>
</ol>

<h2>Getting Started with Underscores</h2>

<h3>Step 1: Download and Install</h3>

<ol>
<li>Visit the Underscores website (https://underscores.me/).</li>
<li>Generate a customized theme by filling in the details, such as your theme name, author, and other preferences.</li>
<li>Click the "Generate" button to download the theme package.</li>
</ol>

<h3>Step 2: Set Up Your Development Environment</h3>

<p>Before you start customizing, ensure you have a development environment set up. This typically involves installing a local server (like XAMPP or MAMP) and setting up a fresh WordPress installation.</p>

<h3>Step 3: Customize and Extend</h3>

<p>Now comes the fun part: making your Underscores theme truly yours.</p>

<h4>a. Explore the File Structure</h4>

<p>Familiarize yourself with the theme's file structure. Underscores keeps things tidy and logical. Key files to look at include <code>style.css</code>, <code>functions.php</code>, and various template files.</p>

<h4>b. Modify <code>style.css</code></h4>

<p>Customize the theme's styles by editing the <code>style.css</code> file. This is where you'll set colors, fonts, and other design elements to match your brand.</p>

<h4>c. Customize <code>functions.php</code></h4>

<p>The <code>functions.php</code> file is your gateway to adding functionality to your theme. You can enqueue styles and scripts, add custom widgets, and more. This is also where you can set up support for features like post thumbnails, custom headers, and custom backgrounds.</p>

<h4>d. Create Custom Templates</h4>

<p>Underscores provides template files for various parts of your site, like <code>header.php</code>, <code>footer.php</code>, and more. Customize these templates to match your design and layout requirements.</p>

<h4>e. Add Custom Features</h4>

<p>You can extend your theme's functionality by adding custom features using hooks, filters, or by creating custom functions in your <code>functions.php</code> file.</p>

<h4>f. Install Plugins</h4>

<p>If your project requires specific features that aren't related to your theme's core functionality, consider installing WordPress plugins. They can add contact forms, SEO enhancements, e-commerce capabilities, and more without cluttering your theme.</p>

<h2>Testing and Deployment</h2>

<p>After making all your customizations, thoroughly test your website to ensure everything works as expected. Test on various browsers and devices to check for any issues. Once you're satisfied, you can deploy your custom theme to your live WordPress site.</p>

<h2>Template Files</h2>

<p>Customizing a WordPress theme using Underscores is an excellent way to create a unique, professionally designed website that reflects your brand and style. It gives you full control over your site's look and functionality while keeping things lightweight and efficient.</p>

<p>Remember, practice makes perfect. Don't be afraid to experiment and learn as you go. The WordPress community is full of resources and helpful individuals who can assist you on your journey to creating the perfect WordPress website. So, get started with Underscores, and let your creativity flow as you craft a website that's truly one-of-a-kind.</p>

<p>A WordPress theme consists of a variety of files that work together to control the appearance and functionality of your website. Here's a list of common file types found in a typical WordPress theme and their purposes:</p>

<ol>
<li><p><strong>style.css</strong>: This is the main stylesheet file for your theme. It contains CSS code that defines the design and layout of your website.</p></li>
<li><p><strong>index.php</strong>: The primary template file used to display the main content of your website. It usually contains a loop that fetches and displays blog posts or other content.</p></li>
<li><p><strong>header.php</strong>: This file typically contains the header section of your website, including the site title, navigation menus, and any global elements that appear at the top of every page.</p></li>
<li><p><strong>footer.php</strong>: Similar to the header.php file, this contains the footer section of your website, including copyright information and any global elements that appear at the bottom of every page.</p></li>
<li><p><strong>single.php</strong>: This template file is used to display individual blog posts or custom post types.</p></li>
<li><p><strong>page.php</strong>: Used to display individual pages on your WordPress site.</p></li>
<li><p><strong>archive.php</strong>: It's used to display archive pages, such as category or tag archives.</p></li>
<li><p><strong>search.php</strong>: Displays search results when visitors use the search functionality on your website.</p></li>
<li><p><strong>category.php</strong>: Used to display category archive pages.</p></li>
<li><p><strong>tag.php</strong>: Used to display tag archive pages.</p></li>
<li><p><strong>author.php</strong>: Displays author archive pages, showing posts by a specific author.</p></li>
<li><p><strong>comments.php</strong>: Contains the code for displaying comments on your website. It is often included in single.php and page.php.</p></li>
<li><p><strong>functions.php</strong>: This is where you can define custom functions and include additional functionality for your theme, such as registering sidebars or adding custom scripts.</p></li>
<li><p><strong>header.php</strong>: Typically contains the HTML code for the header section of your website.</p></li>
<li><p><strong>footer.php</strong>: Contains the HTML code for the footer section of your website.</p></li>
<li><p><strong>sidebar.php</strong>: Defines the content of your theme's sidebar, which may include widgets, advertisements, or other custom content.</p></li>
<li><p><strong>image files (e.g., .jpg, .png, .svg)</strong>: These files are used for images and graphics within your theme, such as logos, background images, or other visual elements.</p></li>
<li><p><strong>JavaScript files (e.g., .js)</strong>: These files are used to add interactivity and functionality to your theme, like sliders, navigation menus, or other dynamic features.</p></li>
<li><p><strong>Template part files (e.g., content.php, post-formats.php)</strong>: These files are used to break down the structure of your theme into smaller, reusable components that can be included in other template files.</p></li>
<li><p><strong>Custom template files (e.g., custom-template.php)</strong>: Themes may include custom template files for specific purposes or post types.</p></li>
<li><p><strong>style.scss</strong>: Some themes use SCSS (Sass) for their stylesheets. This is the preprocessed version of the main CSS file.</p></li>
<li><p><strong>README.txt or documentation files</strong>: Themes often include documentation to explain how to use and customize the theme.</p></li>
</ol>

<p>These are some of the most common files you'll find in a WordPress theme. The specific files and their organization may vary from theme to theme, especially if you're using a custom or premium theme. It's important to be familiar with these files if you want to customize or develop your WordPress theme.</p>

<h2>Template Heirarchy</h2>

<p>In WordPress, the template hierarchy determines how the system chooses which template file to use when displaying different types of content. This hierarchy allows you to create custom templates for specific pages or content types while falling back on more generic templates when needed. Here's an overview of the WordPress template file hierarchy, from the most specific to the most general:</p>

<ol>
<li><p><strong>Custom Page Template</strong>: The most specific template is a custom page template. If you create a custom template for a specific page (e.g., a "Template Name: Custom Template" comment in the file header), WordPress will use this template for that page. Custom templates take precedence over all other template files.</p></li>
<li><p><strong>Custom Post Type Template</strong>: If you have custom post types on your site, WordPress will look for a template specifically created for that post type. For example, if you have a custom post type called "portfolio," WordPress will first check for <code>single-portfolio.php</code> before using the generic single post template.</p></li>
<li><p><strong>Single Post Template</strong>: If no custom post type template is found, WordPress uses the <code>single.php</code> file to display single posts.</p></li>
<li><p><strong>Single Page Template</strong>: If you're viewing a single page, WordPress will use the <code>page.php</code> template.</p></li>
<li><p><strong>Category Archive Template</strong>: When viewing a category archive page, WordPress looks for <code>category-slug.php</code> or <code>category-ID.php</code>. If those are not found, it uses <code>category.php</code>.</p></li>
<li><p><strong>Tag Archive Template</strong>: For tag archive pages, WordPress searches for <code>tag-slug.php</code> or <code>tag-ID.php</code>. If not found, it uses <code>tag.php</code>.</p></li>
<li><p><strong>Author Archive Template</strong>: When you view an author's archive page, WordPress looks for <code>author-nicename.php</code>. If not found, it uses <code>author-ID.php</code>.</p></li>
<li><p><strong>Date-Based Archive Template</strong>: Date-based archives have different hierarchy levels, with the most specific being <code>date.php</code>, followed by <code>year.php</code>, <code>month.php</code>, and <code>day.php</code>. These templates handle yearly, monthly, and daily archives, respectively.</p></li>
<li><p><strong>Custom Taxonomy Template</strong>: If you have custom taxonomies, WordPress looks for <code>taxonomy-taxonomyname.php</code>. For example, if you have a custom taxonomy called "genre," WordPress will search for <code>taxonomy-genre.php</code>.</p></li>
<li><p><strong>Custom Post Type Archive Template</strong>: When viewing the archive for a custom post type, WordPress looks for <code>archive-posttype.php</code>. If not found, it defaults to <code>archive.php</code>.</p></li>
<li><p><strong>Search Results Template</strong>: The template for search results is <code>search.php</code>.</p></li>
<li><p><strong>404 Error Template</strong>: The template for handling 404 (not found) errors is <code>404.php</code>.</p></li>
<li><p><strong>Attachment Template</strong>: For individual attachments (such as images or documents), WordPress uses <code>attachment.php</code>.</p></li>
<li><p><strong>Home Page Template</strong>: The default template for your site's homepage is <code>home.php</code>. If it doesn't exist, WordPress falls back to <code>index.php</code>.</p></li>
<li><p><strong>Front Page Template</strong>: If you've set a static front page for your website, WordPress uses <code>front-page.php</code> for that page. If not found, it uses <code>home.php</code>.</p></li>
<li><p><strong>Generic Index Template</strong>: If no other specific template is found, WordPress will use <code>index.php</code> to display the content. This template acts as a fallback for all types of content.</p></li>
</ol>

<p>By understanding the WordPress template hierarchy, you can create and customize templates to control the look and functionality of various parts of your website, tailoring them to your specific needs. This hierarchy ensures that WordPress always selects the most appropriate template based on the content being displayed.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-09-29-fixing-the-twitter-100-cpu-issue-in-the-chrome-browser</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-09-29-fixing-the-twitter-100-cpu-issue-in-the-chrome-browser" />
    <title>Fixing the twitter 100% cpu issue in the chrome browser</title>
    <published>2023-09-29T00:00:00+00:00</published>
    <updated>2023-09-29T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Since tweetdeck was put behind the paywall of Twitter, I have been using the vanilla Twitter which is awful, but the only way to access the twitter site. One thing I found straight away is that it seemed to use a lot more resources and max the CPU at......</summary>
    <content type="html"><![CDATA[
        <p>Since tweetdeck was put behind the paywall of Twitter, I have been using the vanilla <a href="https://twitter.com/home">Twitter</a> which is awful, but the only way to access the twitter site. One thing I found straight away is that it seemed to use a lot more resources and max the CPU at 100%. This mean't i had to shut the browser tab when not using it, which isn't something I would have done with tweetdeck.</p>

<p>Today, I had a little investigation and discovered a tweet which suggested it was the 'Listen live in Spaces' part which was maxing the CPU. The <a href="https://chrome.google.com/webstore/detail/twitter-cpu-optimizer/eeeaaoidkpndlpdljifdpkemliihcebh?hl=en">Twitter CPU Optimizer</a> solved this problem and removed the Spaces html.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-04-28-installing-a-Wordpress-blog-locally-with-https-ssh-and-plugins</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-04-28-installing-a-Wordpress-blog-locally-with-https-ssh-and-plugins" />
    <title>Installing a Wordpress blog locally with https ssh and plugins</title>
    <published>2023-04-28T00:00:00+00:00</published>
    <updated>2023-04-28T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I recently inherited a Wordpress website that needed updating to the latest version of Wordpress and a general cleanup.

Wordpress has gone through a lot of changes in the past few months and one thing I had to get my head around was a totally new......</summary>
    <content type="html"><![CDATA[
        <p>I recently inherited a Wordpress website that needed updating to the latest version of Wordpress and a general cleanup.</p>

<p>Wordpress has gone through a lot of changes in the past few months and one thing I had to get my head around was a totally new editor.</p>

<p>But the users of the site find the new editor difficult to use so asked me to reinstall the old 'classic' editor.</p>

<p>But first I had to download the site and the database and install it locally.</p>

<p>One thing that I had to workaround was the site uses https redirects which wernt available on my localhost/127.0.0.1 so these are the settings i had to alter to get it to work.</p>

<pre><code>ini_set('display_errors', 0);
define('WP_CACHE', false);
define('WPCACHEHOME', '/home/andy/www/wordpress/wp-content/plugins/wp-super-cache/' );
define('DB_NAME', 'wp1');
define('WP_DEBUG', false);
define('FS_METHOD', 'direct' );
define('FORCE_SSL_ADMIN', false);
</code></pre>

<p>also in the database are 2 settings which I needed to change to get the site to work</p>

<pre><code>siteurl http://127.0.0.1:86
home http://127.0.0.1:86
</code></pre>

<p>Once these were set, the site worked, but it was a struggle to work this out.</p>

<p>Next up, updating all the plugins, finding a new theme and disabling unused plugins. Also learning the difference with Elementor, Gutenberg and other things that have changed.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-03-06-Analyse-a-website-for-seo-errors-malware-domain-rank</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-03-06-Analyse-a-website-for-seo-errors-malware-domain-rank" />
    <title>Analyse a website for seo errors malware domain rank</title>
    <published>2023-03-06T00:00:00+00:00</published>
    <updated>2023-03-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">As part of my job search, I began looking at ways to analyse and test a company website to see how good it is. I am looking at a number of criteria.

Firstly, I use Wappalyzer to see what technologies the site uses and also take a look at the source code......</summary>
    <content type="html"><![CDATA[
        <p>As part of my job search, I began looking at ways to analyse and test a company website to see how good it is. I am looking at a number of criteria.</p>

<p>Firstly, I use <a href="https://www.wappalyzer.com/" target="_blank">Wappalyzer</a> to see what technologies the site uses and also take a look at the source code to see what state it is in. I come from a PHP Laravel background, but like to see what technologies a website is run on.</p>

<p>I also like to use tools to quantify how good a websites is. In days gone past, there was Alexa ranking, Google Pagerank and a number of other ranking tools that no longer work or exist in the same way. Now we have Domain Authority, but other tools have stepped in to replace them.</p>

<p>A great tool I have recently discovered is the <a href="https://github.com/vormkracht10/laravel-seo-scanner" target="_blank">Laravel SEO Scanner</a> from a dutch team called VormKracht. This is an PHP Laravel Artisan comman which scans a website for a number of issues with SEO. I like it a lot.</p>

<p>A nice allround tool for analysing a website is <a href="https://www.rankwatch.com/tools/web-analyzer.html" target="_blank">rankwatch.com/tools/web-analyzer</a>. This gives a fairly comprenhsive summary of the key SEO criteria.</p>

<p>This tool from <a href="https://moz.com/domain-analysis" target="_blank">moz.com/domain-analysis</a> provides a simple value as a domain authority.</p>

<p>Check the <a href="https://sitecheck.sucuri.net/" target="_blank">sitecheck.sucuri.net</a> for malware and if a domain is listed in 9 security websites.</p>

<p>And check the pagerank for a url. <a href="https://dnschecker.org/pagerank.php" target="_blank">dnschecker.org/pagerank</a></p>

<p>This is a good tool for finding keyword related positions for a url. <a href="https://ahrefs.com/keyword-rank-checker" target="_blank">ahrefs.com/keyword-rank-checker</a></p>

<p>I also like to use command line tools and a great one is <a href="https://www.morningstarsecurity.com/research/whatweb">whatweb</a> which will show the technologies a website uses in the command line.</p>

<p>This is a set of tools I use alongside looking at the source code and my own londinium scoring system.</p>

<p>What else do you use? I would like to edit this and add more tools, please comment if you use and like any.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-02-27-Debian-unstable-apt-get-update-kernel-and-force-remove-errors</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-02-27-Debian-unstable-apt-get-update-kernel-and-force-remove-errors" />
    <title>Debian unstable apt get, update kernel and force remove apt errors</title>
    <published>2023-02-27T00:00:00+00:00</published>
    <updated>2023-02-27T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">This weekend I decided to go for an full Debian dist-upgrade / full-upgrade on my main linux Debian machine. I had a growing list of &#039;The following packages have been kept back:&#039; and so I decided to take the plunge and upgrade the whole lot.

It is......</summary>
    <content type="html"><![CDATA[
        <p>This weekend I decided to go for an full Debian dist-upgrade / full-upgrade on my main linux Debian machine. I had a growing list of 'The following packages have been kept back:' and so I decided to take the plunge and upgrade the whole lot.</p>

<p>It is always a bit nervous thing to do, as in the past, I found the upgrade to linux kernel 4.19 stopped the computer from sleeping, so after a full backup, I went for it.</p>

<p>I started with the full upgrade</p>

<pre><code>apt-get update
apt-get dist-upgrade
</code></pre>

<p>This updated the system, but I wanted to also fix a few errors that I had. eg. My copy of Zeal, which is an offline code reader was showing blank pages. So I added the unstable debian repo to provide newer software versions.</p>

<pre><code># Unstable repo main, contrib and non-free branches, no security updates here
deb http://http.us.debian.org/debian unstable main non-free contrib
deb-src http://http.us.debian.org/debian unstable main non-free contrib
</code></pre>

<p>In doing so, I ended up with errors which complained about version conflicts for a number of packages. These where android packages that I had installed and I forced there removal using these commands as they blocked the upgrade process.</p>

<pre><code>dpkg --remove --force-remove-reinstreq adb
dpkg --remove --force-remove-reinstreq android-libadb
dpkg --remove --force-remove-reinstreq android-libbase
dpkg --remove --force-remove-reinstreq android-libcutils
dpkg --remove --force-remove-reinstreq android-libbase
</code></pre>

<p>So this gave me a much more up-to-date system with the version 6 kernel.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-01-27-Learning-Go-Golang-to-compliment-PHP-and-Bash-for-web-and-devops</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-01-27-Learning-Go-Golang-to-compliment-PHP-and-Bash-for-web-and-devops" />
    <title>Learning Go Golang to compliment PHP and Bash for web and devops</title>
    <published>2023-01-27T00:00:00+00:00</published>
    <updated>2023-01-27T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I wanted to start learning Go / Golang for 3 reasons, firstly to start work on a multi-threaded spider to download html for websites faster and concurrently. Also I wanted to play around with building GUI apps. Neither of these things are really possible......</summary>
    <content type="html"><![CDATA[
        <p>I wanted to start learning Go / Golang for 3 reasons, firstly to start work on a multi-threaded spider to download html for websites faster and concurrently. Also I wanted to play around with building GUI apps. Neither of these things are really possible with PHP. The third reason is Devops, many of the next generation Devops tools like Terraform, Docker and Kubernetes are written in GO.</p>

<p>To install and setup GO on my debian machine was straightforward but the version of Go in my Debian repository was 1.15, where as version 1.19 is available on <a href="https://go.dev/dl/">https://go.dev/dl/</a></p>

<pre><code>apt-get install -y golang
</code></pre>

<p>edit ~/.bashrc</p>

<pre><code># Golang paths in bashrc
export GOROOT=/usr/local/go
export GOPATH=$HOME/go
export PATH=$GOPATH/bin:$GOROOT/bin:$PATH
</code></pre>

<p>so my go files go in /home/andy/go/src</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-01-19-Mysql-speed-improvements-and-query-optimisation</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-01-19-Mysql-speed-improvements-and-query-optimisation" />
    <title>Mysql speed improvements and query optimisation</title>
    <published>2023-01-19T00:00:00+00:00</published>
    <updated>2023-01-19T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Yesterday, I came across an issue where a Laravel spider I had running crawled to a snails pace. It was running by selecting a url from the database, using curl to get the html, extracting the title, meta tags and links and then storing this in 2 tables.......</summary>
    <content type="html"><![CDATA[
        <p>Yesterday, I came across an issue where a Laravel spider I had running crawled to a snails pace. It was running by selecting a url from the database, using curl to get the html, extracting the title, meta tags and links and then storing this in 2 tables. In all it was 6 queries with MYSQL/ MariaDB and I went around the houses to optimise and solve the problem.</p>

<p>The first thing I did was to look into slow query logging, so editing my.cnf file with a text editor and add the following block of code under the mysqld section:</p>

<pre><code>slow_query_log = 1
slow-query_log_file = /var/log/mysql-slow.log
long_query_time = 2
</code></pre>

<p>To restart the mariadb server</p>

<pre><code>sudo systemctl restart mariadb.service
</code></pre>

<p>However, after monitoring it for a while, it never logged any slow queries. This got me thinking it was something with the MYsql configuration.</p>

<p>So secondly I installed 'mysqltuner' and it suggested the following optimisations in the my.cnf file.</p>

<p>running</p>

<pre><code>mysqltuner --host 127.0.0.1 --port 3306 --user root --pass 'password'
</code></pre>

<p>gave good feedback and suggestions like so:</p>

<pre><code>Variables to adjust:
    query_cache_size (=0)
    query_cache_type (=0)
    query_cache_limit (&gt; 1M, or use smaller result sets)
    tmp_table_size (&gt; 16M)
    max_heap_table_size (&gt; 16M)
    performance_schema = ON enable PFS
    innodb_buffer_pool_size (&gt;= 765.8M) if possible.
    innodb_log_file_size should be (=16M) if possible, so InnoDB total log files size equals to 25% of buffer pool size.
</code></pre>

<p>I also checked the database tables with</p>

<pre><code>mysqlcheck -u root -p  --check  --all-databases
</code></pre>

<p>and also I checked the logs in for obvious errors.</p>

<pre><code>/var/log/mysql/error.log
/var/log/apache/error.log
</code></pre>

<p>I also added Indexes and Primary keys on the tables, but although this helped a little, it didnt fix the problem.</p>

<p>Finally, I wanted to get live performance stats for the queries, so I installed the <a href="https://github.com/barryvdh/laravel-debugbar" target="_blank">laravel debugbar</a> and
this gave me the answer. The following query was taking over 10 seconds!</p>

<pre><code>$data['website'] = websites::where('updated_at', '=', '2022-12-12 12:34:44')
    -&gt;where('dns', '!=', 'failed')
    -&gt;inRandomOrder()
    -&gt;take(1)
    -&gt;first();
</code></pre>

<p>The inRandomOrder() I had added was slowing it down dramatically, and once i removed it, the query was back to running in 25 MILLIseconds!</p>

<p>I have found and am using a number of laravel packages in recent days that solve small problems and improve my project. I will write about each one in turn.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-01-16-Upgrading-PHP-to-version-8-2-on-Debian-Linux</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-01-16-Upgrading-PHP-to-version-8-2-on-Debian-Linux" />
    <title>Upgrading PHP to version 8.2 on Debian Linux</title>
    <published>2023-01-16T00:00:00+00:00</published>
    <updated>2023-01-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I decided to upgrade my PHP version to 8.2 on my local Debian desktop to test compatability with Laravel versions 8 and 9 and soon to be version 10 of laravel!

I wrote a blog previously about upgrading to PHP 8.0 and also using ansible to upgrade......</summary>
    <content type="html"><![CDATA[
        <p>Today I decided to upgrade my PHP version to 8.2 on my local Debian desktop to test compatability with Laravel versions 8 and 9 and soon to be version 10 of laravel!</p>

<p>I wrote a blog previously about <a href="https://allotmentandy.github.io/blog/2021-04-15-Upgrading-to-php-8/">upgrading to PHP 8.0</a> and also using <a href="https://allotmentandy.github.io/blog/2022-10-12-Upgrade-Apache-To-PHP-81-with-Ansible-on-Debian/">ansible to upgrade to PHP version 8.1</a> only a few months back.</p>

<p>Today I decided to upgrade to PHP 8.2 and it was a fairly similar and simple process. Using this <code>apt</code> install to install a comprenhsive set of PHP modules to fulfil the requirements of Laravel, this should cover most peoples needs.</p>

<pre><code>sudo apt install php8.2-cli php8.2-curl php8.2-mysqlnd php8.2-gd php8.2-opcache 
php8.2-zip php8.2-intl php8.2-common php8.2-bcmath php8.2-imap php8.2-imagick 
php8.2-xmlrpc php8.2-readline php8.2-memcached php8.2-redis php8.2-mbstring 
php8.2-apcu php8.2-xml php8.2-xml php8.2-redis php8.2-memcached php8.2-memcache 
php8.2 php8.2-fpm php8.2-cli php8.2-fpm php8.2-common libapache2-mod-fcgid 
php8.2-cli php8.2-bz2 php8.2-tidy libapache2-mod-php8.2 php8.2-fpm -y
</code></pre>

<p>To activate the new version (or select an older version) the command 'update-alternatives' can be used thus:</p>

<pre><code>sudo update-alternatives --config php
</code></pre>

<p>which provides a menu of versions like so:</p>

<pre><code>There are 5 choices for the alternative php (providing /usr/bin/php).

  Selection    Path                  Priority   Status
------------------------------------------------------------
  0            /usr/bin/php.default   100       auto mode
  1            /usr/bin/php.default   100       manual mode
  2            /usr/bin/php7.4        74        manual mode
  3            /usr/bin/php8.0        80        manual mode
* 4            /usr/bin/php8.1        81        manual mode
  5            /usr/bin/php8.2        82        manual mode

Press &lt;enter&gt; to keep the current choice[*], or type selection number: 5

</code></pre>

<p>I have kept the older versions for now and to setup Apache to use the new version, these commands update the Apache config (this is for both the fpm and apache module)</p>

<pre><code>sudo a2enconf php8.2-fpm
sudo a2disconf php8.1-fpm 

sudo a2enmod php8.2
sudo a2dismod php8.1 

sudo service apache2 restart
</code></pre>

<p>And with the apache restart, I am using the latest and greatest version of PHP!</p>

<p><img src="/assets/images/php82.png" alt="Image of php 8.2 phpinfo page" /></p>

<p>Now to test that my apps work and see what new error messages have been added.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2023-01-14-Typesense-Part-3-adding-an-id-field-for-each-record-and-more</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2023-01-14-Typesense-Part-3-adding-an-id-field-for-each-record-and-more" />
    <title>Typesense Part 3 adding an id field for each record and more</title>
    <published>2023-01-14T00:00:00+00:00</published>
    <updated>2023-01-14T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I saw an update to version 0.24 of typesense and I have built a new database of around 300,000 websites so it was time to install it on a live server!



check the status:



and do a healthcheck



all ok!

One suggestion I saw to improve the typesense......</summary>
    <content type="html"><![CDATA[
        <p>I saw an update to version 0.24 of typesense and I have built a new database of around 300,000 websites so it was time to install it on a live server!</p>

<pre><code>curl -O https://dl.typesense.org/releases/0.24.0/typesense-server-0.24.0-amd64.deb
sudo apt install ./typesense-server-0.24.0-amd64.deb
</code></pre>

<p>check the status:</p>

<pre><code>sudo systemctl status typesense-server.service
</code></pre>

<p>and do a healthcheck</p>

<pre><code>curl http://localhost:8108/health
</code></pre>

<p>all ok!</p>

<p>One suggestion I saw to improve the typesense database import, is to give each entry a unique id, to make updating easier. So I have added an id field like so to the database query</p>

<pre><code>    nwr
    -&gt;selectRaw("CONCAT( points.nwr, '/', points.id)  AS id)
    londinium
    -&gt;selectRaw(" CONCAT( seo.route)  AS id")
</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-17-PHP-Functions-for-Domain-Names-and-IP-Addresses</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-17-PHP-Functions-for-Domain-Names-and-IP-Addresses" />
    <title>PHP Functions for Domain Names and IP Addresses</title>
    <published>2022-12-17T00:00:00+00:00</published>
    <updated>2022-12-17T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I am working on a project that involves lots of domain names and splitting the actual domain name and the top level domain from the url.

The PHP function parse_url is a good starting point for extracting domain names but I was looking for getting the......</summary>
    <content type="html"><![CDATA[
        <p>I am working on a project that involves lots of domain names and splitting the actual domain name and the top level domain from the url.</p>

<p>The PHP function <a href="https://www.php.net/manual/en/function.parse-url.php" target="_blank">parse_url</a> is a good starting point for extracting domain names but I was looking for getting the top level domain too, which is trickier.</p>

<p>If you split the domain by the dots from the right hand side, '.com', '.org', '.net' are all single levels. '.co.uk', '.me.uk', 'gov.uk are 2 levels from the right. but there are also domains like '.homeoffice.gov.uk' and the longest I found was 'nodes.k8s.nl-ams.scw.cloud'. So I need to find another way to extract this information.</p>

<p>I discovered the repo <a href="https://github.com/jeremykendall/php-domain-parser" target="_blank">github.com/jeremykendall/php-domain-parser</a> on github which seems to be the best way in php to extract this from a full domain name. It uses <a href="https://github.com/publicsuffix/list" target="_blank">https://github.com/publicsuffix/list</a> this project as a source of truth for the domain registrar and works great.</p>

<p>One little gotcha I encountered, was it needed the php-intl extension which I didnt have, so it installed a very old version and didnt work. Once i installed it, I had to force composer to upgrade the package by changing the version in the composer.json from version 1.4 to</p>

<pre><code>"jeremykendall/php-domain-parser": "^6.1",
</code></pre>

<p>Here is an extract of the code I used to get the suffix and the domain from a url:</p>

<pre><code class="language-php">    use Pdp\Rules;
    use Pdp\Domain;

    $publicSuffixList = Rules::fromPath('public_suffix_list.dat');

    $url = 'www.pref.okinawa.jp'; // &lt;- any url with the http part removed

    if (inet_pton($url)==false and strpos($url, ".")) { // check for ip addresses and contains a dot
        $domain = Domain::fromIDNA2008($url);
        $result = $publicSuffixList-&gt;resolve($domain);
        echo $result-&gt;registrableDomain()-&gt;toString(); //display 'pref.okinawa.jp';
        echo $result-&gt;suffix()-&gt;toString(); //display 'jp';
        }
</code></pre>

<p>The php function <code>inet_pton($u)</code> checks if the variable $url is an ip address, which is a 'feature' of the database I am checking. So removes the check on ip address like '1.2.3.4' as that errors. I am also checking that the domain has at least one '.' in it.</p>

<p>I wrote another <a href="https://allotmentandy.github.io/blog/2022-11-22-Looking-Up-Domains-for-DNS-Entries-with-PHP-and-Dig/">post recently on looking up the DNS status</a> of a domain which is a useful and quick initial test of a domain. This is the function it uses <a href="https://www.php.net/manual/en/function.dns-get-record.php" target="_blank">dns-get-record.php</a></p>

<p>Another cool domain related code I stumbled upon is extracting the domain in a mysql select query like so:</p>

<pre><code>SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(SUBSTRING_INDEX(SUBSTRING_INDEX(website, '/', 3), '://', -1), '/', 1), '?', 1) AS domain FROM domains; 
</code></pre>

<p>So now I can use this to create a master list of domains for my project and remove those from domains I do not want.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-16-Awesome-AllotmentAndy</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-16-Awesome-AllotmentAndy" />
    <title>Awesome AllotmentAndy</title>
    <published>2022-12-16T00:00:00+00:00</published>
    <updated>2022-12-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">There are many useful github repos of links to topics called Awesome.

I wanted to make something similar and some of my favourite Awesome pages include:


chiraggude/awesome-laravel
donnemartin/awesome-aws
teles/awesome-seo
javnik36/awesome-osm......</summary>
    <content type="html"><![CDATA[
        <p>There are many useful github repos of links to topics called <a href="https://github.com/sindresorhus/awesome" target="_blank">Awesome</a>.</p>

<p>I wanted to make something similar and some of my favourite Awesome pages include:</p>

<ul>
<li><a href="https://github.com/chiraggude/awesome-laravel" target="_blank">chiraggude/awesome-laravel</a></li>
<li><a href="https://github.com/donnemartin/awesome-aws" target="_blank">donnemartin/awesome-aws</a></li>
<li><a href="https://github.com/teles/awesome-seo" target="_blank">teles/awesome-seo</a></li>
<li><a href="https://github.com/javnik36/awesome-osm" target="_blank">javnik36/awesome-osm</a></li>
<li><a href="https://github.com/osmlab/awesome-openstreetmap" target="_blank">osmlab/awesome-openstreetmap</a></li>
<li><a href="https://github.com/aniftyco/awesome-tailwindcss" target="_blank">aniftyco/awesome-tailwindcss</a></li>
<li><a href="https://github.com/hridaydutta123/awesome-twitter-tools" target="_blank">hridaydutta123/awesome-twitter-tools</a></li>
<li><a href="https://github.com/ansible-community/awesome-ansible" target="_blank">ansible-community/awesome-ansible</a></li>
<li><a href="https://github.com/Correia-jpv/fucking-awesome-tailwindcss" target="_blank">Correia-jpv/awesome-tailwindcss</a></li>
<li><a href="https://github.com/alebcay/awesome-shell" target="_blank">alebcay/awesome-shell</a></li>
<li><a href="https://github.com/agarrharr/awesome-cli-apps" target="_blank">agarrharr/awesome-cli-apps</a></li>
</ul>

<p>I think I am going to start my own one, with my favourite links to things i like, use and regularly visit.</p>

<p>Its going to be called</p>

<h2>Awesome AllotmentAndy :)</h2>

<p>And i am going to start it on my <a href="https://github.com/allotmentandy" target="_blank">github profile frontpage</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-12-SEO</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-12-SEO" />
    <title>SEO</title>
    <published>2022-12-12T00:00:00+00:00</published>
    <updated>2022-12-12T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I was looking into resources for SEO and found this image on this Github repository which I thought was a rather good summary of Search Engine Optimisation (SEO). It is at the bottom of this page.

SEO is something I have done a lot of in the past, but......</summary>
    <content type="html"><![CDATA[
        <p>I was looking into resources for SEO and found this image on this <a href="https://github.com/madawei2699/awesome-seo/blob/main/README.md" target="_blank">Github repository</a> which I thought was a rather good summary of Search Engine Optimisation (SEO). It is at the bottom of this page.</p>

<p>SEO is something I have done a lot of in the past, but it has changed a lot in recent years. I wanted to write about the tools and techniques I have had sucess with.</p>

<h2>Keyword research</h2>

<p>My current favourite keyword research tool is <a href="https://ahrefs.com/keyword-generator">https://ahrefs.com/keyword-generator</a> as it provides the top 100 key phrases and is up-to-date. Alongside performing searches on Google, It is easy to find what people are searching for, with regards to a phrase.</p>

<h2>Writing Meta Tags Description for pages</h2>

<p>The optimium length of the Meta Description tag is around 150 characters and this if often displayed as the summary of a webpage in search engines. Therefore it is vital to optimise the description tag with user search friendly keywords, which still reads well.</p>

<h2>Title Tag</h2>

<p>The title tag is also a very important page ranking factor. It is often the actual link of the page in the search results. I have seen recomendations that say it should be about 60 characters long.</p>

<p><img src="/assets/images/seo.png" alt="seo" height="7133px" width="420px" /></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-11-Adding-Tiktok-Links-To-My-Social-Media-Link-Extractor-Package</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-11-Adding-Tiktok-Links-To-My-Social-Media-Link-Extractor-Package" />
    <title>Adding Tiktok Links To My Social Media Link Extractor Package</title>
    <published>2022-12-11T00:00:00+00:00</published>
    <updated>2022-12-11T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Adding tiktok links to my Social Media Link Extractor package on github and packagist....</summary>
    <content type="html"><![CDATA[
        <p>Today I have added tiktok links to my <a href="https://packagist.org/packages/allotmentandy/socialmedialinkextractor" target="_blank">social media link extractor package</a>  which was rather easy. But tiktok links are quite simple.</p>

<p>To test it out, i added about 700 websites urls I know have tiktok links. I added the function, then pushed it live to github. Then I did a <strong>composer update</strong> and it updated as if like magic!</p>

<p>I added the code to the spider like this sending in the list of links found on the page.</p>

<pre><code>    echo $smle-&gt;getTiktok($linkArray);
</code></pre>

<p>Here is a list of the unusual ones found in the list of 700+ websites i checked, the top lot are just http and botton ones https, with the vast majority in this format <strong>https://www.tiktok.com/@username</strong> those without the <strong>www.</strong> redirect the www. version of tiktok.</p>

<pre><code>http://tiktok.com/@frontlinerecruitment
http://tiktok.com/@mycarboncoach
http://tiktok.com/@nesmuseum
http://tiktok.com/@suffolknewcollege
http://tiktok.com/@thewheelspecialist
http://tiktok.com/@virginutty
http://vm.tiktok.com/gcHFxw/
http://www.tiktok.com/@peakwildlifepark

https://tiktok.com/@flightclubdarts
https://tiktok.com/@intersportelverys
https://tiktok.com/@skateeastanglia
https://tiktok.com/@uniofeastanglia
https://tiktok.com/@wovendurham
https://vm.tiktok.com/cCXD3U
https://vm.tiktok.com/ZMe6rQbhe/
https://vm.tiktok.com/ZMekeLrLn/
https://vm.tiktok.com/ZMeMC59yM/
https://vm.tiktok.com/ZML7dohMg/
https://vm.tiktok.com/ZMLfy3ckD
https://vm.tiktok.com/ZMLh8vpwB/
https://vm.tiktok.com/ZMN82frh1/
https://vm.tiktok.com/ZMNrLa72g/
https://vm.tiktok.com/ZMR7XdHPy/
https://vm.tiktok.com/ZMRSK4B2S/
https://vm.tiktok.com/ZSuD2T54
https://www.tiktok.com/@_bnuni
https://www.tiktok.com/@zatugames
https://www.tiktok.com/discover/murphymachinery
https://www.tiktok.com/discover/pizzaexpress?lang=en
https://www.tiktok.com/discover/swg3-glasgow?lang=en
https://www.tiktok.com/discover/the-belfry-hotel
https://www.tiktok.com/en/
https://www.tiktok.com/legal/page/eea/privacy-policy/en
https://www.tiktok.com/tag/bristolsu/
</code></pre>

<p>I also found one had a tracking link like this:</p>

<pre><code>https://www.tiktok.com/@username?_ga=2.225605338.1933392382.1646055423-1170747732.1642770380&amp;_gac=1.241822390.1645437651.EAIaIQobChMI8f2o8sSQ9gIVQoxoCR2W0gU3EAAYASAAEgK3g_D_BwE
</code></pre>

<p>Investigating these, the 'vm.' links redirect to the homepage so arn't much use. I wonder what these are about...</p>

<p>The http ones redirect to the https site, the '/discover' and '/tag' links are both useful search type queries within the site.</p>

<p>I dont use tiktok myself, but I can see it growing in use on websites. I may add links to <strong>Digg</strong>, <strong>Delicious</strong>, <strong>foursquare</strong>, <strong>wikipedia</strong>, <strong>reddit</strong> links next. Is there a social media website you use that you think would be useful in this package? tell me in the comments....</p>

<p>Hope you find this interesting, useful and have learnt something about tiktok here.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-10-Typesense-outputing-the-search-results-part-2</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-10-Typesense-outputing-the-search-results-part-2" />
    <title>Typesense outputing the search results part 2</title>
    <published>2022-12-10T00:00:00+00:00</published>
    <updated>2022-12-10T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">After the sucess of getting the basic search engine working. I looked at outputing the data as a neat webpage and also adding more fields and data to the json import.

This is a second part to build on my first blog about......</summary>
    <content type="html"><![CDATA[
        <p>After the sucess of getting the basic search engine working. I looked at outputing the data as a neat webpage and also adding more fields and data to the json import.</p>

<p>This is a second part to build on my first blog about <a href="https://allotmentandy.github.io/blog/2022-12-06-Setting-Up-A-Typesense-Website-Search-Engine/">Setting-Up-A-Typesense-Website-Search-Engine/</a></p>

<p>Typesense uses the <a href="https://jsonlines.org/">jsonl format</a> which is lines of json separated with the '\n' line break (note: the PHP_EOL function doesnt do this, it does '\r\n' for end of lines. This was my first gotcha!</p>

<p>The second Gotcha, was that the jsonl file had to match the names of the fields in the schema. I had an id field, that I didnt want to import, but that meant the import command ignored every row with extra fields in the jsonl file. So I removed the 2 fields I didn't need and indexed over 150,000 lines of json in a few minutes.</p>

<p>This is the file i used to import the json file.</p>

<pre><code class="language-php">&lt;?php
require_once __DIR__ . '/vendor/autoload.php';

use Typesense\Client;

// setup the schema
$websiteSchema = [
  'name' =&gt; 'websites',
  'fields' =&gt; [
    ['name' =&gt; 'title', 'type' =&gt; 'string'],
    ['name' =&gt; 'description', 'type' =&gt; 'string', 'facet' =&gt; true],
    ['name' =&gt; 'website', 'type' =&gt; 'string'],
    ['name' =&gt; 'url', 'type' =&gt; 'string']
  ]
];

$client = new Client(
    [
      'api_key'         =&gt; 'API_KEY_HERE',
      'nodes'           =&gt; [
        [
          'host'     =&gt; 'localhost', // For Typesense Cloud use xxx.a1.typesense.net
          'port'     =&gt; '8108',      // For Typesense Cloud use 443
          'protocol' =&gt; 'http',      // For Typesense Cloud use https
        ],
      ],
      'connection_timeout_seconds' =&gt; 2,
    ]
);

// delete the schema
$client-&gt;collections['websites']-&gt;delete();

// create the new schema from above in typesense
$client-&gt;collections-&gt;create($websiteSchema);

// import json file of data
$websitesData = file_get_contents('websites.jsonl');
$client-&gt;collections['websites']-&gt;documents-&gt;import($websitesData, ['action' =&gt; 'create']);

// show the result
$result = $client-&gt;collections['websites']-&gt;retrieve();
var_dump($result);
</code></pre>

<p>This is the line that shows me the count of pages indexed and that it had worked!</p>

<pre><code>  string(8) "websites"
  ["num_documents"]=&gt;
  int(157788)
</code></pre>

<p>I made a basic controller to respond to queries in the url using laravel and a query as a GET string in the url like this http://localhost/search?q=chiswick&amp;page=2 and here is the php code</p>

<pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Typesense\Client;

class SearchController extends Controller
{
    public function index(Request $request)
    {
        echo "Search for ";
        $q = $request['q'];
        $page = $request['page'];
        if (!isset($page)) {
            $page=1;
        }

        echo $q ."&lt;br&gt; page". $page;

        $client = new Client(
            [
              'api_key'         =&gt; 'API_KEY_HERE',
              'nodes'           =&gt; [
                [
                  'host'     =&gt; 'localhost', // For Typesense Cloud use xxx.a1.typesense.net
                  'port'     =&gt; '8108',      // For Typesense Cloud use 443
                  'protocol' =&gt; 'http',      // For Typesense Cloud use https
                ],
              ],
              'connection_timeout_seconds' =&gt; 2,
            ]
        );

        $searchParameters = [
            'q'         =&gt; $q,
            'query_by'  =&gt; 'description, title',
            'page'      =&gt; $page,
            'per_page'  =&gt; 50
          ];

        $results = $client-&gt;collections['websites']-&gt;documents-&gt;search($searchParameters);

        echo "&lt;hr&gt;found". $results['found'];

        foreach ($results['hits'] as $row) {
            // var_dump($row);
            echo $row['document']['url'];
            echo "&lt;br&gt;";
            echo $row['document']['website'];
            echo "&lt;br&gt;";
            echo $row['document']['title'];
            echo "&lt;br&gt;";
            echo $row['document']['description'];
            echo "&lt;hr&gt;";
        }
    }
}
</code></pre>

<p>and this creates a page like this:</p>

<p><img src="/assets/images/typesenseV1.png" alt="typesense search results" /></p>

<p>And this is great for today. I am now going to add more columns of data from the database into the json file and import it.</p>

<p>Also going to look at making imports for other pages in the website, ranking these results and improving this all further.</p>

<p>Very exciting, as it hasnt taken very long to get a working version up and running.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-09-Emergency-Debian-Commands-when-the-computer-crashes-to-try-and-save-it</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-09-Emergency-Debian-Commands-when-the-computer-crashes-to-try-and-save-it" />
    <title>Emergency Debian Commands when the computer crashes to try and save it</title>
    <published>2022-12-09T00:00:00+00:00</published>
    <updated>2022-12-09T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have an old laptop that often crashes when i use it. I was taking a backup of the files on it, but it seemed to hang a lot and became unresponsive so I wanted to write a blog post about how to prevent holding the power key to turn it off and to turn it......</summary>
    <content type="html"><![CDATA[
        <p>I have an old laptop that often crashes when i use it. I was taking a backup of the files on it, but it seemed to hang a lot and became unresponsive so I wanted to write a blog post about how to prevent holding the power key to turn it off and to turn it off without pulling the plug.</p>

<p>It seemed to be caused by the mariadb and redis servers, which I killed with the commands</p>

<pre><code class="language-bash">top
systemctl stop mariadb
systemctl stop redis
</code></pre>

<p>If you force the machine to turn off, it risks rebooting into an error and having to run 'fsck' to fix it, which isnt something I want to do, so I wanted to document how to turn it off without holding down the power key.</p>

<p>The first option I use is to login to a virtual console. You can get to these with <code>Ctrl</code>+<code>Alt</code>+<code>F1</code> to F6. <code>Ctrl+Alt+F7</code> is the console where your X server is running, So to get back into your GUI window manager: type:</p>

<pre><code class="language-bash">Ctrl+Alt+F7 (or sometimes Alt+F7 or Ctrl+Alt+F8) 
</code></pre>

<p>now in a terminal, i can login as the root user and shutdown the machine with</p>

<pre><code class="language-bash">shutdown now
</code></pre>

<p>When you are in these 6 consoles you can press Alt+RightArrow or Alt+LeftArrow to move to next/previous console respectively. I think you can also return to it with the command 'chvt 7'</p>

<p>In this console, you can often login as root and type the command 'top' to see what is causing the problem, Mine is often the mysql db on this machine going beserk and maxing out the CPU. You can often type 'shutdown now' to naturally turn off the machine.</p>

<p>If this doesnt work, the next option is the REISUB – R E I S U B key strokes. Here you press <code>ALT + PrintScreen + R</code> then wait a few seconds, followed by ALT + PrintScreen + E, ALT + PrintScreen + I, ALT + PrintScreen + S, ALT + PrintScreen + U and finally ALT + PrintScreen + B will reboot the machine as if you had held the power button down for 6-10 seconds.</p>

<p>Each key does a task as mentioned below</p>

<pre><code>unRaw      (take control of keyboard back from X),
 tErminate (send SIGTERM to all processes, allowing them to terminate gracefully),
 kIll      (send SIGKILL to all processes, forcing them to terminate immediately),
  Sync     (flush data to disk),
  Unmount  (remount all filesystems read-only),
reBoot.
</code></pre>

<p>So with a combination of these commands and key strokes, I have managed to shutdown the machine in a more gentle way.</p>

<p>Hope it helps.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-12-06-Setting-Up-A-Typesense-Website-Search-Engine</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-12-06-Setting-Up-A-Typesense-Website-Search-Engine" />
    <title>Setting Up A Typesense Website Search Engine</title>
    <published>2022-12-06T00:00:00+00:00</published>
    <updated>2022-12-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I wanted to setup a search engine for the urls and pages for my londinium.com site. I looked a options and found typesense which is an opensource solution and looks interesting.

I installed it locally with these 2 commands



Now I can run the typesense......</summary>
    <content type="html"><![CDATA[
        <p>I wanted to setup a search engine for the urls and pages for my londinium.com site. I looked a options and found <a href="https://typesense.org/" target="_blank">typesense</a> which is an opensource solution and looks interesting.</p>

<p>I installed it locally with these 2 commands</p>

<pre><code class="language-bash">curl -O https://dl.typesense.org/releases/0.23.1/typesense-server-0.23.1-amd64.deb
sudo apt install ./typesense-server-0.23.1-amd64.deb
</code></pre>

<p>Now I can run the typesense server thus:</p>

<pre><code>typesense-server  --data-dir=/var/lib/typesense --api-key=API_KEY_HERE
</code></pre>

<p>The API_KEY is created in the <code>/etc/typesense/typesense-server.ini</code> file</p>

<p>and to check the situation with this command.</p>

<p><strong>systemctl status typesense-server.service</strong></p>

<p>resulting in:</p>

<pre><code>● typesense-server.service - Typesense Server
     Loaded: loaded (/etc/systemd/system/typesense-server.service; enabled; vendor preset: enabled)
     Active: active (running) since Thu 2022-12-01 05:21:39 GMT; 7h ago
       Docs: https://typesense.org
   Main PID: 1096 (typesense-serve)
      Tasks: 91 (limit: 13630)
     Memory: 89.7M
        CPU: 46.755s
     CGroup: /system.slice/typesense-server.service
             └─1096 /usr/bin/typesense-server --config=/etc/typesense/typesense-server.ini

systemd[1]: Started Typesense Server.
typesense-server[1096]: Log directory is configured as: /var/log/typesense
typesense-server[1096]: E20221201 05:22:17.530272  1778 raft_server.h:62] Peer refresh failed, error: Doing another configuration change
</code></pre>

<p>and to run a status check.</p>

<pre><code>curl http://localhost:8108/health
{"ok":true}
</code></pre>

<p>Using the php version of the setup, i am going to create a simple json for websites</p>

<pre><code class="language-php">&lt;?php

$websiteSchema = [
  'name' =&gt; 'websites',
  'fields' =&gt; [
    ['name' =&gt; 'url', 'type' =&gt; 'string'],
    ['name' =&gt; 'title', 'type' =&gt; 'string'],
    ['name' =&gt; 'description', 'type' =&gt; 'string[]', 'facet' =&gt; true]
  ],
  'default_sorting_field' =&gt; 'url'
];

$client-&gt;collections-&gt;create($websiteSchema);
</code></pre>

<p>import some data with this json file. Jsonl is a form of json with multiple lines of json. <a href="https://hackernoon.com/json-lines-format-76353b4e588d" target="_blank">this article explains</a></p>

<p>This is an example of 1 row in the json.</p>

<pre><code class="language-json">{"id":"100275575","nwr":"way","title":"Home | Dover Castle Hostel","description":"Dover Castle, The Dover Castle Hostel is in the perfect location to explore London for budget travellers and groups. Being so close to the heart of London just check in at Dover Castle and enjoy the lively atmosphere with the friendly staff","url":"/way/100275575"}
</code></pre>

<p>And to import it</p>

<pre><code class="language-php">$websitesData = file_get_contents('websites.jsonl');

$client-&gt;collections['websites']-&gt;documents-&gt;import($websitesData);
</code></pre>

<p>Now to test it, here is a command line curl command</p>

<pre><code>curl -H "X-TYPESENSE-API-KEY: API_KEY_HERE" \
"http://localhost:8108/collections/websites/documents/search\
?q=dover&amp;query_by=description"
</code></pre>

<p>Which returns this json result</p>

<pre><code class="language-json">{"facet_counts":[],"found":1,"hits":[{"document":{"description":"Dover Castle, The Dover Castle Hostel is in the perfect location to explore London for budget travellers and groups. Being so close to the heart of London just check in at Dover Castle and enjoy the lively atmosphere with the friendly staff","id":"100275575","nwr":"way","title":"Home | Dover Castle Hostel","url":"/way/100275575"},"highlights":[{"field":"description","matched_tokens":["Dover","Dover"],"snippet":"&lt;mark&gt;Dover&lt;/mark&gt; Castle, The &lt;mark&gt;Dover&lt;/mark&gt; Castle"}],"text_match":72341265420648449}],"out_of":100,"page":1,"request_params":{"collection_name":"websites","per_page":10,"q":"dover"},"search_cutoff":false,"search_time_ms":304}
</code></pre>

<p>and in laravel this is the controller</p>

<pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Typesense\Client;

class SearchController extends Controller
{
    public function index(Request $request)
    {
        echo "search for ";
        $q = $request-&gt;input('q');
        echo $q;

        $client = new Client(
            [
              'api_key'         =&gt; 'API_KEY_HERE',
              'nodes'           =&gt; [
                [
                  'host'     =&gt; 'localhost', // For Typesense Cloud use xxx.a1.typesense.net
                  'port'     =&gt; '8108',      // For Typesense Cloud use 443
                  'protocol' =&gt; 'http',      // For Typesense Cloud use https
                ],
              ],
              'connection_timeout_seconds' =&gt; 2,
            ]
        );

        $searchParameters = [
            'q'         =&gt; $q,
            'query_by'  =&gt; 'description'
          ];

        $result = $client-&gt;collections['websites']-&gt;documents-&gt;search($searchParameters);

        dd($result);

    }
}
</code></pre>

<p>which results in</p>

<pre><code class="language-json">array:8 [▼ // app/Http/Controllers/SearchController.php:37
  "facet_counts" =&gt; []
  "found" =&gt; 13
  "hits" =&gt; array:10 [▼
    0 =&gt; array:3 [▼
      "document" =&gt; array:5 [▶]
      "highlights" =&gt; array:1 [▶]
      "text_match" =&gt; 72341265420648449
    ]
    1 =&gt; array:3 [▼
      "document" =&gt; array:5 [▼
        "description" =&gt; "Dover Castle, The Dover Castle Hostel is in the perfect location to explore London for budget travellers and groups. Being so close to the heart of London just  ▶"
        "id" =&gt; "100275575"
        "nwr" =&gt; "way"
        "title" =&gt; "Home | Dover Castle Hostel"
        "url" =&gt; "/way/100275575"
      ]
      "highlights" =&gt; array:1 [▼
        0 =&gt; array:3 [▼
          "field" =&gt; "description"
          "matched_tokens" =&gt; array:1 [▶]
          "snippet" =&gt; "perfect location to explore &lt;mark&gt;London&lt;/mark&gt; for budget travellers and"
        ]
      ]
      "text_match" =&gt; 72341265420648449
    ]
    2 =&gt; array:3 [▶]
    3 =&gt; array:3 [▶]
    4 =&gt; array:3 [▶]
    5 =&gt; array:3 [▶]
    6 =&gt; array:3 [▶]
    7 =&gt; array:3 [▶]
    8 =&gt; array:3 [▶]
    9 =&gt; array:3 [▶]
  ]
  "out_of" =&gt; 100
  "page" =&gt; 1
  "request_params" =&gt; array:3 [▼
    "collection_name" =&gt; "websites"
    "per_page" =&gt; 10
    "q" =&gt; "london"
  ]
  "search_cutoff" =&gt; false
  "search_time_ms" =&gt; 415
]
</code></pre>

<p>This is a great start, I am going to publish this and explore the options for displaying this resulting search json.</p>

<p>Questions/Ideas:</p>

<ol>
<li>Can i search on multiple fields, ie url, description and title at the same time.</li>
<li>Adding the geosearch to the schema and json db, <a href="https://typesense.org/docs/0.23.1/api/geosearch.html#searching-within-a-radius" target="_blank">typesense.org geosearch</a></li>
<li>Extracting the results from the json and the paging.</li>
<li>looking at the javascript instantsearch</li>
</ol>

<p>if anyone has any suggestions, links or tips, please comment below or via <a href="https://twitter.com/andylondon" target="_blank">twitter</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-28-Serverless-Laravel-with-Bref-using-AWS-Lambda-Part-2</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-28-Serverless-Laravel-with-Bref-using-AWS-Lambda-Part-2" />
    <title>Serverless Laravel with Bref using AWS Lambda Part 2</title>
    <published>2022-11-28T00:00:00+00:00</published>
    <updated>2022-11-28T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">So my first idea is to get it working and up and running using my AWS ec2 debian instance which will call a lambda function and spider the website and save the data in the mysql db on the ec2 box.

Firstly I changed a few settings to work with Lambda.......</summary>
    <content type="html"><![CDATA[
        <p>So my first idea is to get it working and up and running using my AWS ec2 debian instance which will call a lambda function and spider the website and save the data in the mysql db on the ec2 box.</p>

<p>Firstly I changed a few settings to work with Lambda. You can only write to the /tmp directory, so it is necessary to change these in the .env file. Following this <a href="https://medium.com/cs-code/deploy-serverless-laravel-application-using-bref-7b114041a695" target="_blank">tutorial</a></p>

<pre><code>CACHE_DRIVER =array
VIEW_COMPILED_PATH =/tmp/storage/framework/views 
SESSION_DRIVER =array 
LOG_CHANNEL =stderr
</code></pre>

<p>pasted the following into app/Providers/AppServiceProvider.php</p>

<pre><code>public function boot()
    {
        // Make sure the directory for compiled views exist
        if (! is_dir(config('view.compiled'))) {
            mkdir(config('view.compiled'), 0755, true);
        }
    }
</code></pre>

<p>and run</p>

<pre><code>php artisan config:cache

php artisan config:clear
</code></pre>

<h2>mysql for remote access to EC2 instance</h2>

<p>Next up I wanted to access a mysql db which is in an EC2 instance on AWS.</p>

<p>Update the mysql config in the /etc/mysql directory to allow external ips like so:</p>

<pre><code>sudo nano 50-server.cnf

bind-address            = 0.0.0.0
</code></pre>

<p>you can alternatively bind to multiple addresses thus:</p>

<pre><code>bind-address = 10.0.0.1,10.0.1.1,10.0.2.1
</code></pre>

<p>open the mysql db in the firewall</p>

<pre><code>iptables -A INPUT -i eth0 -p tcp -m tcp --dport 3306 -j ACCEPT
</code></pre>

<p>add a user to the mysql config</p>

<pre><code>GRANT ALL ON database_name.* TO user@ IDENTIFIED BY 'password';
</code></pre>

<p>And most importantly, adding port 3306 for the mysql db to the AWS security group for the EC2 instance</p>

<p><img src="/assets/images/secGroup.png" alt="aws security group" /></p>

<p>Testing the connection with</p>

<pre><code>mysql -u user -h ec2ipAddress -p
</code></pre>

<p>so now I have a lambda laravel repo which can connect to an external database.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-27-Serverless-Laravel-with-Bref-using-AWS-Lambda-Part-1</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-27-Serverless-Laravel-with-Bref-using-AWS-Lambda-Part-1" />
    <title>Serverless Laravel with Bref using AWS Lambda Part 1</title>
    <published>2022-11-27T00:00:00+00:00</published>
    <updated>2022-11-27T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having worked on improving my suite of spiders, I wanted to expand the coverage to all the websites in the UK area of Openstreetmap and also incorporate more websites for a search engine I have in mind.

One idea to improve the speed and the number of......</summary>
    <content type="html"><![CDATA[
        <p>Having worked on improving my suite of spiders, I wanted to expand the coverage to all the websites in the UK area of Openstreetmap and also incorporate more websites for a search engine I have in mind.</p>

<p>One idea to improve the speed and the number of websites I can index visit is by using serverless technology. This way I could create a server instance for each website spidering sessions and queue them all at once with AWS Lambda.</p>

<p>Using the AWS free tier, you can make 1 million request a month and 400,000 GB seconds of compute time per month, sounds like a lot!</p>

<p>So I started with a normal laravel install</p>

<pre><code>composer create-project laravel/laravel aws-bref-serverless-lambda
cd aws-bref-serverless-lambda/
chmod -R 777 storage/
</code></pre>

<p>I have watched a number of videos to learn how to do this and this was the best to start with. It is made by <a href="https://mobile.twitter.com/matthieunapoli" target="_blank">@matthieunapoli</a></p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/BgGnKqDZSkA" frameborder="0" allowfullscreen></iframe>

<h3>step 1- add laravel bridge</h3>

<pre><code>composer require bref/laravel-bridge --update-with-dependencies
</code></pre>

<h3>step 2- create the serverless.yml file</h3>

<pre><code>php artisan vendor:publish --tag=serverless-config
</code></pre>

<h3>step 3 - install <a href="https://github.com/serverless/serverless" target="_blank">serverless framework</a></h3>

<p>It is made by <a href="https://twitter.com/goserverless/" target="_blank">twitter.com/goserverless/</a></p>

<pre><code>npm install -g serverless
</code></pre>

<h3>step 4 - <a href="https://www.serverless.com/framework/docs/providers/aws/guide/credentials/" target="_blank">configure serverless to access the aws account</a></h3>

<p>by running the command 'serverless' I was able to configure serverless with the secret and access keys for AWS and deploy easily.</p>

<pre><code>$ serverless

? No AWS credentials found, what credentials do you want to use? Local AWS Access Keys
? Do you have an AWS account? Yes

If your browser does not open automatically, please open this URL: 
https://console.aws.amazon.com/iam/home?region=us-east-1#/users$new?step=final&amp;accessKey&amp;userNames=serverless&amp;permissionType=policies&amp;policies=arn:aws:iam::aws:policy%2FAdministratorAccess

? In your AWS account, create an AWS user with access keys. Then press [Enter] to continue.
? AWS Access Key Id: 'key pasted here'
? AWS Secret Access Key: 'secret access key pasted here'

✔ AWS credentials saved on your machine at "~/.aws/credentials". Go there to change them at any time.

? Do you want to deploy now? Yes

Deploying laravel to stage dev (us-east-1)

✔ Service deployed to stack laravel-dev (197s)

endpoint: ANY - https://aaaaaaaaa.execute-api.us-east-1.amazonaws.com
functions:
  web: laravel-dev-web (30 MB)
  artisan: laravel-dev-artisan (30 MB)

What next?
Run these commands in the project directory:

serverless deploy    Deploy changes
serverless info      View deployed endpoints and resources
serverless invoke    Invoke deployed functions
serverless --help    Discover more commands

1 deprecation found: run 'serverless doctor' for more details
</code></pre>

<p>And it was live!</p>

<p>so i deleted it with</p>

<pre><code>serverless remove
</code></pre>

<p>To deploy it again I ran</p>

<pre><code>serverless deploy
</code></pre>

<p>and to run the php artisan cli command and it worked!</p>

<pre><code>$ vendor/bin/bref cli laravel-dev-artisan inspire

  “ Happiness is not something readymade. It comes from your own actions. ”
  — Dalai Lama
</code></pre>

<p>In part 2 i will add some production level code to connect to a mysql database.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-25-Adding-A-Twitter-Card-Meta-Tag-Image</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-25-Adding-A-Twitter-Card-Meta-Tag-Image" />
    <title>Adding A Twitter Card Meta Tag Image</title>
    <published>2022-11-25T00:00:00+00:00</published>
    <updated>2022-11-25T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I have added a Twitter Card image for when I link to a post from Twitter. I had to write a blog post for the Jigsaw Static Site generator to include the image in the build.

Here it is:...</summary>
    <content type="html"><![CDATA[
        <p>Today I have added a Twitter Card image for when I link to a post from Twitter. I had to write a blog post for the Jigsaw Static Site generator to include the image in the build.</p>

<p>Here it is:</p>

<p><img src="/assets/images/TwitterCard.jpg" alt="allotment andy twitter card" /></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-22-Looking-Up-Domains-for-DNS-Entries-with-PHP-and-Dig</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-22-Looking-Up-Domains-for-DNS-Entries-with-PHP-and-Dig" />
    <title>Looking Up Domains for DNS Entries with PHP and Dig</title>
    <published>2022-11-23T00:00:00+00:00</published>
    <updated>2022-11-23T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">One improvement I made today to speed up spidering website domains, is looking up the domain for a DNS-A entry. Using Curl or Guzzle is slowed down when the website has no entry in the DNS. So i started with the basic php function......</summary>
    <content type="html"><![CDATA[
        <p>One improvement I made today to speed up spidering website domains, is looking up the domain for a DNS-A entry. Using Curl or Guzzle is slowed down when the website has no entry in the DNS. So i started with the basic php function <code>dns_get_record</code>, however this isnt very reliable as it often caused an error. The '@' sign is to prevent errors, but there are known bugs with this function. The DNS_ALL option does seem to help, but it is a lot slower than just the A record look up.</p>

<pre><code class="language-php">    $result = @dns_get_record($domain, DNS_A);
</code></pre>

<p>So I decided to use the Linux Command Line tool <strong>dig</strong> which has proved much more reliable.</p>

<pre><code class="language-php">try {
    $result = shell_exec("dig +short ". $domain . ' A');
} catch (Exception $e) {
    break;
}

if (isset($result)) {
    echo " exists" . PHP_EOL;
} else {
    echo "NO dns: " . $domain. PHP_EOL;
}
</code></pre>

<p>This way I can check domains quickly and efficiently and mark those that dont work without wasting time trying to index a website which hasnt even got a DNS entry.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-23-Using-Screen-and-Links2-to-run-a-PHP-Web-Spider-and-Detach-the-Terminal</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-23-Using-Screen-and-Links2-to-run-a-PHP-Web-Spider-and-Detach-the-Terminal" />
    <title>Using Screen and Links2 to run a PHP Web Spider and Detach the Terminal</title>
    <published>2022-11-22T00:00:00+00:00</published>
    <updated>2022-11-22T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I run a PHP based web spider to check the status of websites in londinium.com and was looking for a way to run it in the terminal. In the past I have run it using the refresh html header in a normal browser, but this is a waste as the overhead of sending......</summary>
    <content type="html"><![CDATA[
        <p>I run a PHP based web spider to check the status of websites in <a href="https://londinium.com/" target="_blank">londinium.com</a> and was looking for a way to run it in the terminal. In the past I have run it using the refresh html header in a normal browser, but this is a waste as the overhead of sending it to the computer on my desk adds seconds to the process, and as I am indexing thousands of websites it all adds up.</p>

<p>So I came up with the idea of using a terminal browser <a href="https://packages.debian.org/stable/links2" target="_blank">links2</a> to load the page and using screen to detach from the ssh terminal window so it can run in the background.</p>

<p>I installed both with the lovely apt command on the debian box thus:</p>

<pre><code class="language-shell">sudo apt install screen links2
</code></pre>

<p>and ran it with the '-html-auto-refresh' to allow html refreshes to work.</p>

<pre><code class="language-shell">screen
links2 -html-auto-refresh 1 http://localhost/runProcess 
</code></pre>

<p>Screen allows me to run the process in the background and disconnect leaving it running. To leave the process I use the key combination</p>

<pre><code class="language-shell">ctrl a ctrl d
</code></pre>

<p>then to return to the window type</p>

<pre><code class="language-shell">screen -r
</code></pre>

<p>The advantage is I can log off from the ssh session and reconnect from another computer and return to it. Which also means it can run in the background and you can use the terminal to do other things.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-21-Fixing-Web-Spider-Errors-with-Guzzle-Cookie-Header-Redirects-and-User-Agent</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-21-Fixing-Web-Spider-Errors-with-Guzzle-Cookie-Header-Redirects-and-User-Agent" />
    <title>Fixing Web Spider Errors with Guzzle Cookie Header Redirects and User Agent</title>
    <published>2022-11-21T00:00:00+00:00</published>
    <updated>2022-11-21T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Over the weekend, i ran a spider on the websites listed in the openstreetmap system.

These are the error codes and the counts for these errors




  HTTP Error
  Count




  401
  13


  402
  6


  403
  1274


  404
  2512


  406
  1


  409
  9......</summary>
    <content type="html"><![CDATA[
        <p>Over the weekend, i ran a spider on the websites listed in the openstreetmap system.</p>

<p>These are the error codes and the counts for these errors</p>

<table>
<thead>
<tr>
  <th>HTTP Error</th>
  <th>Count</th>
</tr>
</thead>
<tbody>
<tr>
  <td>401</td>
  <td>13</td>
</tr>
<tr>
  <td>402</td>
  <td>6</td>
</tr>
<tr>
  <td>403</td>
  <td>1274</td>
</tr>
<tr>
  <td>404</td>
  <td>2512</td>
</tr>
<tr>
  <td>406</td>
  <td>1</td>
</tr>
<tr>
  <td>409</td>
  <td>9</td>
</tr>
<tr>
  <td>410</td>
  <td>13</td>
</tr>
<tr>
  <td>423</td>
  <td>2</td>
</tr>
<tr>
  <td>426</td>
  <td>1</td>
</tr>
<tr>
  <td>429</td>
  <td>15</td>
</tr>
<tr>
  <td>453</td>
  <td>1</td>
</tr>
<tr>
  <td>500</td>
  <td>131</td>
</tr>
<tr>
  <td>502</td>
  <td>7</td>
</tr>
<tr>
  <td>503</td>
  <td>165</td>
</tr>
<tr>
  <td>523</td>
  <td>1</td>
</tr>
<tr>
  <td>526</td>
  <td>2</td>
</tr>
<tr>
  <td>530</td>
  <td>4</td>
</tr>
<tr>
  <td>connection exception</td>
  <td>3558</td>
</tr>
<tr>
  <td>request exception</td>
  <td>400</td>
</tr>
</tbody>
</table>

<p>Here is a list explaining the <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" target="_blank">Error Codes</a></p>

<p>The spider uses the <a href="https://docs.guzzlephp.org/en/stable/" target="_blank">Guzzle</a> and works reasonably well.</p>

<p>My first attempt to fix this was to add the following headers to the Guzzle Client, but this didnt help much</p>

<pre><code class="language-php">$jar = new \GuzzleHttp\Cookie\CookieJar();

$client = new \GuzzleHttp\Client(
    [
    'cookies' =&gt; $jar,
    'timeout' =&gt; 8.0,
    'http_errors' =&gt; false,
    'base_uri' =&gt; $url,
    'referer' =&gt; 'http://www.google.com/',
    'allow_redirects' =&gt; ['strict' =&gt; true],
    'Accept-Encoding' =&gt; 'gzip, deflate, br',
    'Accept-Language' =&gt; 'en-GB,en-US;q=0.9,en;q=0.8',
    'Accept' =&gt; 'text/html',
    'User-Agent' =&gt; 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36'
    ]
);
</code></pre>

<p>My second attempt was to use <a href="https://laravel.com/docs/9.x/dusk" target="_blank">Laravel Dusk</a> and <a href="https://github.com/nunomaduro/laravel-console-dusk" target="_blank">nunomaduro's laravel-console-dusk</a> but this had the same problem.</p>

<pre><code class="language-php">    //the cookie file name
    $cookie_file = 'cookies.txt';

    //create the driver
    $process = (new ChromeProcess())-&gt;toProcess();
    $process-&gt;start();
    $options = (new ChromeOptions())-&gt;addArguments(['--disable-gpu','--enable-file-cookies','--no-sandbox', '--headless']);
    $capabilities = DesiredCapabilities::chrome()-&gt;setCapability(ChromeOptions::CAPABILITY, $options);
    $driver = retry(5, function () use ($capabilities) {
        return RemoteWebDriver::create('http://localhost:9515', $capabilities);
    }, 50);

    $this-&gt;browse(function ($browser) use ($id, $nwr, $url) {
        $browser-&gt;visit($url)
                -&gt;pause(5)
</code></pre>

<p>My third attempt was to use <a href="https://www.php.net/manual/en/book.curl.php">Curl</a> and it worked like magic</p>

<pre><code class="language-php">    $ch=curl_init("$url");
    curl_setopt_array($ch, array(
                CURLOPT_USERAGENT=&gt;'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0',
                CURLOPT_ENCODING=&gt;'gzip, deflate',
                CURLOPT_HTTPHEADER=&gt;array(
                        'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                        'Accept-Language: en-US,en;q=0.5',
                        'Accept-Encoding: gzip, deflate',
                        'Connection: keep-alive',
                        'Upgrade-Insecure-Requests: 1',
                ),
    ));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($ch, CURLOPT_AUTOREFERER, true);
    curl_setopt($ch, CURLOPT_MAXREDIRS, 5);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 6);
    curl_setopt($ch, CURLOPT_TIMEOUT, 6);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    // curl_setopt($ch, CURLOPT_VERBOSE, true);

    $htmlORIG=curl_exec($ch);

    if (curl_errno($ch)) {
        print "CURL ERROR: " . curl_error($ch);
    } else {
        curl_close($ch);
    }

    $http_status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    $ip = curl_getinfo($ch, CURLINFO_PRIMARY_IP);
    echo PHP_EOL . $http_status . PHP_EOL;
    echo "IP: " . $ip . PHP_EOL;

</code></pre>

<p>This allowed me to spider sites that the previous 2 had blocked and solved all the false errors from the first Guzzle based spider.</p>

<p>Although not perfect, it still has problems with sites using <a href="https://www.cloudflare.com/" target="_blank">Cloudflare</a> It was a huge step in the right direction.</p>

<p>Would be interested in hearing from others about how they handle spidering sites protected by Cloudflare. Also ways to do the same when using Guzzle and Laravel Dusk.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-09-Azure-Free-Tier-Debian-11-and-Ansible-Installing-a-Lamp-server</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-09-Azure-Free-Tier-Debian-11-and-Ansible-Installing-a-Lamp-server" />
    <title>Azure Free Tier Debian 11 and Ansible Installing a Lamp server</title>
    <published>2022-11-09T00:00:00+00:00</published>
    <updated>2022-11-09T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I got an email from Microsoft azure that a 30 day trial was ending and that I now had a 12 month fee basic tier level service, which is nice.

I have set up a debian box to play with, just like I have a free debian EC2 instance on AWS :)

Following......</summary>
    <content type="html"><![CDATA[
        <p>Today I got an email from Microsoft azure that a 30 day trial was ending and that I now had a 12 month fee basic tier level service, which is nice.</p>

<p>I have set up a debian box to play with, just like I have a free debian EC2 instance on AWS :)</p>

<p>Following the steps in the browser, i created a VM and logged in</p>

<pre><code>ssh -i ~/.ssh/key.pem azureuser@1.2.3.4
</code></pre>

<p>note it is <em>azureuser</em> but the rest is the same process as setting up on AWS or locally.</p>

<p>I started with a copy of my <a href="https://github.com/allotmentandy/aws/tree/master/Part%203%20-%20using%20Ansible%20to%20setup%20the%20server." target="_blank">Ansible-aws repo</a>  and duplicated it for the azure server.</p>

<p>So now I have uploaded this as <a href="https://github.com/allotmentandy/ansible-debian-azure-lamp" target="_blank">Ansible-Azure-Debian-Lamp</a> and ran it like so:</p>

<pre><code>ansible-playbook main.yml --key-file /home/andy/.ssh/PRIVATEKEY.pem  -e 'ansible_python_interpreter=/usr/bin/python3'
</code></pre>

<p>There was only 2 errors and having made the following changes to deal with errors, it worked.</p>

<h2>Errors</h2>

<p>FAILED! => {"changed": false, "msg": "No package matching 'python-pymysql' is available"}</p>

<p>solution: remove python-pymysql as it is already installing python3-pymysql</p>

<p>FAILED! => {"changed": false, "msg": "Failed to find required executable gpg in paths: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"}</p>

<p>solution: add gnupg to the packages to install</p>

<p>and it all worked!</p>

<h2>setting up laravel</h2>

<p>I uploaded a laravel app to /var/www/laravel and the ansible scripts setup the apache to work, setting up the laravel app with the usual composer install and chmod the /storage directory. The only issue was with user permissions as the /var/www/ directory is owned by root which i solved with.</p>

<pre><code>sudo chown -R $USER:$USER
</code></pre>

<p>and now i have a working laravel app setup with ansible in less than an hour :)</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-06-Ebook-Making-With-Markdown-to-PDF-with-Ibis</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-06-Ebook-Making-With-Markdown-to-PDF-with-Ibis" />
    <title>Ebook Making With Markdown to PDF with Ibis</title>
    <published>2022-11-06T00:00:00+00:00</published>
    <updated>2022-11-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Over the weekend, I was looking into making ebooks out of a directory of markdown files. I use markdown for this blog and also for my to-do list, so i started looking at what was available. I tried mdbook, a rust tool, but couldnt get the pdf maker to......</summary>
    <content type="html"><![CDATA[
        <p>Over the weekend, I was looking into making ebooks out of a directory of markdown files. I use markdown for this blog and also for my to-do list, so i started looking at what was available. I tried mdbook, a rust tool, but couldnt get the pdf maker to work, and it didn't really work in a way I was expecting, it seems more like a documentation website maker.</p>

<p>I thought, 'There must be a Laravel way', and after some searching, <a href="https://mobile.twitter.com/themsaid/">@themsaid</a> has made <a href="http://github.com/themsaid/ibis" target="_blank">Ibis</a> which is lovely, fast, works well and looking at the source code, is fairly simple.</p>

<p>I installed it slightly differently to the instructions installing it in the new ebook directory like so:</p>

<pre><code>composer require themsaid/ibis:* -W
</code></pre>

<p>The initialization command to create the repo was this</p>

<pre><code>./vendor/bin/ibis init
</code></pre>

<p>It comes with an example 6 markdown pages of one of Mohamed's Books and the command to make the pdf was like so</p>

<pre><code>./vendor/bin/ibis build
</code></pre>

<p>This created a a nice clean pdf with minimal fuss. You can use css to style it and it accepts images in the /assets directory.</p>

<p>The one thing i wonder is how would you create an index at the back? But for today, this is a nice new tool and I can focus on writing the markdown.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-11-03-Laravel-Routes-from-Database</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-11-03-Laravel-Routes-from-Database" />
    <title>Laravel Routes from Database</title>
    <published>2022-11-03T00:00:00+00:00</published>
    <updated>2022-11-03T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have grown my website to have over 8000 lines in the routes files!

These are only calling 6 controllers and simple static views, like so:



But these make up the majority of them, so now it is time to address this and move them to a database table......</summary>
    <content type="html"><![CDATA[
        <p>I have grown my website to have over 8000 lines in the routes files!</p>

<p>These are only calling 6 controllers and simple static views, like so:</p>

<pre><code>Route::get('/embassy', ['uses' =&gt;'FeatureController@index'])-&gt;where(['feature'=&gt;"amenity=embassy"]);

Route::get("/lidl", ['uses' =&gt;'BrandController@index'])-&gt;where(['brand'=&gt;"Lidl"]);

Route::get('/NW9', ['uses' =&gt;'PlaceController@index'])-&gt;where(['lat'=&gt;"51.58", 'long'=&gt; "-0.25", 'feature'=&gt; "The Hyde"]);
Route::get('/Somerset_Ilminster', ['uses' =&gt;'PlaceController@index'])-&gt;where(['lat'=&gt;'50.926998', 'long'=&gt; '-2.913960', 'feature'=&gt; 'Ilminster_(Somerset)']);
</code></pre>

<p>But these make up the majority of them, so now it is time to address this and move them to a database table for the feature, brand and place controllers.</p>

<p>I am planning to use <a href="https://laravel.com/docs/9.x/routing#fallback-routes">Fallback routes</a> as the last route in the /routes/web.php file to send them all a RouteController which will read the db and send them to the correct router.</p>

<p>Having a quick look at projects online on github, <a href="https://github.com/luensys/laravel-database-routes">https://github.com/luensys/laravel-database-routes</a> seems to import the routes from the route file into a database, and so does this one <a href="https://github.com/douma/laravel-database-routes">https://github.com/douma/laravel-database-routes</a></p>

<p>wonder if anyone has used these?</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-10-28-PHPStan-static-analysis</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-10-28-PHPStan-static-analysis" />
    <title>PHPStan static analysis</title>
    <published>2022-10-28T00:00:00+00:00</published>
    <updated>2022-10-28T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I took the plunge and installed PHPStan, or rather larastan which is a static analysis tool to check code for errors and missing return types.



create a rules file called &#039;phpstan.neon&#039;



So i started at level 0, which is the lowest level and......</summary>
    <content type="html"><![CDATA[
        <p>Today I took the plunge and installed <a href="https://phpstan.org/">PHPStan</a>, or rather <a href="https://github.com/nunomaduro/larastan/">larastan</a> which is a static analysis tool to check code for errors and missing return types.</p>

<pre><code>composer require nunomaduro/larastan:^2.0 --dev
</code></pre>

<p>create a rules file called 'phpstan.neon'</p>

<pre><code>includes:
    - ./vendor/nunomaduro/larastan/extension.neon

parameters:

    paths:
        - app/

    # Level 9 is the highest level
    level: 0

#    ignoreErrors:
#        - '#PHPDoc tag @var#'
#
#    excludePaths:
#        - ./*/*/FileToBeExcluded.php
#
#    checkMissingIterableValueType: false
</code></pre>

<p>So i started at level 0, which is the lowest level and ran it thus:</p>

<pre><code>./vendor/bin/phpstan analyse
</code></pre>

<p>and it passed</p>

<p><img src="/assets/images/phpstan0.png" alt="phpstan level 0" /></p>

<p>level 1 was my first failure</p>

<p><img src="/assets/images/phpstan1.png" alt="phpstan level 1" /></p>

<p>so i added</p>

<pre><code>        if (!isset($prefix)) {
            abort(404);
        }
</code></pre>

<p>and its green</p>

<p>how cool :)</p>

<p>level 5 started with more errors</p>

<p><img src="/assets/images/phpstan5.png" alt="phpstan level 5" /></p>

<p>so i added a return type for the views</p>

<pre><code>use Illuminate\Contracts\View\View;

class BrandController extends Controller
{
    public function index(): View
</code></pre>

<p><img src="/assets/images/phpstan5b.png" alt="phpstan level 5b" /></p>

<p>There was also redirects which needed</p>

<pre><code>use Illuminate\Http\RedirectResponse;

class NWRController extends Controller
{
    public function index(Request $request, $id): View|RedirectResponse
</code></pre>

<p>I added a few types in the function arguments and it is all green!</p>

<p>Level 8</p>

<p><img src="/assets/images/phpstan8.png" alt="phpstan level 8" /></p>

<p>this error is caused by this code</p>

<pre><code>14        $route = (\Route::current());

16        $data['brand'] = $route-&gt;wheres['brand'];

</code></pre>

<p>and I am not sure of the solution to this as (string) doesnt work. Any ideas appreciated...</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-10-12-Upgrade-Apache-To-PHP-81-with-Ansible-on-Debian</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-10-12-Upgrade-Apache-To-PHP-81-with-Ansible-on-Debian" />
    <title>Upgrade Apache To PHP 8.1 with Ansible on Debian</title>
    <published>2022-10-12T00:00:00+00:00</published>
    <updated>2022-10-12T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">My local Debian machine has Apache and PHP working and I have set it up with this Ansible playbook github.com/allotmentandy/ansible-debian-install-desktop

Today as part of the upgrade process for my laravel site, I wanted to update this Ansible Playbook......</summary>
    <content type="html"><![CDATA[
        <p>My local Debian machine has Apache and PHP working and I have set it up with this Ansible playbook <a href="https://github.com/allotmentandy/ansible-debian-install-desktop">github.com/allotmentandy/ansible-debian-install-desktop</a></p>

<p>Today as part of the upgrade process for my laravel site, I wanted to update this Ansible Playbook to use PHP 8.1.</p>

<p>The older versions of laravel are now all out-of-date, see <a href="https://laravel.com/docs/9.x/releases#support-policy">laravel.com/docs/9.x/releases#support-policy</a> so it is time to upgrade to the latest and greatest version of php 8.1. (I know php 8.2 is out, but that isnt mentioned on the laravel php versions, so I will leave that for another day)</p>

<p>The first step was to add the install to <a href="https://github.com/allotmentandy/ansible-debian-install-desktop/blob/main/roles/php/tasks/main.yml">roles/php/tasks/main.yml</a> like so:</p>

<pre><code># install php8.1

- name: install php 8.1 packages
  tags: php8.1
  apt:
    name:
      - php8.1
      - php-mysql
      - libapache2-mod-php
      - php8.1-mysql
      - php8.1-cli
      - php8.1-common
      - php8.1-snmp
      - php8.1-ldap
      - php8.1-curl
      - php8.1-mbstring
      - php8.1-zip
      - php8.1-tidy
      - php8.1-opcache
      - php8.1-xml
      - php8.1-fpm 
      - libapache2-mod-php8.1
    state: present
    cache_valid_time: 3600
  become: True
</code></pre>

<p>I added a tag for php8.1 to the Ansible playbook to allow me to just run this</p>

<pre><code> ansible-playbook -i hosts workstation.yml --ask-become-pass --ask-pass --tags php8.1
</code></pre>

<p>Althought this worked, the command line version of php was 8.1, the apache webserver was still 8.0. After hunting around, i found this was required to totally stop the php8.0 version and have 8.1 on the webserver.</p>

<pre><code>sudo systemctl stop php8.0-fpm
sudo systemctl disable php8.0-fpm
sudo a2disconf php8.0-fpm

sudo systemctl start php8.1-fpm
sudo systemctl enable php8.1-fpm

</code></pre>

<p>This translates into Ansible playbook as thus:</p>

<pre><code>- name: Stop service php8.0-fpm on debian, if running
  tags: php8.1
  ansible.builtin.systemd:
    name: php8.0-fpm
    state: stopped

- name: Enable service php8.0-fpm and ensure it is not masked
  tags: php8.1  
  ansible.builtin.systemd:
    name: php8.0-fpm
    enabled: no

- name: Disables the Apache2 module php8.0-fpm
  tags: php8.1  
  community.general.apache2_module:
    state: absent
    name: php8.0-fpm

- name: Make sure php8.1-fpm is running
  tags: php8.1
  ansible.builtin.systemd:
    state: started
    name: php8.1-fpm

- name: Enable service php8.1-fpm and ensure it is not masked
  tags: php8.1
  ansible.builtin.systemd:
    name: php8.1-fpm
    enabled: yes

</code></pre>

<p>Now the apache server and command line are both using PHP 8.1.</p>

<p>This has been pushed to the github ansible playbook repo, hope it helps you.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-10-10-Upgrading-Laravel-7-to-Laravel-9</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-10-10-Upgrading-Laravel-7-to-Laravel-9" />
    <title>Upgrading Laravel 7 to Laravel 9</title>
    <published>2022-10-10T00:00:00+00:00</published>
    <updated>2022-10-10T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">This weekend, I have decided it is time to upgrade my londinium.com website from Laravel 7 to the latest Laravel 9. As PHP is now in version 8.1 and the latest version of Laravel needs a minimum of PHP 8.0, so it is a good time to upgrade the website.......</summary>
    <content type="html"><![CDATA[
        <p>This weekend, I have decided it is time to upgrade my <a href="">londinium.com</a> website from Laravel 7 to the latest Laravel 9. As PHP is now in version 8.1 and the latest version of Laravel needs a minimum of PHP 8.0, so it is a good time to upgrade the website.</p>

<p>Although i could have used a website service like <a href="https://laravelshift.com/">Laravel Shift</a>, I wanted to do it by hand to see the differences.</p>

<p>First step is to install an empty version of laravel 9 which gives me 2 versions with the following URLs</p>

<ul>
<li>localhost:81</li>
<li>localhost:91</li>
</ul>

<p>I simply copied over the files from the old version to the new repo</p>

<ul>
<li>/app/http/controllers</li>
<li>/resources/views</li>
<li>/routes</li>
<li>/public/css</li>
<li>/public/js</li>
<li>/public/images</li>
</ul>

<p>and updated the .env file with the db variables and a few settings.</p>

<h3>Error: Target Class Controller Does Not Exist</h3>

<p>When i loaded the localhost:91/ i got an error that the "Target Class Controller Does Not Exist" this is explained here</p>

<p><a href="https://laravel.com/docs/8.x/upgrade#automatic-controller-namespace-prefixing">laravel.com/docs/8.x/upgrade</a> and here 
<a href="https://stackoverflow.com/questions/63807930/error-target-class-controller-does-not-exist-when-using-laravel-8">stackoverflow.com/questions/63807930/error-target-class-controller-does-not-exist-when-using-laravel-8</a></p>

<p>There are a number of solutions but this worked.</p>

<pre><code>Define namespace in RouteServiceProvider as an old version. 

App\Providers\RouteServiceProvider
public function boot()
    {
        $this-&gt;configureRateLimiting();

        $this-&gt;routes(function () {
            Route::prefix('api')
                -&gt;middleware('api')
                -&gt;namespace($this-&gt;namespace)
                -&gt;namespace('App\Http\Controllers')  &lt;------------ Add this
                -&gt;group(base_path('routes/api.php'));

            Route::middleware('web')
                -&gt;namespace($this-&gt;namespace)
                -&gt;namespace('App\Http\Controllers') &lt;------------- Add this
                -&gt;group(base_path('routes/web.php'));
        });
    }
</code></pre>

<p>The process was pretty easy and this got the basic site working. In the next blog posts I will explain upgrading the php version and also getting the laravel mix, vite and webpack build process working.</p>

<p>It is a delight to work with Laravel, the latest versions are not very different from each others and I enjoy the stability this framework provides. Big thanks to Taylor Otwell and the team.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-10-05-Adding-Lat-Long-Map-links-For-Photos-To-Londinium</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-10-05-Adding-Lat-Long-Map-links-For-Photos-To-Londinium" />
    <title>Adding Lat Long Map links For Photos To Londinium</title>
    <published>2022-10-05T00:00:00+00:00</published>
    <updated>2022-10-05T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">There was an Openstreetmap London meetup in The Monkey Puzzle Pub near Paddington Station which got me thinking about adding images of the Pub to that page. Openstreetmap does allow one image as a tag, but this pub doesnt have one, so I looked......</summary>
    <content type="html"><![CDATA[
        <p>There was an Openstreetmap London meetup in <a href="https://londinium.com/node/15262028">The Monkey Puzzle Pub</a> near Paddington Station which got me thinking about adding images of the Pub to that page. Openstreetmap does allow one image as a tag, but this pub doesnt have one, so I looked elsewhere.</p>

<p>These are websites that have images based on the Latitude and Longitude co-ordinates, which is a good start</p>

<p><a href="https://www.flickr.com/nearby/51.516481,-0.1698266/">flickr.com</a></p>

<p><a href="https://www.mapillary.com/app/?lat=51.516481&amp;lng=-0.1698266@z=17">mapillary.com</a></p>

<p><a href="http://openpoimap.org/?map=various&amp;zoom=14&amp;lat=51.516481&amp;lon=-0.1698266&amp;layers=B00FFFFFFFFFFFFFTFFFFFF">openpoimap.org</a></p>

<p>In turn this got me thinking about adding links to anything using the Lat/Long of the site.</p>

<p><a href="https://www.google.co.uk/maps/@51.516481,-0.1698266,17z">google.co.uk/maps</a></p>

<p><a href="https://www.bing.com/maps?cp=51.516481%7E-0.1698266&amp;lvl=14.9&amp;style=h">bing.com/maps</a></p>

<p><a href="https://osmaps.ordnancesurvey.co.uk/51.516481,-0.1698266,17/pin">osmaps.ordnancesurvey.co.uk</a></p>

<p><a href="https://maps.apple.com/place?ll=51.516481,-0.1698266">maps.apple.com</a></p>

<p>And this is what the links look like on the details pages for any location:</p>

<p><img src="/assets/images/externalLinks.png" class="mb-6"></p>

<p>So you can now vist the <a href="https://londinium.com/node/15262028">The Monkey Puzzle Pub</a> page and find images locally.</p>

<p>I wonder what else could be added with links to latitude and longitude, please reply in the comments below.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-10-03-Adding-Blog-Post-Comments</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-10-03-Adding-Blog-Post-Comments" />
    <title>Adding Blog Post Comments</title>
    <published>2022-10-03T00:00:00+00:00</published>
    <updated>2022-10-03T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">This morning @AshAllenDesign was asking about removing Disqus comments from his website and adding them is something I have been thinking about. But I never really liked the look of Disqus as it seemed a bit overkill for the simple commenting I wanted.......</summary>
    <content type="html"><![CDATA[
        <p>This morning <a href="https://twitter.com/AshAllenDesign" target="_blank">@AshAllenDesign</a> was asking about removing Disqus comments from his website and adding them is something I have been thinking about. But I never really liked the look of Disqus as it seemed a bit overkill for the simple commenting I wanted. Ash mentioned <a href="https://twitter.com/amit_merchant/" target="_blank">@amit_merchant</a> a prolific PHP blogger used <a href="https://utteranc.es/" target="_blank">utteranc.es/</a> and it stores the comments in github comments. The login uses github, which is good, as this is a github blog and I write mainly about code.</p>

<p>So I added it, and you can see them at the base of this page.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-09-12-August-2022-Allotment-Andy-Update</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-09-12-August-2022-Allotment-Andy-Update" />
    <title>August 2022 Allotment Andy Update</title>
    <published>2022-09-12T00:00:00+00:00</published>
    <updated>2022-09-12T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Has been a funny month, hot and dry but most of the plants seemed to have loved it. Plenty of watering of course but now the harvest of apples, plums, tomatoes, purslane and a lot more in earnest.

Planted a green manure on a 10m sqare plot. Never tried......</summary>
    <content type="html"><![CDATA[
        <p>Has been a funny month, hot and dry but most of the plants seemed to have loved it. Plenty of watering of course but now the harvest of apples, plums, tomatoes, purslane and a lot more in earnest.</p>

<p>Planted a green manure on a 10m sqare plot. Never tried before, but just threw the seed across a couple of empty beds and will see how it goes.</p>

<p>Moved a lot of compost onto the big compost heap, made space for the pond i want to make. Covered it all with 6 wheelbarrows of fresh horse.manure. looks nice and big again.</p>

<p>Big harvest of tomatoes, they never stop coming. Cucumbers too.</p>

<p>Finally, the peppers have started to appear, i started them the same time as the tomatoes, but they never really got going.</p>

<p>Things to grow next year: pumpkin patch with corn and beans (3 companion plants)</p>

<p>Things i didnt grow well: peas</p>

<p>Things to plant : leeks, pak choi, spinach</p>

<p>Get grape cuttings from other allotment holders.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-09-11-September-2022-Allotment-Andy-Update</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-09-11-September-2022-Allotment-Andy-Update" />
    <title>Allotment Andy Update</title>
    <published>2022-09-11T00:00:00+00:00</published>
    <updated>2022-09-11T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I am back, blogging now.

Having spent most of the summer allotment gardening and watching private jets at Farnborough Airport, I feel refreshed and am now back to write more blogs.

Planning to write a monthly allotment blog and focus the blog more on......</summary>
    <content type="html"><![CDATA[
        <p>I am back, blogging now.</p>

<p>Having spent most of the summer allotment gardening and watching private jets at Farnborough Airport, I feel refreshed and am now back to write more blogs.</p>

<p>Planning to write a monthly allotment blog and focus the blog more on the Allotment side of Andy. Also going to write pages for specific plants I like to grow.</p>

<p>Also going to add recipes for a number of the preserves I have made including chutney and tomato relish.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-04-16-Making-website-screenshot-images-with-spatie-browsershot</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-04-16-Making-website-screenshot-images-with-spatie-browsershot" />
    <title>Making website screenshot images with spatie browsershot</title>
    <published>2022-04-16T00:00:00+00:00</published>
    <updated>2022-04-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I decided to make screenshots of webpages with spatie/browsershot

To install I ran:



I also ensured that Puppeteer and chromium-browser were installed, on debian I used.



The code is fairly straightforward, I added this to my existing spider......</summary>
    <content type="html"><![CDATA[
        <p>Today I decided to make screenshots of webpages with <a href="https://spatie.be/docs/browsershot/v2/introduction">spatie/browsershot</a></p>

<p>To install I ran:</p>

<pre><code class="language-bash">composer require spatie/browsershot
</code></pre>

<p>I also ensured that Puppeteer and chromium-browser were installed, on debian I used.</p>

<pre><code class="language-bash">export PUPPETEER_SKIP_DOWNLOAD='true'
npm install puppeteer --global
apt install -y chromium-browser
</code></pre>

<p>The code is fairly straightforward, I added this to my existing spider and it worked.</p>

<pre><code class="language-php">use Spatie\Browsershot\Browsershot;
    try {       
        Browsershot::url($url)
        -&gt;timeout(120)
        -&gt;setNodeBinary('/usr/bin/node')
        -&gt;setScreenshotType('jpeg', 100)
        -&gt;save("/images/".$id.".jpg");
    } catch (\Exception $e) {
        info($e-&gt;getMessage());
    }
</code></pre>

<p>one idea I had is to change the user agent to</p>

<pre><code>    -&gt;userAgent('Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.50 Safari/537.36')
</code></pre>

<p>I added it to a guzzle based spider, with a payload of 416 websites. This made 343 screenshots and the guzzle spider only 329! A number of these are 404 errors (not found) that I will fix and run it again, but it was nice to getting it work better than guzzle.</p>

<p>Now there is the issue of the cookie popups and dealing with them....</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-04-13-Website-metrics</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-04-13-Website-metrics" />
    <title>Website metrics</title>
    <published>2022-04-13T13:20:00+00:00</published>
    <updated>2022-04-13T13:20:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">looking for sources to create a website score and metrics for a domain / url...</summary>
    <content type="html"><![CDATA[
        <p>I was looking at ways to rate a website so I installed <a href="https://packagist.org/packages/seostats/seostats">seostats/seostats</a> but there wasnt any data available from the free sources. I am looking for ways to rate a website including the following ways.</p>

<ul>
<li>total number of website pages</li>
<li>total number of incoming links</li>
<li>Google Pagerank</li>
<li>Alexa Traffic Rank</li>
<li>Mozscape::getMozRank</li>
<li>Mozscape::getDomainAuthority</li>
<li>SemRush::getDomainRank</li>
<li>Domain name value</li>
<li>Age - date registered</li>
<li>Web Server speed</li>
<li>Competitors / similar websites</li>
</ul>

<p>I want a way to get metrics like this from an API weekly to update the 'scores' for each website, so am contacting people who maybe able to help. If you can offer any advice, please get in touch.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin" />
    <title>Adding share buttons for Twitter, Facebook and LinkedIn</title>
    <published>2022-04-12T00:00:00+00:00</published>
    <updated>2022-04-12T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Adding share this buttons for each page on social media...</summary>
    <content type="html"><![CDATA[
        <p>Following on from yesterdays post, I have created a partial with the share buttons like so: It encodes the url with the php <kbd>urlencode</kbd> function and links to the social media giants share pages. This converts</p>

<p>https://allotmentandy.github.io/blog/2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin/</p>

<p>into</p>

<p>https%3A%2F%2Fallotmentandy.github.io%2Fblog%2F2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin%2F</p>

<pre><code>&lt;div class='flex items-center justify-center gap-4'&gt;
    &lt;div class="p-4"&gt;
    &lt;?php
    $shareURL = urlencode(url()-&gt;current());
    ?&gt;
    Share this page on:

    &lt;a href="https://www.facebook.com/sharer/sharer.php?u=&lt;?php echo $shareURL; ?&gt;" target="_blank" class="bg-blue-100 rounded p-4 m-2 border-1 border-black rounded-full  hover:bg-indigo-200 hover:text-black"&gt;
    &lt;img class="inline" width=25 src="/images/facebook.svg"&gt; Facebook&lt;/a&gt;

    &lt;a href="https://twitter.com/intent/tweet?text=my share text&amp;amp;url=&lt;?php echo $shareURL; ?&gt;"  target="_blank"  class="bg-blue-100 rounded p-4 m-2 border-1 border-black rounded-full  hover:bg-indigo-200 hover:text-black"&gt;
    &lt;img class="inline" width=25 src="/images/twitter.svg"&gt; Twitter&lt;/a&gt;

    &lt;a href="http://www.linkedin.com/shareArticle?mini=true&amp;amp;url=&lt;?php echo $shareURL; ?&gt;" target="_blank" class="bg-blue-100 rounded p-4 m-2 border-1 border-black rounded-full  hover:bg-indigo-200  hover:text-black" &gt;
    &lt;img class="inline" width=25 src="/images/linkedin.svg"&gt; LinkedIn &lt;/a&gt;

  &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>This is what it looks like (adapted slightly for this blog)</p>

<div class='flex items-center justify-center gap-4'>
    <div class="p-4">

    Share this page on:

    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fallotmentandy.github.io%2Fblog%2F2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin%2F" target="_blank" class="bg-blue-100 rounded p-4 m-2 border-1 border-black rounded-full  hover:bg-indigo-200 hover:text-black">
    <img class="inline" width=25 src="/assets/img/facebook.svg"> Facebook</a>

    <a href="https://twitter.com/intent/tweet?text=my share text&amp;url=https%3A%2F%2Fallotmentandy.github.io%2Fblog%2F2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin%2F"  target="_blank"  class="bg-blue-100 rounded p-4 m-2 border-1 border-black rounded-full  hover:bg-indigo-200 hover:text-black">
    <img class="inline" width=25 src="/assets/img/twitter.svg"> Twitter</a>

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fallotmentandy.github.io%2Fblog%2F2022-04-12-Adding-share-buttons-for-twitter-facebook-and-linkedin%2F" target="_blank" class="bg-blue-100 rounded p-4 m-2 border-1 border-black rounded-full  hover:bg-indigo-200  hover:text-black" >
    <img class="inline" width=25 src="/assets/img/linkedin.svg"> LinkedIn </a>

  </div>
</div>

<p>I need to publish it to test it out, now, fingers crossed</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-04-11-Adding-social-media-share-buttons-with-meta-tags-for-facebook-and-twitter</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-04-11-Adding-social-media-share-buttons-with-meta-tags-for-facebook-and-twitter" />
    <title>Adding social media share buttons with meta tags for facebook and twitter</title>
    <published>2022-04-11T00:00:00+00:00</published>
    <updated>2022-04-11T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Was looking into adding buttons on my website to share the page link to Facebook, Twitter and Linkedin. The packages I found all had limitations, so I decided to code it all myself. The code is going to look something like this



Looking into these......</summary>
    <content type="html"><![CDATA[
        <p>Was looking into adding buttons on my website to share the page link to Facebook, Twitter and Linkedin. The packages I found all had limitations, so I decided to code it all myself. The code is going to look something like this</p>

<pre><code class="language-html">Share this page on:

&lt;div id="social-links"&gt;
&lt;a href="https://www.facebook.com/sharer/sharer.php?u=&lt;?php echo url()-&gt;current();?&gt;"  id=""&gt;
    &lt;img class="inline" width=25 src="/images/facebook.svg\"&gt;&lt;/a&gt;

&lt;a href="https://twitter.com/intent/tweet?text=my share text&amp;amp;url=&lt;?php echo url()-&gt;current();?&gt;"&gt;
    &lt;img class="inline" width=25 src="/images/twitter.svg\"&gt;&lt;/a&gt;

&lt;a href="http://www.linkedin.com/shareArticle?mini=true&amp;amp;url=&lt;?php echo url()-&gt;current();?&gt;&amp;amp;title=my share text&amp;amp;summary=dit is de linkedin summary"&gt;
    &lt;img class="inline" width=25 src="/images/linkedin.svg"&gt; &lt;/a&gt;

&lt;/div&gt;
</code></pre>

<p>Looking into these links, I discovered that is best to have meta tags to help both facebook and twitter to display cards, otherwise they have to guess what the links are about on the page.</p>

<p>Facebook docs</p>

<p><a href="https://developers.facebook.com/docs/sharing/webmasters/" target="_blank">developers.facebook.com/docs/sharing/webmasters/</a></p>

<p>Twitter docs</p>

<p><a href="https://developer.twitter.com/en/docs/twitter-for-websites/cards/guides/getting-started" target="_blank">developer.twitter.com/en/docs/twitter-for-websites/cards/guides/getting-started</a></p>

<p>OpenGraph Docs</p>

<p><a href="https://ogp.me/" target="_blank">https://ogp.me/</a></p>

<p>I also wrote some code to extract the most popular meta tags from a website spider I ran to see the top 50 most common meta tags used. I was surprised at the ammount of sites with the opengraph meta tags.</p>

<table>
<thead>
<tr>
  <th>Metatag</th>
  <th>Count</th>
</tr>
</thead>
<tbody>
<tr>
  <td>viewport</td>
  <td>47943</td>
</tr>
<tr>
  <td>description</td>
  <td>40094</td>
</tr>
<tr>
  <td>og:title</td>
  <td>27531</td>
</tr>
<tr>
  <td>og:url</td>
  <td>25707</td>
</tr>
<tr>
  <td>og:type</td>
  <td>24986</td>
</tr>
<tr>
  <td>og:description</td>
  <td>23818</td>
</tr>
<tr>
  <td>robots</td>
  <td>23078</td>
</tr>
<tr>
  <td>og:site_name</td>
  <td>23035</td>
</tr>
<tr>
  <td>twitter:card</td>
  <td>21264</td>
</tr>
<tr>
  <td>generator</td>
  <td>17519</td>
</tr>
<tr>
  <td>X-UA-Compatible</td>
  <td>17504</td>
</tr>
<tr>
  <td>og:image</td>
  <td>16992</td>
</tr>
<tr>
  <td>keywords</td>
  <td>15609</td>
</tr>
<tr>
  <td>og:locale</td>
  <td>14901</td>
</tr>
<tr>
  <td>Content-Type</td>
  <td>14035</td>
</tr>
<tr>
  <td>twitter:title</td>
  <td>12400</td>
</tr>
<tr>
  <td>google-site-verification</td>
  <td>11492</td>
</tr>
<tr>
  <td>twitter:description</td>
  <td>10984</td>
</tr>
<tr>
  <td>msapplication-TileImage</td>
  <td>10827</td>
</tr>
<tr>
  <td>article:modified_time</td>
  <td>8901</td>
</tr>
<tr>
  <td>theme-color</td>
  <td>8071</td>
</tr>
<tr>
  <td>twitter:site</td>
  <td>8025</td>
</tr>
<tr>
  <td>og:image:width</td>
  <td>6952</td>
</tr>
<tr>
  <td>twitter:image</td>
  <td>6931</td>
</tr>
<tr>
  <td>og:image:height</td>
  <td>6923</td>
</tr>
<tr>
  <td>author</td>
  <td>5314</td>
</tr>
<tr>
  <td>twitter:label1</td>
  <td>5175</td>
</tr>
<tr>
  <td>twitter:data1</td>
  <td>5175</td>
</tr>
<tr>
  <td>msapplication-TileColor</td>
  <td>5172</td>
</tr>
<tr>
  <td>format-detection</td>
  <td>4711</td>
</tr>
<tr>
  <td>content-type</td>
  <td>3302</td>
</tr>
<tr>
  <td>twitter:creator</td>
  <td>3066</td>
</tr>
<tr>
  <td>msvalidate.01</td>
  <td>2993</td>
</tr>
<tr>
  <td>article:publisher</td>
  <td>2944</td>
</tr>
<tr>
  <td>twitter:url</td>
  <td>2475</td>
</tr>
<tr>
  <td>facebook-domain-verification</td>
  <td>2340</td>
</tr>
<tr>
  <td>og:image:secure_url</td>
  <td>2305</td>
</tr>
<tr>
  <td>x-ua-compatible</td>
  <td>2103</td>
</tr>
<tr>
  <td>og:image:type</td>
  <td>2090</td>
</tr>
<tr>
  <td>apple-mobile-web-app-capable</td>
  <td>2022</td>
</tr>
<tr>
  <td>msapplication-config</td>
  <td>1966</td>
</tr>
<tr>
  <td>title</td>
  <td>1806</td>
</tr>
<tr>
  <td>HandheldFriendly</td>
  <td>1799</td>
</tr>
<tr>
  <td>fb:app_id</td>
  <td>1671</td>
</tr>
<tr>
  <td>application-name</td>
  <td>1666</td>
</tr>
<tr>
  <td>Description</td>
  <td>1651</td>
</tr>
<tr>
  <td>p:domain_verify</td>
  <td>1480</td>
</tr>
<tr>
  <td>MobileOptimized</td>
  <td>1472</td>
</tr>
<tr>
  <td>copyright</td>
  <td>1413</td>
</tr>
<tr>
  <td>revisit-after</td>
  <td>1360</td>
</tr>
<tr>
  <td>apple-mobile-web-app-title</td>
  <td>1314</td>
</tr>
<tr>
  <td>Keywords</td>
  <td>1297</td>
</tr>
</tbody>
</table>

<p>So with this in mind, I decided to use the following new meta tags</p>

<pre><code class="language-html">&lt;meta name="twitter:card" content="summary" /&gt;
&lt;meta name="twitter:site" content="@londiniumcom" /&gt;
&lt;meta name="twitter:creator" content="@londiniumcom" /&gt;
&lt;meta name="twitter:title" content="title" /&gt;
&lt;meta property="og:url" content="&lt;?php echo url()-&gt;current();?&gt;" /&gt;
&lt;meta property="og:title" content="" /&gt;
&lt;meta property="og:type" content="website" /&gt;
&lt;meta property="og:description" content="Londinium.com - London maps, directory and information" /&gt;
&lt;meta property="og:site_name" content="https://londinium.com" /&gt;
&lt;meta property="description" content="Londinium.com - London maps, directory and information" /&gt;
</code></pre>

<p>I am going to implement this with a new laravel blade partial.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-28-Monday-Morning-Updating-The-Database-And-Improving-The-Website-Spider</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-28-Monday-Morning-Updating-The-Database-And-Improving-The-Website-Spider" />
    <title>Monday Morning Updating The Database And Improving The Website Spider</title>
    <published>2022-02-28T00:00:00+00:00</published>
    <updated>2022-02-28T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Over the weekend, I like to explore new ideas and find potential solutions to improve 
londinium.com, discover new applications and find new code bases. One area I was looking at is the ability to get scores for websites. Many people have heard of Google......</summary>
    <content type="html"><![CDATA[
        <p>Over the weekend, I like to explore new ideas and find potential solutions to improve 
<a href="http://www.londinium.com" target="_blank">londinium.com</a>, discover new applications and find new code bases. One area I was looking at is the ability to get scores for websites. Many people have heard of Google PageRank and Alexa site ratings, but I want a get scores for a website on a variety of factors and use these to display a scorecard for each website url.</p>

<p>But now it is Monday morning and I like to start the week by updating the data by downloading a new data file from <a href="https://overpass-api.de/api/interpreter" target="_blank">https://overpass-api.de/api/interpreter</a></p>

<p>I import this into the database and then run a website spider over the links to find more data for each entry and see what has changed.</p>

<p>This is the overpass api query i run each week which covers a large area around London:</p>

<pre><code>data=[out:json];nwr[~"^(brand|website|twitter|facebook|contact:website|contact:twitter|contact:facebook)$"~"."]  
(51.11386850819646,-1.197509765625,51.92394344554469,0.85418701171875);out center;
</code></pre>

<p>There is a huge fall in the number of entries from last week, approx 55,000 this week, compared to 62,000 last week. I wonder what is causing this difference? I will investigate in a future blog post.</p>

<p>One error I was having with the spider is when a field it too long for the database field. For example, a <code>title</code> tag is longer than the 255 varchar field the database allows. One of the nice things in Laravel, is the ability to use <a href="https://laravel.com/docs/9.x/helpers" target="_blank">helpers</a> where the <a href="https://laravel.com/docs/9.x/helpers#method-str-limit" target="_blank">Str::limit</a> helper allows me to truncate the string to the correct length, thus preventing the error.</p>

<p>Another feature of the spider is to determine the HTTP response codes for the website. Here is a table of the most common results and their meanings.</p>

<table>
<thead>
<tr>
  <th>HTTP Code</th>
  <th>Count</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>200</td>
  <td>30592</td>
  <td>OK</td>
</tr>
<tr>
  <td>404</td>
  <td>2167</td>
  <td>Not Found</td>
</tr>
<tr>
  <td>403</td>
  <td>739</td>
  <td>Forbidden</td>
</tr>
<tr>
  <td>500</td>
  <td>76</td>
  <td>Internal Server Error</td>
</tr>
<tr>
  <td>503</td>
  <td>75</td>
  <td>Service Unavailable</td>
</tr>
<tr>
  <td>409</td>
  <td>22</td>
  <td>Conflict</td>
</tr>
<tr>
  <td>400</td>
  <td>20</td>
  <td>Bad Request</td>
</tr>
<tr>
  <td>410</td>
  <td>14</td>
  <td>Gone</td>
</tr>
</tbody>
</table>

<p>And also a handful of the following HTTP codes: 429, 502, 401, 402, 530, 423, 415, 406, 521, 301, 300, 526, 426. These however are only a handful each.</p>

<p>Other errors which I am investigating occur when Guzzle returns</p>

<ul>
<li>request exception</li>
<li>connection exception</li>
<li>Undefined variable $response {"exception":"[object] (ErrorException(code: 0): Undefined variable $response ...</li>
</ul>

<p>More information about these errors at the <a href="https://docs.guzzlephp.org/en/stable/quickstart.html#exceptions" target="_blank">Guzzle Docs</a>}</p>

<p>Once this process is finished, the website will be updated with the new database tables and I also plan to update the site with a few more features based on this new spider table.</p>

<p>Enjoy..</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-19-Ordering-websites-by-distance-from-Charing-Cross</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-19-Ordering-websites-by-distance-from-Charing-Cross" />
    <title>Ordering websites by distance from Charing Cross</title>
    <published>2022-02-19T00:00:00+00:00</published>
    <updated>2022-02-19T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Calculating the distance from a latitude and londitude cordinate to a point in PHP....</summary>
    <content type="html"><![CDATA[
        <p>Today I decided to tackle the issue of ordering the website listings by distance from Central London. The traditional centre of London is Charing Cross, which is at a latitude of 51.509 and a longitude of -0.122, this is my centre point.</p>

<p>So i did a little search online and found this <code>PHP</code> function that calculates the distance from this point, for each entry in the database.</p>

<pre><code class="language-php">function distance($lat1, $lon1, $lat2, $lon2, $unit)
{
    $theta = $lon1 - $lon2;
    $dist = sin(deg2rad($lat1)) * sin(deg2rad($lat2)) +  cos(deg2rad($lat1)) * cos(deg2rad($lat2)) * cos(deg2rad($theta));
    $dist = acos($dist);
    $dist = rad2deg($dist);
    $miles = $dist * 60 * 1.1515;
    $unit = strtoupper($unit);

    if ($unit == "K") {
        return ($miles * 1.609344);
    } elseif ($unit == "N") {
        return ($miles * 0.8684);
    } else {
        return $miles;
    }
}
</code></pre>

<p>To get the distance from Charing Cross, it is simply a call to</p>

<pre><code class="language-php">  $distanceFrom = distance(51.509, -0.122, $lat, $lon, 'M');
</code></pre>

<p>To store it in the database I added a 'float' field into the mysql table like so:</p>

<pre><code class="language-sql">  `distance` float NOT NULL,
</code></pre>

<p>And updaed the Laravel Controller to order the result by this field</p>

<pre><code class="language-sql">  ORDER BY distance ASC 
</code></pre>

<p>And hey presto, the lists of websites are now sorted by distance from Charing Cross!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-18-Londinium-set-location-javascript</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-18-Londinium-set-location-javascript" />
    <title>Londinium.com set location javascript</title>
    <published>2022-02-18T10:00:00+00:00</published>
    <updated>2022-02-18T10:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">How I added the ability for the user to set their location using 2 cookies for the features and brands maps....</summary>
    <content type="html"><![CDATA[
        <p>My londinium.com website has 2 types of maps, fixed locations like postcodes, train stations and places, but also features and brands which are more relevant to the users location.</p>

<p>Today I tackled the issue of setting the user location with a cookie so that the features and brand maps are more relevant to the users location.</p>

<p>This was a project for javascripting.</p>

<p>I created a new page <a href="https://londinium.com/setLocation" target="_blank">setLocation</a> with the following function to set the cookie at the point of click.</p>

<pre><code>function onMapClick(e) {
    //map click event object (e) has latlng property which is a location at which the click occured.
    popup
        .setLatLng(e.latlng)
        .setContent("&lt;h2&gt;LOCATION COOKIE SET&lt;/h2&gt; &lt;strong&gt;Lat " + e.latlng.lat + "&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;Long " +
            e.latlng.lng +
            "&lt;/strong&gt;")
        .openOn(mymap);
    lat = "lat=" + e.latlng.lat + '; path = /; sameSite=Lax;';
    long = "long=" + e.latlng.lng + '; path = /; sameSite=Lax;';
    document.cookie = lat;
    document.cookie = long;
}
</code></pre>

<p>And some new functionality to use the new cookie variables if set on the features and brand pages.</p>

<pre><code>    function getCookie(name) {
        // Split cookie string and get all individual name=value pairs in an array
        var cookieArr = document.cookie.split(";");

        // Loop through the array elements
        for (var i = 0; i &lt; cookieArr.length; i++) {
            var cookiePair = cookieArr[i].split("=");

            /* Removing whitespace at the beginning of the cookie name
            and compare it with the given string */
            if (name == cookiePair[0].trim()) {
                // Decode the cookie value and return
                return decodeURIComponent(cookiePair[1]);
            }
        }
        // Return null if not found
        return null;
    }
window.onload = function () {
    var Lat = 51.5
    var cookieLat = getCookie("lat");
    if (cookieLat != null) {
        Lat = getCookie("lat");
    }
    var Long = -0.144
    var cookieLong = getCookie("long");
    if (cookieLong != null) {
        Long = getCookie("long");
    }

    map = L.map('map').setView([Lat, Long], 14);
</code></pre>

<p>I am sure it could be improved, but it works and allows both a default and user set value.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-18-SEO-google-sitemap-xml-from-laravel</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-18-SEO-google-sitemap-xml-from-laravel" />
    <title>SEO Google sitemap.xml for a Laravel website</title>
    <published>2022-02-18T09:00:00+00:00</published>
    <updated>2022-02-18T09:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Making sitemaps for Google with a Laravel console command and an AWK one line command line script to process the routes file....</summary>
    <content type="html"><![CDATA[
        <p>Yesterday, I added Google Adsense to <a href="http://www.londinium.com" target="_blank">londinium.com</a> which has changed quite a bit since I last used it. Part of the process ended up with me in the Google Webmaster Tools, another area I have neglected, but a useful tool for SEO (Search Engine Optimisation) purposes.</p>

<p>One of the things it suggested was to create, was a sitemap.xml file for all the links in the site. Using Laravel, there are often a number of tools to complete any job, and I soon found and setup <a href="https://github.com/spatie/laravel-sitemap" target="_blank">github.com/spatie/laravel-sitemap</a> as a command line tool. However this is a tool that is going to crawl the entire website and with over 2000 routes, is a slow way to build this sitemap.</p>

<p>Google allows both .xml and .txt files according to the docs, see <a href="https://developers.google.com/search/docs/advanced/sitemaps/build-sitemap" target="_blank">https://developers.google.com/search/docs/advanced/sitemaps/build-sitemap</a></p>

<p>So I changed tack and went back to using AWK. With this one script, I can extract all the routes and prefix them with the domain name and make the first one of these from the routes/web,php file with awk</p>

<pre><code>awk -F"'" '$1 ~ /^Route::/ {print"http://londinium.com"$2}' routes/web.php &gt; sitemap.txt
</code></pre>

<p>The second part is to create a list of the pages from the database. I have a table 'points' where I import OSM data which has a website. so I created an artisan console command which outputs these pages with the command <code>php artisan sitemap:generate &gt; sitemapNWR.txt</code>. It limits the select to 50000 as that is a limit imposed by Google. The commented out command will offset that query by 50,000.</p>

<pre><code>&lt;?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use App\Models\Points;

class GenerateSitemap extends Command
{
    /**
     * The console command name.
     *
     * @var string
     */
    protected $signature = 'sitemap:generate';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Make a sitemap of all the db pages from the points table.';

    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {
        $points = Points::limit(50000)-&gt;get();
        //$points = Points::skip(50000)-&gt;take(50000)-&gt;get();

        $points-&gt;each(function ($point) {
            echo "http://londinium.com/". $point-&gt;nwr. "/" .  $point-&gt;id;
            echo PHP_EOL;
        });
    }
}

</code></pre>

<p>It is now 2 simple commands, which i can upload to Google Webmaster Search Console.</p>

<p>Another job done!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-17-Overpass-API-Queries</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-17-Overpass-API-Queries" />
    <title>Overpass API Queries</title>
    <published>2022-02-17T00:00:00+00:00</published>
    <updated>2022-02-17T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having been work with Overpass API and developing londinium.com I have spent a great deal of time learning Overpass_QL

I wanted to put together a blog post with all the Overpass Queries I have been using in on place.

You can test these out using......</summary>
    <content type="html"><![CDATA[
        <p>Having been work with <a href="https://wiki.openstreetmap.org/wiki/Overpass_API" target="_blank">Overpass API</a> and developing <a href="http://www.londinium.com" target="_blank">londinium.com</a> I have spent a great deal of time learning <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL" target="_blank">Overpass_QL</a></p>

<p>I wanted to put together a blog post with all the Overpass Queries I have been using in on place.</p>

<p>You can test these out using <a href="https://overpass-turbo.eu/" target="_blank">Overpass Turbo</a> where you can run each example. You may need to adapt the BBOX area for the search and edit them for your purpose.</p>

<p>Get a <strong>Feature</strong> eg. supermarket</p>

<pre><code>[out:json][timeout:25];
(
  nwr[shop=supermarket]({{bbox}});
);
// print results
out body;
&gt;;
out skel qt;

</code></pre>

<p>Get everything in a <strong>Place</strong></p>

<pre><code>nwr[shop]; nwr[amenity]["name"]; nwr[tourism]["name"]; nwr[sport]["name"]; nwr[building]["name"]; nwr[leisure]["name"]; nwr[public_transport]["name"];nwr[office]["name"];

</code></pre>

<p>Get a <strong>Brand</strong> eg. waitrose</p>

<pre><code>[out:json][timeout:25];
(
  nwr["shop"]["name"="Waitrose"]({{bbox}});
  nwr["shop"]["brand"="Waitrose"]({{bbox}});
  nwr["shop"]["operator"="Waitrose"]({{bbox}});
);
// print results
out body;
&gt;;
out skel qt;
</code></pre>

<p>get a single <strong>NWR</strong> Node / Way / Relation, eg Lords Cricket Ground</p>

<pre><code>[out:json];
  relation(9653407);
// print results
out body; &gt;; out skel qt;
</code></pre>

<p>London Overground outpus as a csv</p>

<pre><code>[out:csv(::type,::id,network,type,name)][timeout:25];
{{sel=["network"~"London Overground"]["type"~"route"]}}
(
  relation{{sel}};
);
out meta qt;
</code></pre>

<p>GAY=yes with website</p>

<pre><code>[bbox:{{bbox}}][out:xml][timeout:30];(
  nwr[gay=yes][!lgbtq][website];
);out meta;&gt;;out meta qt;
</code></pre>

<p>Nodes and Ways with Images</p>

<pre><code>[out:json][timeout:25];
{{geocodeArea:London}}-&gt;.searchArea;
(
  node["image"](area.searchArea);
  way["image"](area.searchArea);
);
out body;
&gt;;
out skel qt;
</code></pre>

<p>Communication towers</p>

<pre><code>node
  ["tower:type"=communication]
  ["communication:mobile_phone"=yes]
  ({{bbox}});
out;
</code></pre>

<p>A Postcode like query</p>

<pre><code>[out:json][timeout:25];
(
  node["addr:postcode"~"^HA8"];
  way["addr:postcode"~"^HA8"];
  relation["addr:postcode"~"^HA8"];
);
out body;
&gt;;
out skel qt;
</code></pre>

<p>AREA NAME</p>

<pre><code>( area[name="Harrow"][admin_level=9]; )-&gt;.searchArea;
(
  way[highway=cycleway](area.searchArea);
  way[highway=path][bicycle=designated](area.searchArea);
  way[highway][cycleway]["cycleway"!~"no|opposite"](area.searchArea);
  way[highway]["cycleway:left"!=no]["cycleway:left"](area.searchArea);
  way[highway]["cycleway:right"!=no]["cycleway:right"](area.searchArea);
);
out geom;
make stats length=sum(length()),section_lengths=set(length());
out;
</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-16-Ansible-Debian-Desktop-Update-Part-2</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-16-Ansible-Debian-Desktop-Update-Part-2" />
    <title>Ansible Debian Desktop Update Part 2</title>
    <published>2022-02-16T00:00:00+00:00</published>
    <updated>2022-02-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Updating the Ansible repo to install more apps, downgrade NodeJS, add a firewall to the config and get the machine working as a webserver using Apache, PHP and VS Code....</summary>
    <content type="html"><![CDATA[
        <p>After yesterdays fun with Node JS, i have downgraded the version of Node in the ansible settings to version 12.</p>

<p><code>ufw</code> firewall is now enabled in a new role and I added each port for <code>apache</code> I use and also allowed ssh access.</p>

<p><code>Composer</code> was complaining that i didnt have the <code>php-curl</code> module so i installed that too</p>

<p>Laravel Dusk wasnt working so I have added <code>chromium</code> and had to rerun the php artisan dusk:install to setup the chromedirver for the tests.</p>

<p>However PHP wasnt working perfectly, i needed to enable <code>a2enmod proxy_fcgi</code> for it to work with .php files.</p>

<p>VS-code didnt like the fact <code>php-codesniffer</code> wasnt installed so I added it.</p>

<p>Also added a few apps that I like to use including <code>deluge</code>, <code>krita</code> and <code>fzf</code>. <code>fzf</code> is a fuzzy find for the commandline and I added a alias for <code>lf</code> to allow me to perform a fuzzy find on the directory with the following code which i added to the end of <code>.bashrc</code></p>

<pre><code>#bashrc - add lf for fzf andy alias
 lf () { ls -lah | fzf -e -q "$@" ;}
</code></pre>

<p>The biggest problem I had was trying to get Ansible to setup <code>mysql/mariadb</code>. The root user needs to have the plugin changed to <code>mysql_native_password</code>. But I did it by hand, as I didnt get this working with ansible yet!</p>

<p>You can see the repo at <a href="https://github.com/allotmentandy/ansible-debian-install-desktop" target="_blank">github.com/allotmentandy/ansible-debian-install-desktop</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-15-Laravel-mix-node-versions-nodejs-fun</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-15-Laravel-mix-node-versions-nodejs-fun" />
    <title>Laravel Mix / Node JS versions and webpack fun</title>
    <published>2022-02-15T00:00:00+00:00</published>
    <updated>2022-02-15T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">A morning of trying to get npm run working with package version uncompatability and downgrading nodejs....</summary>
    <content type="html"><![CDATA[
        <p>Spent most of the morning struggling to get <code>npm run production</code> working on my new machine. The problem was a combination of things:</p>

<ul>
<li>Node JS version</li>
<li>Laravel Mix version</li>
<li>Tailwind CSS</li>
<li>Webpack</li>
</ul>

<p>Solutions I tried:</p>

<pre><code class="language-shell">npm install laravel-mix-purgecss@6.0.0
npm install --save-dev sass-loader@7.1.0
npm install node-sass@v4
npm install --save-dev cross-env
npm install postcss-loader@~3.0.0 --save-dev
npm install -D tailwindcss@npm:@tailwindcss/postcss7-compat @tailwindcss/postcss7-compat postcss@\^7 autoprefixer@\^9 --force
</code></pre>

<p>Downgrade Node to version 12, then deleted the entire node_modules directory and reinstalled with the original package.json file.</p>

<p>Then fixed more errors until it worked.</p>

<p>This is now my package.json file</p>

<pre><code class="language-json">{
    "private": true,
    "scripts": {
        "dev": "npm run development",
        "development": "cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",
        "watch": "npm run development -- --watch",
        "watch-poll": "npm run watch -- --watch-poll",
        "hot": "cross-env NODE_ENV=development node_modules/webpack-dev-server/bin/webpack-dev-server.js --inline --hot --disable-host-check --config=node_modules/laravel-mix/setup/webpack.config.js",
        "prod": "npm run production",
        "production": "cross-env NODE_ENV=production node_modules/webpack/bin/webpack.js --no-progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js"
    },
    "devDependencies": {
        "@tailwindcss/typography": "^0.4.0",
        "axios": "^0.19",
        "cross-env": "^7.0.3",
        "laravel-mix": "^5.0.1",
        "laravel-mix-purgecss": "^5.0.0",
        "lodash": "^4.17.13",
        "postcss-loader": "~3.0.0",
        "resolve-url-loader": "^3.1.0",
        "sass": "^1.48.0",
        "sass-loader": "^8.0.0",
        "vue-template-compiler": "^2.6.14"
    },
    "dependencies": {
        "@tailwindcss/forms": "^0.3.4",
        "autoprefixer": "^9.8.8",
        "boundingbox": "^0.1.2",
        "escape-html": "^1.0.3",
        "leaflet": "^1.7.1",
        "overpass-frontend": "^2.7.0",
        "overpass-layer": "^3.1.0",
        "postcss": "^7.0.39",
        "tailwindcss": "npm:@tailwindcss/postcss7-compat@^2.2.17",
        "yaml": "^1.9.2"
    }
}
</code></pre>

<p>Once I got this all working, my ansible script then reinstalled v.14 of Node JS :) so now updating the ansible scripts to install v.12.</p>

<p>Most of a day of experimenting with the behemoth that is the world of Node JS :)</p>

<h3>Edit 28th Feb 2022</h3>

<p>I ran into this same problem again with another site. I added webpack 4 to the dependencies</p>

<pre><code>        "webpack": "^4.00.0"
</code></pre>

<p>and did a hard reinstall of all the node modules!</p>

<pre><code>rm -rf node_modules
rm package-lock.json
npm cache clear --force
npm install
</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-14-laravel-dusk-testing</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-14-laravel-dusk-testing" />
    <title>Laravel Dusk Testing</title>
    <published>2022-02-14T00:00:00+00:00</published>
    <updated>2022-02-14T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I do like testing websites, both as I code them, after they are running, but also to extract the odd snippet of data.

Laravel has a Browser testing environment called Dusk

It uses the chrome browser to test a website as a human would use it.

It can......</summary>
    <content type="html"><![CDATA[
        <p>I do like testing websites, both as I code them, after they are running, but also to extract the odd snippet of data.</p>

<p>Laravel has a Browser testing environment called <a href="https://laravel.com/docs/7.x/dusk">Dusk</a></p>

<p>It uses the chrome browser to test a website as a human would use it.</p>

<p>It can also make screenshots at different sizes to mirror different size screens.</p>

<p>Having moved to a new machine, copied over the code base, the dusk tests were failing. To fix it i needed to run</p>

<pre><code>apt-get install chromium

php artisan dusk:install

</code></pre>

<p>I have added these to the ansible setup which I will blog about in the future.</p>

<p>Whilst writing the tests, i wanted a way to just run the single test rather than the entire suite. This calls just the one test:</p>

<pre><code>php artisan dusk tests/Browser/blog404Test.php
</code></pre>

<p>What i wanted to test for was that a page isnt found and returns a 404 error page. Dusk cant do that directly, so the dusk test looks for '404' to appear in the page. But dusk tests can also run vanilla phpunit tests which can assert the status is 404.</p>

<pre><code>        $this-&gt;browse(function (Browser $browser) {
            $browser-&gt;visit('https://allotmentandy.github.io/missingPage/')
                    -&gt;assertSee('404');

            $response = $this-&gt;get('https://allotmentandy.github.io/missingPage/')
                        -&gt;assertStatus(404);
        }
</code></pre>

<p>I also wanted to test that there was no errors in the console;</p>

<pre><code>            $consoleLog = ($browser-&gt;driver-&gt;manage()-&gt;getLog('browser'));
            $this-&gt;assertEqualsCanonicalizing($consoleLog, []);
</code></pre>

<p>This creates an Array of the console output and asserts it is a blank array. Simples!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-02-06-Using-Ansible-To-Setup-My-New-Debian-Desktop-Machine</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-02-06-Using-Ansible-To-Setup-My-New-Debian-Desktop-Machine" />
    <title>Using Ansible To Setup My New Debian Desktop Machine</title>
    <published>2022-02-06T00:00:00+00:00</published>
    <updated>2022-02-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I recently bought a new computer and wanted to use Ansible to install all the software. I have installed the base debian system and now wanted to install everything I regularly use with Ansible.

Here is the link to the repo......</summary>
    <content type="html"><![CDATA[
        <p>I recently bought a new computer and wanted to use Ansible to install all the software. I have installed the base debian system and now wanted to install everything I regularly use with Ansible.</p>

<p>Here is the link to the repo</p>

<p><a href="https://github.com/allotmentandy/ansible-debian-install-desktop" target="_blank">github.com/allotmentandy/ansible-debian-install-desktop</a></p>

<p>Inspired by the following repos on github, I wanted to install as much as possible with Ansible, including settings for software, the XFCE panels and copy over the files I want as a backup.</p>

<p><a href="https://github.com/liquuid/ansible-desktop-debian" target="_blank">https://github.com/liquuid/ansible-desktop-debian</a></p>

<p><a href="https://github.com/geerlingguy/mac-dev-playbook" target="_blank">https://github.com/geerlingguy/mac-dev-playbook</a></p>

<p><a href="https://github.com/alecigne/ansible-desktop" target="_blank">https://github.com/alecigne/ansible-desktop</a></p>

<p>I have used installed a lot of software but the core apps I wanted is as follows:</p>

<ul>
<li>Sublime Text</li>
<li>Sublime Merge</li>
<li>Google Chrome</li>
<li>VS Code</li>
<li>Brave Browser</li>
<li>php7.4</li>
<li>php8.0</li>
<li>Apache2</li>
<li>MySQL / MariaDB Ver 15.1 Distrib 10.5.12-MariaDB,</li>
<li>Virtual Box</li>
<li>Terraform</li>
<li>Ansible</li>
<li>Docker</li>
<li>nodejs version 14.9</li>
<li>npm</li>
<li>Terminology</li>
<li>Firefox</li>
<li>Thunderbird</li>
</ul>

<p>a number of extra repositories for software was required and features in the roles within the repository.</p>

<p>To run the ansible playbook run this command and enter the ssh password and the root password like so:</p>

<pre><code>ansible-playbook -i hosts workstation.yml --ask-become-pass --ask-pass 

SSH password:
BECOME password[defaults to SSH password]:
</code></pre>

<p>One of the issues was that I tend to use su instead of the default sudo, and this requires <code>become_method: su</code> which is set in the <code>ansible_cfg</code> file</p>

<p>I will extend this as I need to, and update the blog and the repo. Hope it is of some help. If you have any feedback, issues or suggestions, please contact me.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-29-Adding-Pages-For-Each-Node-Way-Relation-To-Londinium</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-29-Adding-Pages-For-Each-Node-Way-Relation-To-Londinium" />
    <title>Adding Pages For Each Node Way Relation To Londinium</title>
    <published>2022-01-29T00:00:00+00:00</published>
    <updated>2022-01-29T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">how I added a details page for each node, way or relation on Londinium.com...</summary>
    <content type="html"><![CDATA[
        <p>Today I took on the challenge of adding pages that display all the details stored about an object in the Open Street Map system. These come as Nodes, Ways and Relations which has data associated with it available via the Overpass API.</p>

<p>Using the <a href="https://github.com/plepe/overpass-frontend" target="_blank">https://github.com/plepe/overpass-frontend</a> I used the by ID function to display the a single Node, Way or Relation using the format n123, w123 and r123 respectively to make the overpass api query.</p>

<p>This is the code in the github readme:</p>

<pre><code>const OverpassFrontend = require('overpass-frontend')

// you may specify an OSM file as url, e.g. 'test/data.osm.bz2'
const overpassFrontend = new OverpassFrontend('//overpass-api.de/api/interpreter')

// request restaurants in the specified bounding box
overpassFrontend.get(
  ['n27365030', 'w5013364'],
  {
    properties: OverpassFrontend.TAGS
  },
  function (err, result) {
    if (result) {
      console.log('* ' + result.tags.name + ' (' + result.id + ')')
    } else {
      console.log('* empty result')
    }
  },
  function (err) {
    if (err) { console.log(err) }
  }
)
</code></pre>

<p>Here is an example of one of each of the 3 types:</p>

<ul>
<li><a href="http://www.londinium.com/node/6371429623" target="_blank">/node/6371429623</a></li>
<li><a href="http://www.londinium.com/way/175968074" target="_blank">/way/175968074</a></li>
<li><a href="http://www.londinium.com/relation/9653407" target="_blank">/relation/9653407</a></li>
</ul>

<p>Each page displays a smaller map with a list of the data stored, which is returned from the overpass API call.</p>

<p>It took me a bit of fiddling to get the data to display but it works!</p>

<p>One thing I also managed to solve was the ability to add a <code>loading data...</code> block to the header which i have implemented on every map page to show the user that the data is loading. It isnt as quick I would like, but at least it provides the user with feedback.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-27-Adding-Brand-Maps-To-Londinium</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-27-Adding-Brand-Maps-To-Londinium" />
    <title>Adding Brand Maps To Londinium</title>
    <published>2022-01-27T00:00:00+00:00</published>
    <updated>2022-01-27T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Adding maps of Brands to Londinium.com...</summary>
    <content type="html"><![CDATA[
        <p>Today I have added the first Brand pages to <a href="http://www.londinium.com" target="_blank">londinium.com</a></p>

<p>These are pages that have 9 entries or more of the following tags</p>

<ul>
<li>Brand</li>
<li>Name</li>
<li>Operator</li>
</ul>

<p>One issue i ran into straight away was brands with apostrophes in them. Eg Nando's, Mcdonald's, Sainsbury's, Papa John's and more.</p>

<p>Using this guide to Overpass API regex, <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#Key.2Fvalue_matches_regular_expression_.28.7E.22key_regex.22.7E.22value_regex.22.29" target="_blank">https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL</a></p>

<p>My solution for now is to only match the start of the term, so I use Sainsbury, Nando etc. with the following regex overpass api query:</p>

<pre><code class="language-php">(nwr["name"~"^{{$brand}}"];  nwr["brand"~"^{{$brand}}"];  nwr["operator"~"^{{$brand}}"]; );
</code></pre>

<p>This method also allows the query to match <code>Tesco</code>, <code>Tesco Metro</code>, <code>Tesco Express</code> all from the <code>Tesco</code> query.</p>

<p>To investigate all the brands, names and operators, i once again created a database import script to create a mysql table for brands and extracted the fields from the osm json.</p>

<p>To find the most common brands I used this sql query:</p>

<pre><code class="language-sql">SELECT LOWER(brand) , brand, COUNT(brand) as cnt  
FROM brands
GROUP BY brand
HAVING cnt &gt; 9
</code></pre>

<p>This provided the following with at least 10 entries for my London area</p>

<pre><code>Asda    210
Domino's    184
Boots   144
Lloyds Bank 138
Tesco Express   95
Wetherspoon 90
Pret A Manger   65
Premier Inn 54
Costa   53
Sainsbury's Local   50
Harvester   49
Sainsbury's 47
Starbucks   46
Hamptons International  43
Co-op Food  42
HSBC UK 42
Primark 41
Subway  39
Argos   38
McDonald's  36
Caffè Nero  34
Nando's 33
PizzaExpress    31
Bupa    29
Waitrose    28
Tesco   27
Holland &amp; Barrett   25
Morrisons   24
Bairstow Eves   24
M&amp;S Simply Food 22
Tesco Extra 22
Toby Carvery    22
Mail Boxes Etc. 22
Iceland 21
Marks &amp; Spencer 21
KFC 20
Post Office 19
Esso    19
Boots Opticians 19
WHSmith 18
Toni &amp; Guy  18
Nationwide  18
CTD Tiles   17
CeX 17
Better  17
Oxfam   17
Peacocks    17
Specsavers  17
Travelodge  17
Greggs  16
itsu    16
NatWest 16
Cotswold Outdoor    16
Zizzi   16
Papa John's 15
ALDI    15
Cancer Research UK  15
Screwfix    15
Hall &amp; Woodhouse    15
Pizza Hut   15
Hilton  14
Wagamama    14
Spar    14
Superdrug   14
PureGym 14
Pets at Home    14
Furniture Village   14
Honest Burgers  14
Snappy Snaps    13
Five Guys   13
Krispy Kreme    13
Lidl    12
Ryman   12
Decathlon   12
3 Store 12
Nisa Local  12
Joe &amp; The Juice 12
Waterstones 12
Côte Brasserie  12
Burger King 11
Office  11
Santander   11
Little Waitrose 11
Wickes  11
Kwik Fit    11
John Lewis  11
EE  11
Paul    11
Prezzo  10
TK Maxx 10
Bill's  10
Lush    10
Coral   10
Shell   10
The Gym 10
Sports Direct   10
Wilko   10
New Look    10
Game    10
Costco  10
William Hill    10
Knight Frank    10
Next    10
Farmfoods   10
Halifax 10
</code></pre>

<p>These are all linked from the frontpage on <a href="http://www.londinium.com" target="_blank">londinium.com</a></p>

<p>Many of these chains dont have the fields for every branch, which can be fixed by adding the correct brand in the OpenStreetMap system. I can do this for you. get in touch if you would like help improving the data stored in this open source map system.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-23-Laravel-Dusk-Testing-A-Responsive-Website</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-23-Laravel-Dusk-Testing-A-Responsive-Website" />
    <title>Laravel Dusk Testing A Responsive Website</title>
    <published>2022-01-23T00:00:00+00:00</published>
    <updated>2022-01-23T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">My first blog about testing londinium.com. making screenshots at each reponsive size....</summary>
    <content type="html"><![CDATA[
        <p>I wanted to setup Laravel Dusk testing to enable me to make screenshots of a website at all different screensizes. To install laravel in an existing repo run:</p>

<pre><code>php artisan dusk:install
</code></pre>

<p>to run the 1st test</p>

<pre><code>php artisan dusk
</code></pre>

<p>First I am going to create a test for the frontpage to load and then resize to the 4 main sizes which tailwind css uses <a href="https://tailwindcss.com/docs/responsive-design" target="_blank">tailwindcss.com/docs/responsive-design</a></p>

<p>This is the comprenhsive manual for laravel dusk <a href="https://laravel.com/docs/8.x/dusk" target="_blank">laravel.com/docs/8.x/dusk</a></p>

<pre><code>$browser-&gt;visit('http://www.londinium.com/')
-&gt;waitForText('Londinium');
-&gt;assertSee('Londinium'); 

$browser-&gt;resize(1920, 1080);
$browser-&gt;screenshot('home-1920');

$browser-&gt;resize(1280, 720);
$browser-&gt;screenshot('home-1280');

$browser-&gt;resize(768, 720);
$browser-&gt;screenshot('home-768');

$browser-&gt;resize(320, 720);
$browser-&gt;screenshot('home-320');

</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-21-Updating-Londinium-Adding-Nearest-Websites</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-21-Updating-Londinium-Adding-Nearest-Websites" />
    <title>Updating Londinium Adding Nearest Websites</title>
    <published>2022-01-21T00:00:00+00:00</published>
    <updated>2022-01-21T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Updating londinium.com, adding nearest websites information, a faster API mirror, compressed javascript and more postcodes on the frontpage map....</summary>
    <content type="html"><![CDATA[
        <p>BLOG - Updating-Londinium-Adding-Nearest-Websites</p>

<p>I am just about to upload the latest version of my <a href="http://www.londinium.com" target="_blank">londinium.com</a> website</p>

<ol>
<li><p>Adding more postcodes to the frontpage map to fill the screen</p></li>
<li><p>Adding a list of nearest websites to the places pages using a database extracted from the Overpass API.</p></li>
<li><p>Combining all the javascript using webpack and compressing it. Also updating it to the latest versions.</p></li>
<li><p>Improving the map popup css using a larger font.</p></li>
<li><p>Tweeking the favicon.ico</p></li>
<li><p>Minor CSS improvements adding alternate odd even rows to the table of nearest links.</p></li>
<li><p>Using a mirror for the Overpass API data and adding a CORS header to allow it.</p></li>
<li><p>Fixing a few duplicate routes</p></li>
</ol>

<p>Note: i used git log to see which files had changed in the last week:</p>

<pre><code>git log --pretty=format: --name-only --since="7 days ago"
</code></pre>

<p>And I deployed on a friday!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-20-Automating-The-Terminal-Create-Tabs-And-Name-Them</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-20-Automating-The-Terminal-Create-Tabs-And-Name-Them" />
    <title>Automating The Terminal Create Tabs And Name Them</title>
    <published>2022-01-20T00:00:00+00:00</published>
    <updated>2022-01-20T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Scripting the terminal to open 5 tabs with titles, change to the correct directory and make the root one red....</summary>
    <content type="html"><![CDATA[
        <p>I like to have a load of Terminal tabs open in different directories, but creating them by hand with Ctrl-T gives them the boring 'Bash' Title. I use <a href="https://github.com/borisfaure/terminology" target="_blank">Terminology</a>  Lets see if we can automate it that and create terminal tabs with names and set the location.</p>

<p>I want 5 tabs with the following</p>

<ul>
<li>Blog Root</li>
<li>Website Root</li>
<li>Website Testing Root</li>
<li>Desktop</li>
<li>ROOT User</li>
</ul>

<script src="https://gist.github.com/allotmentandy/fbb0cae7f50e7800caec87765ca7df9a.js"></script>

<p>I am using xdotool and have to press <code>enter</code> at the end of each type command. I also place a space before each command so it doesnt get stored in the command history.</p>

<p>The root one on the end, doesnt login as root, rather leaves the command ready to be run.</p>

<p>I like to have the terminal with tab titles, it is a pain to do it by hand. Also embedding the gist from github which is a better place to keep the shell scripts.</p>

<p>Hope you enjoy it.</p>

<p>Andy</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-19-Javascript-Map-Improvements-and-Ideas</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-19-Javascript-Map-Improvements-and-Ideas" />
    <title>Javascript Map Improvements and Ideas</title>
    <published>2022-01-19T10:18:00+00:00</published>
    <updated>2022-01-19T10:18:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have lots of ideas and improvements I would like to make to the londinium.com website. Here I am going to document a few with brief outlines and potential solutions




see previous blog




I am about to upload a new feature for the area pages, where......</summary>
    <content type="html"><![CDATA[
        <p>I have lots of ideas and improvements I would like to make to the <a href="http://www.londinium.com" target="_blank">londinium.com</a> website. Here I am going to document a few with brief outlines and potential solutions</p>

<h3>1. Loading data from api - info box - show progress/errors</h3>

<ul>
<li>see <a href="https://allotmentandy.github.io/blog/2022-01-19-Using-Overpass-API-Mirrors-CORS-Errors" target="_blank">previous blog</a></li>
</ul>

<h3>2. Show a list of the data below the map</h3>

<p>I am about to upload a new feature for the area pages, where the page shows a table of results with websites nearest the centre point of the map. Perhaps this could be created dynamically from the live overpass data.</p>

<ul>
<li>like in this sidebar - <a href="http://xover.mud.at/~skunk/overpass-layer/?pt" target="_blank">http://xover.mud.at/~skunk/overpass-layer/?pt</a></li>
</ul>

<h3>3. Different colours for different features on the map</h3>

<p>This map uses OpenLayers, but displays the different sort of features with different colours.</p>

<ul>
<li><a href="https://codesandbox.io/s/vector-osm-forked-r84m9?file=/main.js" target="_blank">https://codesandbox.io/s/vector-osm-forked-r84m9?file=/main.js</a></li>
</ul>

<h3>4. Location - set a location page and use this with cookies.</h3>

<p>Create a page to set the location. Here are a few links to examples of geolocation using html5</p>

<p><a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation" target="_blank">https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation</a></p>

<p><a href="https://www.tutorialspoint.com/How-to-use-HTML5-Geolocation-Latitude-Longitude-API" target="_blank">https://www.tutorialspoint.com/How-to-use-HTML5-Geolocation-Latitude-Longitude-API</a></p>

<h3>5. Map to show all of a brand name, eg, waitrose, lidl</h3>

<p>This is the Overpass API Query to get all Waitroses in the BBOX area.</p>

<pre><code>[out:json][timeout:25];
(
  // query part for: “shop=* and name=Waitrose
  nwr["shop"]["name"="Waitrose"]({{bbox}});
  // query part for: “shop=* and brand=Waitrose
  nwr["shop"]["brand"="Waitrose"]({{bbox}});
  // query part for: “shop=* and operator=Waitrose
  nwr["shop"]["operator"="Waitrose"]({{bbox}});
);
// print results
out body;
&gt;;
out skel qt;

</code></pre>

<h3>6. Testing the json from the API is loading using Laravel Dusk.</h3>

<ul>
<li>Improving the tests to see if the api is working</li>
</ul>

<h3>7. Adding a Search facility for the maps to find features and places.</h3>

<ul>
<li>use Google Adsense</li>
<li>use a search like this blog using a json file.</li>
</ul>

<h3>8. Improving the map popup to deal with non-valid website links and adding more data fields.</h3>

<p>This is just a vague idea, but at present, a url field will be linked, but there is a large number of urls without the http/https element, which makes it an internal link.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-19-Using-Overpass-API-Mirrors-CORS-Errors</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-19-Using-Overpass-API-Mirrors-CORS-Errors" />
    <title>Using Overpass API Mirrors, CORS Errors and adding a loading message</title>
    <published>2022-01-19T09:10:00+00:00</published>
    <updated>2022-01-19T09:10:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Investigating using different Overpass API servers, fixing the CORS error and adding a loading message......</summary>
    <content type="html"><![CDATA[
        <p>I was investigating adding a loading block to the website and posted a number of messages like this online <a href="https://forum.openstreetmap.org/viewtopic.php?id=74656" target="_blank">forum.openstreetmap.org/viewtopic.php?id=74656 </a> where i wrote:</p>

<p>I am looking for help adding a loading message as the overpass API data takes a good few seconds to load. Basically, I am looking to add a box to the map that says loading data, refering to the load of the results from the /api/interpreter which you can see in the browser dev tools.</p>

<p>eg</p>

<pre><code>Loading data ......
26kb received

OR 

Error - 426 - Server too busy - please try again
</code></pre>

<p>I am not sure if at the start of the page load, there is an idea to how much data will come in, The data seems to come in 'waves', but also errors if there is too many requests, I want to be able to display this as a layer in the map, and for it to reappear when the page is moved.</p>

<p>One of the replies pointed me to this list of mirrors of the data <a href="https://wiki.openstreetmap.org/wiki/Overpass_API#Public_Overpass_API_instances" target="_blank">https://wiki.openstreetmap.org/wiki/Overpass_API#Public_Overpass_API_instances</a></p>

<p>Trying out the api from <a href="https://kumi.systems/" target="_blank">https://kumi.systems/</a> I got a CORS error, which complains about a Cross-Origin Request, so i added this php at the start to fix that.</p>

<pre><code>&lt;?php
    header('Access-Control-Allow-Origin: https://overpass.kumi.systems/');
?&gt;
</code></pre>

<p>Have been in contact with the team at Kumi Systems and hope to find a solution to the loading issue and see if there API mirror is any faster.</p>

<p>Another reply suggested hosting your own overpass api, which is installed like so, <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Installation" target="_blank">https://wiki.openstreetmap.org/wiki/Overpass_API/Installation</a>
I may look at this solution in the future....</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2022-01-04-Importing-OSM-Overpass-API-Data-To-MYSQL</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2022-01-04-Importing-OSM-Overpass-API-Data-To-MYSQL" />
    <title>Importing OSM Overpass API Data To MYSQL</title>
    <published>2022-01-04T00:00:00+00:00</published>
    <updated>2022-01-04T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">A php script to import Overpass API data from Openstreetmap into MYSQL using JSON....</summary>
    <content type="html"><![CDATA[
        <p>I wanted to improve the area maps on <a href="http://www.londinium.com" target="_blank">londinium.com</a> by adding a list of the websites nearby to each location. I started with the query I blogged about a few posts back, so I started with just the nodes, but large objects like hospitals didnt appear in the first list. This is because they are not nodes, rather ways and relations. The problem with these non-nodes is that they didnt have a lat/long in the same way the nodes did. But I found you could use the center output mode and replace <code>out</code> with <code>out center</code> so i my query for extracting websites is now put in a query file called <code>query.osm</code> like so:</p>

<pre><code>data=[out:json];nwr[~"^(website|twitter|facebook|contact:website|contact:twitter|contact:facebook)$"~"."]  (51.11386850819646,-1.197509765625,51.92394344554469,0.85418701171875);out center;
</code></pre>

<p>Note that the export area is encoded in the query, and the output format is json.</p>

<p>To download the osm data with this command using the 'query.osm' file above run:</p>

<pre><code>wget -O osm.json --post-file=query.osm "https://overpass-api.de/api/interpreter"
</code></pre>

<p>To parse the <code>osm.json</code> file to extract data and create an insert sql file, I amended my parseXml.php file like so</p>

<p>I am now donwloading json, so i needed to change the parse file a lot. It is much cleaner and easier with json to extract the data</p>

<pre><code class="language-php">&lt;?php

error_reporting(E_ALL ^ E_WARNING); // disable warnings as this is an sql import

$json = file_get_contents('osm.json');
$phpDataArray = json_decode($json, false ); 

foreach($phpDataArray as $value){

    foreach($value as $row){

        if ($row-&gt;tags-&gt;website){    $website = $row-&gt;tags-&gt;website;}
        else    $website = $row-&gt;tags-&gt;{'contact:website'};

        // if the website is not valid or blank - continue, ignoring this row
        if (filter_var($website, FILTER_VALIDATE_URL) === false) {
            continue;
        }

        if ($row-&gt;id){
            $nwr = $row-&gt;type; // Node, Way, Relation

            if ($row-&gt;lat){
                $lat = $row-&gt;lat;
            }
            else
                $lat = $row-&gt;center-&gt;lat;

            if ($row-&gt;lon){
                $lon = $row-&gt;lon;
            }
            else
                $lon = $row-&gt;center-&gt;lon;


            $address = $row-&gt;tags-&gt;{'addr:housenumber'} . " " . $row-&gt;tags-&gt;{'addr:housename'} . " " .
            $row-&gt;tags-&gt;{'addr:unit'} . " " . $row-&gt;tags-&gt;{'addr:street'} . " " .
            $row-&gt;tags-&gt;{'addr:place'} . " " . $row-&gt;tags-&gt;{'addr:city'} . " " .
            $row-&gt;tags-&gt;{'addr:postcode'};            

            $feature = "";

            if($row-&gt;tags-&gt;railway){ $feature = $row-&gt;tags-&gt;railway;}
            if($row-&gt;tags-&gt;public_transport){ $feature = $row-&gt;tags-&gt;public_transport;}
            if($row-&gt;tags-&gt;highway){ $feature = $row-&gt;tags-&gt;historic;}
            if($row-&gt;tags-&gt;building &amp;&amp; ($row-&gt;tags-&gt;building != "yes") ){ $feature = $row-&gt;tags-&gt;building;}
            if($row-&gt;tags-&gt;natural){ $feature = $row-&gt;tags-&gt;natural;}
            if($row-&gt;tags-&gt;sport){ $feature = $row-&gt;tags-&gt;sport;}
            if($row-&gt;tags-&gt;leisure){ $feature = $row-&gt;tags-&gt;leisure;}
            if($row-&gt;tags-&gt;landuse){ $feature = $row-&gt;tags-&gt;landuse;}
            if($row-&gt;tags-&gt;craft){ $feature = $row-&gt;tags-&gt;craft;}
            if($row-&gt;tags-&gt;office){ $feature = $row-&gt;tags-&gt;office;}
            if($row-&gt;tags-&gt;tourism){ $feature = $row-&gt;tags-&gt;tourism;}
            if($row-&gt;tags-&gt;shop){ $feature = $row-&gt;tags-&gt;shop;}
            if($row-&gt;tags-&gt;amenity){ $feature = $row-&gt;tags-&gt;amenity;}

            $amenity = "";
            if($row-&gt;tags-&gt;amenity){ $amenity = $row-&gt;tags-&gt;amenity;}

            $building = "";            
            if($row-&gt;tags-&gt;building &amp;&amp; ($row-&gt;tags-&gt;building != "yes") ){ $building = $row-&gt;tags-&gt;building;}

            $tourism = "";            
            if($row-&gt;tags-&gt;tourism){ $tourism = $row-&gt;tags-&gt;tourism;}

            $craft = "";
            if($row-&gt;tags-&gt;craft){ $craft = $row-&gt;tags-&gt;craft;}

            //social

            if ($row-&gt;tags-&gt;twitter){    $twitter = $row-&gt;tags-&gt;twitter;}
            else    $twitter = $row-&gt;tags-&gt;{'contact:twitter'};

            if ($row-&gt;tags-&gt;facebook){    $facebook = $row-&gt;tags-&gt;facebook;}
            else    $facebook = $row-&gt;tags-&gt;{'contact:facebook'};

            if ($row-&gt;tags-&gt;instagram){    $instagram = $row-&gt;tags-&gt;instagram;}
            else    $instagram = $row-&gt;tags-&gt;{'contact:instagram'};

            if ($row-&gt;tags-&gt;linkedin){    $linkedin = $row-&gt;tags-&gt;linkedin;}
            else    $linkedin = $row-&gt;tags-&gt;{'contact:linkedin'};

            // make the sql using INSERT IGNORE to prevent errors
            echo "INSERT IGNORE INTO `points` (`id`, `website`, `address`, `feature` ,`amenity` ,`building` ,
            `tourism` ,`craft` , `twitter`,  `facebook`,  `linkedin`, `instagram`,  `name`, `nwr`, `point`) ";
            echo "VALUES(" . $row-&gt;id .", '" . addslashes($website) . "', '". addslashes(trim($address)) . "', '".
             addslashes($feature) . "', '" .addslashes($amenity) . "', '" .addslashes($building) . "', '" .
             addslashes($tourism) . "', '" .addslashes($craft) . "', '" . $twitter . "', '". $facebook 
             . "', '". $linkedin . "', '". $instagram . "', '" . addslashes($row-&gt;tags-&gt;name). "', '".
              $nwr . "', POINT(" . $lat . " , " . $lon ." ));"; 

            echo PHP_EOL;
        }
    }
}


</code></pre>

<p>To create the sql file, I ran it like this</p>

<pre><code>parseJson.php &gt; points.sql
</code></pre>

<p>I had to extract the <code>nwr</code> (Node/Way/Relation) to be able to link to the live db database on openstreetmap. I also renamed the field <code>type</code> as <code>feature</code> so the new database table is like so:</p>

<pre><code class="language-mysql">CREATE TABLE `points` (
  `id` varchar(11) NOT NULL,
  `nwr` varchar(255) NOT NULL,
  `feature` varchar(255) NOT NULL,
  `amenity` varchar(255) NOT NULL,
  `building` varchar(255) NOT NULL,
  `tourism` varchar(255) NOT NULL,
  `craft` varchar(255) NOT NULL,
  `name` varchar(255) NOT NULL,
  `address` varchar(255) NOT NULL,
  `website` varchar(255) NOT NULL,
  `twitter` varchar(255) NOT NULL,
  `facebook` varchar(255) NOT NULL,
  `linkedin` varchar(255) NOT NULL,
  `instagram` varchar(255) NOT NULL,
  `point` point NOT NULL,

  PRIMARY KEY (`id`),
  SPATIAL KEY `point` (`point`)
) ENGINE=InnoDB;
</code></pre>

<p>import into db using pipe viewer to see progress</p>

<pre><code>pv points.sql | mysql -u root -p  londinium
</code></pre>

<p>And hey presto, a table full of data with each entity having geographic data.</p>

<p>There is still a number of 'dodgy' entries, which i plan to clean up at the next stage of this this import.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-27-Planning-to-do-the-Hashicorp-Terraform-Associate-Certification</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-27-Planning-to-do-the-Hashicorp-Terraform-Associate-Certification" />
    <title>Planning to do the Hashicorp Terraform Associate Certification</title>
    <published>2021-12-27T00:00:00+00:00</published>
    <updated>2021-12-27T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having spent the past month focusing on devops with AWS, I have decided to do the Terraform Associate Certification. It is coming to the new year, new month, so i get a new allocation of 750 hours on AWS to play with. I look forward to learning,......</summary>
    <content type="html"><![CDATA[
        <p>Having spent the past month focusing on devops with AWS, I have decided to do the Terraform Associate Certification. It is coming to the new year, new month, so i get a new allocation of 750 hours on AWS to play with. I look forward to learning, practicing and developing knowledge on the more advanced aspects of Terraform tools with a plan to take the Certification.</p>

<p>Here are a few links of use.</p>

<p><a href="https://www.hashicorp.com/" target="_blank">hashicorp.com</a></p>

<p><a href="https://www.terraform.io/docs" target="_blank">terraform.io/docs</a></p>

<p><a href="https://learn.hashicorp.com/tutorials/terraform/associate-study" target="_blank">hashicorp terraform/associate-study</a></p>

<p><a href="https://app.terraform.io/signup/account?utm_source=iopage&amp;utm_campaign=tf_cloud_ga" target="_blank">terraform cloud</a></p>

<p><a href="https://registry.terraform.io/" target="_blank">registry.terraform.io</a></p>

<p><a href="https://www.exampro.co/terraform" target="_blank">exampro.co/terraform</a></p>

<p><a href="https://github.com/shuaibiyy/awesome-terraform" target="_blank">awesome-terraform</a></p>

<p><a href="https://www.bogotobogo.com/DevOps/Terraform/Terraform_commands_cheat_sheet.php" target="_blank">bogotobogo.com Terraform_commands_cheat_sheet</a></p>

<p>Good tutorials here - one to do is upload a static site to s3 <a href="https://www.bogotobogo.com/DevOps/Terraform/Terraform-modules.php" target="_blank">bogotobogo.com</a></p>

<p>I also enjoyed this 13 hour video by Andrew Brown who goes through most of the aspects of the certification test.</p>

<iframe frameborder="0" scrolling="no" marginheight="0" marginwidth="0"width="788.54" height="443" type="text/html" src="https://www.youtube.com/embed/V4waklkBC38?autoplay=0&fs=0&iv_load_policy=3&showinfo=0&rel=0&cc_load_policy=0&start=0&end=0"></iframe>

<p>Here are some practice questions</p>

<p><a href="https://medium.com/bb-tutorials-and-thoughts/250-practice-questions-for-terraform-associate-certification-7a3ccebe6a1a" target="_blank">bb-tutorials-and-thoughts/250-practice-questions-for-terraform-associate-certification-7a3ccebe6a1a</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-24-What-am-I-trying-to-achieve</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-24-What-am-I-trying-to-achieve" />
    <title>What am I trying to achieve?</title>
    <published>2021-12-24T14:40:01+00:00</published>
    <updated>2021-12-24T14:40:01+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I was asked this question on twitter, so I wrote a blog post answering it...</summary>
    <content type="html"><![CDATA[
        <p><a href="https://twitter.com/plepe" target="_blank">plepe</a> the developer of the <a href="https://github.com/plepe/overpass-layer" target="_blank">javascript toolkit</a> I use to get the data from the overpass API asked me a couple of questions over on twitter.</p>

<p><strong>What are you trying to achieve? Do you want to tell people about your script? Are you looking for co-developers? Are you looking for ideas?</strong></p>

<p>Over 20 years ago, i register the domain name Londinium.com and spent many years building a large directory website focused on London. Around 2015, Google kicked the directories like mine from their search engine results, alongside regular Denial of Service attacks, the EU cookie directive and other factors, I decided to take the website down as it was no longer making any money.</p>

<p>Now I have relaunched londinium.com with the maps from Open Street Map and using the Overpass API, i hope to be able to provide a map based solution for people looking for local information and more.</p>

<p>One idea I have is to contribute all the data to Openstreetmap. I have developed a number of web spiders, crawlers and tools to find website information. This includes checking websites work, extracting links from websites, content from web pages and screenshots of websites.</p>

<p>I would like to make use of these tools to clean the data returned from the overpass api, (eg. fixing links to websites that are missing the http:// part) I would also like to use the tools I have written to add more links to social media like twitter, facebook and also to youtube, flickr and more. My tools also extract data from the Head of the websites like ICBM location and other Meta tag data.</p>

<p>As a PHP developer with a geography background, I mainly work with the Laravel framework. Much of the OSM technology is Javascript based, and although I have coded londinium.com so far, javascript is not my strongest skill. I would like to find other people that use similar technologies (<code>leaflet js</code>, <code>overpass api</code> ) willing to share and help each other.</p>

<p>I would also like to open source the technology once it has reached a stable state. Not only the frontend website, but the backend tools that find, check and update information held.</p>

<p>One thing I would like to add is a "Loading..." modal to say that the Overpass API data is loading on the live site. Not entirely sure how to do this.</p>

<p>Another question with regards to developers, is where do they hangout? Is the <a href="https://forum.openstreetmap.org/viewforum.php?id=13" target="_blank">forum</a> the correct place to paste the link to this post, or are the mailing lists better. Is there a chatroom or irc channel in which  openstreetmap folk dwell?</p>

<p>I may well update this blog post if people ask questions or other points occur to me.</p>

<p>Happy Christmas</p>

<p>Andy</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-24-Extracting-More-Data-From-The-Overpass-API-(Part-3)</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-24-Extracting-More-Data-From-The-Overpass-API-(Part-3)" />
    <title>Extracting More Data From The Overpass API (Part 3)</title>
    <published>2021-12-24T00:00:00+00:00</published>
    <updated>2021-12-24T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Extracting the Address details and the type of thing it actually is....</summary>
    <content type="html"><![CDATA[
        <p>I continued developing the parseXMl.php file to get 2 more sets of data. An address, which is a combination of <code>$housenumber . " " . $street . " " . $city . " " . $postcode;</code> and also a type, which is a combination of <code>sport, leisure, shop, amenity, office</code> which gives an idea of what the object is.</p>

<p>I have added fields into the database table to store these like so:</p>

<pre><code>CREATE TABLE `points` (
  `id` varchar(11) NOT NULL,
  `website` varchar(255) NOT NULL,
  `address` varchar(255) NOT NULL,
  `type` varchar(255) NOT NULL,
  `twitter` varchar(255) NOT NULL,
  `name` varchar(255) NOT NULL,
  `point` point NOT NULL,

  PRIMARY KEY (`id`),
  SPATIAL KEY `point` (`point`)
) ENGINE=InnoDB;

</code></pre>

<p>so now the parseXml.php file looks like this</p>

<h4><strong><code>parseXml.php</code></strong></h4>

<pre><code class="language-php">&lt;?php

$xmlDataString = file_get_contents('osmData.json');
$xmlObject = simplexml_load_string($xmlDataString);

$json = json_encode($xmlObject);
$phpDataArray = json_decode($json, false ); 

foreach($phpDataArray as $value){
    foreach($value as $row){
        $name = "";
        $twitter = "";
        $housenumber = "";
        $street = "";
        $city = "";
        $postcode = "";
        $type = "";

        foreach($row-&gt;{'tag'} as $attributes){
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'name'){
                $name = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'contact:twitter'){
                $twitter = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'addr:housenumber'){
                $housenumber = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'addr:street'){
                $street = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'addr:city'){
                $city = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'addr:postcode'){
                $postcode = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'sport'){
                $type = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'leisure'){
                $type = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'shop'){
                $type = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'amenity'){
                $type = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'office'){
                $type = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'website'){

                $address = $housenumber . " " . $street . " " . $city . " " . $postcode;            
                $address = trim($address);

                // make the sql using INSERT IGNORE to prevent errors
                echo "INSERT IGNORE INTO `points` (`id`, `website`, `address`, `type` , `twitter`, `name`, `point`) ";
                echo "VALUES(" . $row-&gt;{'@attributes'}-&gt;id .", '" . addslashes($attributes-&gt;{'@attributes'}-&gt;{'v'}) . "', '". addslashes($address) . "', '". addslashes($type) . "', '". $twitter . "', '" . addslashes($name) . "', POINT(" . $row-&gt;{'@attributes'}-&gt;lat . " , " . $row-&gt;{'@attributes'}-&gt;lon ." ));"; 

                echo PHP_EOL;
            }
        }
    }
}

</code></pre>

<p>running it using the same 2 commands, the first processes the xml file and outputs sql inserts, the second inserts it into the db.</p>

<pre><code>php parseXml.php &gt; points1.sql
mysql -u root -p dbtable &lt; points1.sql
</code></pre>

<p>There are a few other fields I was looking at, including <code>facebook, contact:facebook, contact:instagram, contact:linkedin, linkedin, addr:country, email, phone, contact:phone</code> but these dont actually hold much data. So I am going to focus on displaying the results on the location pages to list the nearby entries.</p>

<p>NB: The <code>type</code> field in the code above only takes the value of the last field that exists so office is more important than amenity etc... I did notice that some have multiple values separated by semi-colons (eg. spinning;fitness;yoga) I will check to see if these work in the overpass api results.</p>

<p>I am also planning to run a web spider/crawler on these results to see which pages are working (non 404 results) and also extract more of the external social media links using my <a href="https://github.com/allotmentandy/SocialMediaLinkExtractor" target="_blank">Social Media Link Extractor package</a> but that is for a future post. I would be interested in adding this data to the overpass api automatically, but not sure that is allowed.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-23-Extracting-The-Data-From-The-Overpass-API-(Part-2)</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-23-Extracting-The-Data-From-The-Overpass-API-(Part-2)" />
    <title>Extracting The Data From The Overpass API (Part 2)</title>
    <published>2021-12-23T21:17:01+00:00</published>
    <updated>2021-12-23T21:17:01+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Taking the last blog further, importing into the database and running Spatial queries....</summary>
    <content type="html"><![CDATA[
        <p>Furthermore to the last blog, I updated the php script to output sql, created a new database table, imported it into the database and started to output the data.</p>

<p>Going to use the new(ish) point datatype in mysql.</p>

<pre><code class="language-mysql">CREATE TABLE `points` (
  `id` varchar(11) NOT NULL,
  `website` varchar(255) NOT NULL,
  `twitter` varchar(255) NOT NULL,
  `name` varchar(255) NOT NULL,
  `point` point NOT NULL,

  PRIMARY KEY (`id`),
  SPATIAL KEY `point` (`point`)
) ENGINE=InnoDB;

</code></pre>

<p>I amended the php script in yesterdays post to output sql.</p>

<pre><code class="language-php">&lt;?php

$xmlDataString = file_get_contents('osmData.xml');
$xmlObject = simplexml_load_string($xmlDataString);

$json = json_encode($xmlObject);
$phpDataArray = json_decode($json, false ); 

foreach($phpDataArray as $value){
    foreach($value as $row){
        $name = "";
        $twitter = "";

        foreach($row-&gt;{'tag'} as $attributes){
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'name'){
                $name = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'contact:twitter'){
                $twitter = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'website'){

                echo "INSERT INTO `points` (`id`, `website`, `twitter`, `name`, `point`) ";
                echo "VALUES(" . $row-&gt;{'@attributes'}-&gt;id .", '" . $attributes-&gt;{'@attributes'}-&gt;{'v'} . "', '". $twitter . "', '" . addslashes($name) . "', POINT(" . $row-&gt;{'@attributes'}-&gt;lat . " , " . $row-&gt;{'@attributes'}-&gt;lon ." ));"; 

                echo PHP_EOL;
            }
        }
    }
}
</code></pre>

<p>To save the sql i ran</p>

<pre><code>php xmlParser.php &gt; points.sql
</code></pre>

<p>To import it to the database i run</p>

<pre><code>mysql -u root -p dbName &lt; points.sql
</code></pre>

<p>There was a couple of problems due to 2 urls having ' in them! Neither actually worked (404 errors) so i manually deleted them from the import table, deleted the table contents and started again. Third time lucky, i had a new db table with over 10,000 records.</p>

<p>Now i can run a query like this:</p>

<pre><code>SELECT * FROM points WHERE ST_Distance_Sphere(point, POINT(51.49591970845512, -0.26298522949218756)) &lt;= 2000 ;
</code></pre>

<p>which returns 100 websites within 2500 metres of the point (in chiswick)! This works for all the points i tried including much shorter coordinates.</p>

<pre><code>SELECT * FROM points WHERE ST_Distance_Sphere(point, POINT(51.49, -0.14)) &lt;= 2000 ;
</code></pre>

<p>Now I wanted to improve it further and show and order by  the distance from the centre point</p>

<pre><code>SELECT id, name, website,
  ST_X(point) AS longitude,
  ST_Y(point) AS latitude,
  ST_DISTANCE_SPHERE(point, POINT(51.49455119685909, -0.14415264129638675)) AS dist
FROM points 
HAVING dist &lt; 500
ORDER BY  dist;
</code></pre>

<p><img src="/assets/images/mysqlSelectDistance.png"></p>

<p>Now i am going to improve the import parser to add the addresses to make it easier to see problems.</p>

<p>Changing the <code>INSERT</code> command to <code>INSERT IGNORE</code> to ignore errors</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-23-Extracting-The-Data-From-The-Overpass-API</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-23-Extracting-The-Data-From-The-Overpass-API" />
    <title>Extracting Data From The Overpass API</title>
    <published>2021-12-23T00:00:00+00:00</published>
    <updated>2021-12-23T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I wrote a simple php script to extract data from the Overpass API xml file...</summary>
    <content type="html"><![CDATA[
        <p>I extracted an XML dump from the <a href="https://overpass-turbo.eu/" target="_blank">overpass-api</a>.</p>

<p>My plan is to import this data to a database so I wrote a php script to convert this data from XML to Json and then output the data in the terminal.</p>

<pre><code class="language-php">&lt;?php

$xmlDataString = file_get_contents('osmData.xml');
$xmlObject = simplexml_load_string($xmlDataString);

$json = json_encode($xmlObject);
$phpDataArray = json_decode($json, false ); 

$counter =0;

foreach($phpDataArray as $value){
    foreach($value as $row){
        $name = "";
        $twitter = "";

        foreach($row-&gt;{'tag'} as $attributes){
            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'name'){
                $name = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'contact:twitter'){
                $twitter = ($attributes-&gt;{'@attributes'}-&gt;{'v'});
            }

            if($attributes-&gt;{'@attributes'}-&gt;{'k'} == 'website'){
                echo  ($row-&gt;{'@attributes'}-&gt;id );
                echo " ";
                echo  ($row-&gt;{'@attributes'}-&gt;lat );
                echo " ";        
                echo  ($row-&gt;{'@attributes'}-&gt;lon );
                echo " ";
                echo ("\e[1;32;40m" . $attributes-&gt;{'@attributes'}-&gt;{'v'} ."\e[0m");
                echo " ";
                echo "\e[1;33;40m" . $name ."\e[0m";
                echo " ";
                echo "\e[0;34;40m" . $twitter ."\e[0m";

                echo PHP_EOL;
                $counter++;
            }
        }
    }
}

echo "total records with website: " . $counter . PHP_EOL;

</code></pre>

<p>Here is a sample of the output which shows entries that have a website url.</p>

<p><img src="/assets/images/sampleOSMdata.png"></p>

<p>The green values are the website values, the yellow the names and the blue ones the twitter fields. Some of the websites arnt websites, many dont have the http/https prefix. Some of the entries dont have names. The twitter links arnt in any standard format, full url, @twitterhandle or just the twitter handle.</p>

<p>I will develop this script further to extract more info from the xml and work out how and what to store in the database. Stay tuned.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-22-Improving-the-maps-on-londinium-com</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-22-Improving-the-maps-on-londinium-com" />
    <title>Improving the maps on Londinium.com</title>
    <published>2021-12-22T00:00:00+00:00</published>
    <updated>2021-12-22T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Adding mapping features to londinium.com, the original site for London using leaflet JS and Openstreetmap...</summary>
    <content type="html"><![CDATA[
        <p>I recently relaunch <a href="http://www.londinium.com" target="_blank">londinium.com</a> with a number of the mapping features I have been working on.</p>

<p>The frontpage of <a href="http://www.londinium.com" target="_blank">londinium.com</a> now has a number of different styles of maps with links to airports and main stations alongside postcodes. 
You can access these in the top right corner menu. I have added all the mapbox ones, but there are a lot more.</p>

<p>This is on top of showing the <a href="https://wiki.openstreetmap.org/wiki/Map_features" target="_blank">Openstreetmap tags / map features</a> (eg, supermarkets)</p>

<p>The features are extracted using <a href="https://overpass-turbo.eu/" target="_blank">overpass-api</a> which is an frontend for the data held in the OSM system.</p>

<p>It is built using <a href="http://www.laravel.com" target="_blank">laravel</a> which is the php framework i have used most over the past few years</p>

<p>The maps use <a href="https://leafletjs.com/" target="_blank">leaflet js</a>. You can see the range of base maps available on <a href="http://leaflet-extras.github.io/leaflet-providers/preview/index.html" target="_blank">http://leaflet-extras.github.io/leaflet-providers/preview/index.html</a></p>

<h3>Useful Leaflet JS links</h3>

<p>Here are a number of links i found useful in developing the website.</p>

<p><a href="https://github.com/tomik23/leaflet-examples" target="_blank">tomik23/leaflet-examples</a></p>

<p><a href="http://harrywood.co.uk/maps/examples/" target="_blank">Harry Wood map examples</a></p>

<p><a href="https://devdocs.io/leaflet~1.7/index#popup" target="_blank">Devdocs LeafletJS</a></p>

<p><a href="https://github.com/plepe/overpass-layer" target="_blank">github.com/plepe/overpass-layer</a></p>

<h3>Ideas and notes</h3>

<ul>
<li>The current site uses the data from overpass turbo, and can be a bit slow to load. Also it times out sometimes. Interested in hosting this locally.</li>
<li>Also would like to add a <em>loading</em> message to show the data is loading. If it fails, perhaps it could show an error message</li>
<li>There is some inconsistency with the data in the OSM system. For example, there most twitter links include the full url, whilst others are @twitter links and others are just the twitter account. Need to address this in someway.</li>
</ul>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-20-AWS-terraform-destroy-&amp;-terraform-apply-Part-8</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-20-AWS-terraform-destroy-&amp;-terraform-apply-Part-8" />
    <title>AWS terraform destroy &amp; terraform apply (Part 8)</title>
    <published>2021-12-20T00:00:00+00:00</published>
    <updated>2021-12-20T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Fixing the Terraform file to make the storage file smaller to fit in the free tier limits...</summary>
    <content type="html"><![CDATA[
        <p>This morning I got an alert from Amazon that said I was at 85% usage for storage on my free tier account. I thought this was odd, as I had been trying to stay within the free limits. Looking at the Instance console, it had a 50gb storage disk, which is higher than the 30gb allowed in the free tier. No problem.</p>

<p>A simple change of <a href="https://github.com/allotmentandy/aws/blob/dd8728f63361e9c537037eaccee32858c7770a16/Part%204%20-%20using%20terraform%20to%20create%20an%20EC2%20instance/setup.tf#L67">line 67 of the setup.tf file</a> from 50gb to 29gb and then by running 2 commands, quickly, an instance is back up with a smaller disk!</p>

<pre><code>terraform destroy

terraform apply
</code></pre>

<p>This is devops! Fast, accurate automation to solve problems and get up and running accurately.</p>

<p>On my journey learning and using the AWS Cloud, I have been looking at more of the offerings from Amazon.</p>

<ul>
<li><strong>AWS Elastic Beanstalk</strong> is an orchestration service offered from Amazon Web Services for deploying infrastructure which orchestrates various AWS services, including EC2, S3, Simple Notification Service, CloudWatch, autoscaling, and Elastic Load Balancers.</li>
<li><strong>AWS Lambda</strong> is a serverless, event-driven compute service that lets you run code for virtually any type of application or backend service without provisioning or managing servers. You can trigger Lambda from over 200 AWS services and software as a service (SaaS) applications, and only pay for what you use.</li>
</ul>

<p>Useful reading:</p>

<p><a href="https://github.com/rennokki/laravel-aws-eb">https://github.com/rennokki/laravel-aws-eb</a></p>

<p><a href="https://github.com/mslobodyanyuk/aws-laravel_academind">https://github.com/mslobodyanyuk/aws-laravel_academind</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-06-AWS-EC2-Instance-and-Container-setup-with-Ansible-(Part-7)</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-06-AWS-EC2-Instance-and-Container-setup-with-Ansible-(Part-7)" />
    <title>AWS EC2 Instance and Container setup with Ansible (Part 7)</title>
    <published>2021-12-06T00:00:00+00:00</published>
    <updated>2021-12-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I started with this tutorial https://www.agix.com.au/build-an-ec2-using-ansible-step-by-step/

The ansible code is in Part 7 of the repo github.com/allotmentandy/aws, this code creates a NEW instance on EC2.

To run the playbook:






this uses the......</summary>
    <content type="html"><![CDATA[
        <p>I started with this tutorial <a href="https://www.agix.com.au/build-an-ec2-using-ansible-step-by-step/">https://www.agix.com.au/build-an-ec2-using-ansible-step-by-step/</a></p>

<p>The ansible code is in Part 7 of the repo <a href="https://github.com/allotmentandy/aws">github.com/allotmentandy/aws</a>, this code creates a NEW instance on EC2.</p>

<p>To run the playbook:</p>

<pre><code>ansible-playbook  -i ./hosts --private-key ~/.ssh/private.pem createEC2.yml
</code></pre>

<h3>Improvements for the next version:</h3>

<ul>
<li>this uses the deprecated https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_module.html#ansible-collections-amazon-aws-ec2-module</li>
<li>check if there is an instance first</li>
<li>destroy the instance script</li>
<li>add the Elastic IP address</li>
</ul>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-05-AWS-Docker-improvements-adding-tailwindCss-and-more(Part-6)</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-05-AWS-Docker-improvements-adding-tailwindCss-and-more(Part-6)" />
    <title>AWS Docker improvements adding tailwindCss and more(Part 6)</title>
    <published>2021-12-05T00:00:00+00:00</published>
    <updated>2021-12-05T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having setup the docker image and got it working on the EC2 instance, I wanted to improve the laravel website within the Docker image.

Installing tailwind into the laraveldocker app i made in Part 5 following this tutorial......</summary>
    <content type="html"><![CDATA[
        <p>Having setup the docker image and got it working on the EC2 instance, I wanted to improve the laravel website within the Docker image.</p>

<p>Installing tailwind into the laraveldocker app i made in Part 5 following this tutorial <a href="https://tailwindcss.com/docs/guides/laravel">https://tailwindcss.com/docs/guides/laravel</a></p>

<pre><code>npm install

npm install -D tailwindcss@latest postcss@latest autoprefixer@latest

npx tailwindcss init

</code></pre>

<p>setting up the tailwind config and the webpack config to allow</p>

<pre><code>npm run dev
</code></pre>

<p>adding the css to the html in /resources/views/welcome.blade.php and hey presto tailwind css is working.</p>

<pre><code>    &lt;meta charset="UTF-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;link href="{{ asset('css/app.css') }}" rel="stylesheet"&gt;
</code></pre>

<p>I also added <a href="https://github.com/laravel/ui">https://github.com/laravel/ui</a> vue js using that link</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-03-AWS-Amazon-Web-Services-Laravel-in-Docker-on-EC2(Part-5)</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-03-AWS-Amazon-Web-Services-Laravel-in-Docker-on-EC2(Part-5)" />
    <title>AWS Amazon Web Services Laravel in Docker on EC2(Part 5)</title>
    <published>2021-12-03T00:00:00+00:00</published>
    <updated>2021-12-03T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Next in this series, I am setting up a docker container to host a laravel website on AWS.

Following this tutorial https://buddy.works/guides/laravel-in-docker

I started with a fresh install of Laravel 8 which is in Part 5 of the repo......</summary>
    <content type="html"><![CDATA[
        <p>Next in this series, I am setting up a docker container to host a laravel website on AWS.</p>

<p>Following this tutorial <a href="https://buddy.works/guides/laravel-in-docker">https://buddy.works/guides/laravel-in-docker</a></p>

<p>I started with a fresh install of Laravel 8 which is in Part 5 of the repo <a href="https://github.com/allotmentandy/aws">github.com/allotmentandy/aws</a> with this Dockerfile</p>

<pre><code>FROM php:8.0.5
RUN apt-get update -y &amp;&amp; apt-get install -y openssl zip unzip git
RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
RUN docker-php-ext-install pdo 
WORKDIR /app
COPY . /app
RUN composer install

CMD php artisan serve --host=0.0.0.0 --port=8888
EXPOSE 8888
</code></pre>

<h3>BUILD the container</h3>

<pre><code>docker build -t laravelDocker .
</code></pre>

<h3>RUN the container</h3>

<pre><code>docker run -p 8888:8888 laravelDocker
</code></pre>

<h3>STOP the container</h3>

<p>The first command shows all the containers, the second stops the container with the id</p>

<pre><code>docker container ls

docker container stop ba0ce2c7575f
</code></pre>

<p>visiting http://localhost:8888/  see the laravel frontpage</p>

<p>I am  going to set it up on an EC2 server instance, but that doesnt seem the norm with Lightsail, Lambda or ECS seemingly better fits for hosting a container image.</p>

<p>So i have the Debian Instance i setup in part 4 with Terraform, now i am going to manually login via ssh, and setup docker</p>

<pre><code>sudo apt-get update
sudo apt install -y apt-transport-https ca-certificates curl gnupg2 software-properties-common
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/debian $(lsb_release -cs) stable"
sudo apt update
sudo apt install docker-ce
</code></pre>

<p>Now i need to add my docker container to <a href="https://hub.docker.com/repository/docker/allotmentandy/laraveldocker">docker hub</a></p>

<pre><code>docker ps # to see the docker images eg. id = 5a6a73bcea26

# docker commit -m "first commit" -a "NAME" laraveldocker allotmentandy/laraveldocker:latest # didnt work :(

docker login

docker tag 5a6a73bcea26 allotmentandy/laraveldocker

docker push allotmentandy/laraveldocker
</code></pre>

<p>Et voila! <a href="https://hub.docker.com/repository/docker/allotmentandy/laraveldocker">dockerhub / allotmentandy</a></p>

<p>now i ssh into the EC2 instance</p>

<pre><code>docker pull allotmentandy/laraveldocker
sudo docker run -p 80:80 allotmentandy/laraveldocker

</code></pre>

<p>updating the laravel files / dockerfile means a rebuild:</p>

<pre><code>docker build -t allotmentandy/laraveldocker -f Dockerfile  .
docker push allotmentandy/laraveldocker

</code></pre>

<p>stopping the container, redoing the pull and running it again. Simples :)</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-02-AWS-Amazon-Web-Services-Instance-with-Terraform-and-an-Elastic-IP(Part-4)</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-02-AWS-Amazon-Web-Services-Instance-with-Terraform-and-an-Elastic-IP(Part-4)" />
    <title>AWS Amazon Web Services Instance with Terraform and an Elastic IP (Part 4)</title>
    <published>2021-12-02T00:00:00+00:00</published>
    <updated>2021-12-02T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having used Ansible to setup the server in the last post, I now wanted to use Terraform to launch the instance programatically. As part of the  Infrastructure as Code world I am looking to move into, I am keen to be able to automate as much as posible.......</summary>
    <content type="html"><![CDATA[
        <p>Having used Ansible to setup the server in the last post, I now wanted to use Terraform to launch the instance programatically. As part of the  Infrastructure as Code world I am looking to move into, I am keen to be able to automate as much as posible.</p>

<p>Todays blog post is about setting up the instance of the server with Terraform.</p>

<p>It also uses a fixed IP address, which uses the Elastic IP service from Amazon.</p>

<pre><code>variable "awsprops" {
  type = map(string)
  default = {
    region       = "eu-west-2"
    vpc          = "vpc-04a899695f093e273"
    ami          = "ami-050949f5d3aede071"
    itype        = "t2.micro"
    subnet       = "subnet-071b970b97329866c"
    publicip     = true
    keyname      = "amazon nov 2021"
    secgroupname = "IAC-Sec-Group-Terrform"
  }
}

provider "aws" {
  region = lookup(var.awsprops, "region")
}

resource "aws_security_group" "project-iac-sg" {
  name        = lookup(var.awsprops, "secgroupname")
  description = lookup(var.awsprops, "secgroupname")
  vpc_id      = lookup(var.awsprops, "vpc")

  // To Allow SSH Transport
  ingress {
    from_port   = 22
    protocol    = "tcp"
    to_port     = 22
    cidr_blocks = ["0.0.0.0/0"]
  }

  // To Allow Port 80 Transport
  ingress {
    from_port   = 80
    protocol    = "tcp"
    to_port     = 80
    cidr_blocks = ["0.0.0.0/0"]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }

  lifecycle {
    create_before_destroy = true
  }
}

resource "aws_instance" "project-iac" {
  ami                         = lookup(var.awsprops, "ami")
  instance_type               = lookup(var.awsprops, "itype")
  subnet_id                   = lookup(var.awsprops, "subnet") #FFXsubnet2
  associate_public_ip_address = lookup(var.awsprops, "publicip")
  key_name                    = lookup(var.awsprops, "keyname")


  vpc_security_group_ids = [
    aws_security_group.project-iac-sg.id
  ]
  root_block_device {
    delete_on_termination = true
    iops                  = 150
    volume_size           = 50
    volume_type           = "gp3"
  }
  tags = {
    Name        = "SERVER01"
    Environment = "DEV"
    OS          = "DEBIAN"
    Managed     = "IAC"
  }

  depends_on = [aws_security_group.project-iac-sg]
}

data "aws_eip" "project-iac" {
  id = "eipalloc-07a144e8268e6616b"
}

resource "aws_eip_association" "my_eip_association" {
  instance_id   = aws_instance.project-iac.id
  allocation_id = data.aws_eip.project-iac.id

}

output "ec2instance" {
  value = aws_instance.project-iac.public_ip
}

</code></pre>

<p>Please visit this repo at <a href="https://github.com/allotmentandy/aws">github.com/allotmentandy/aws</a> to see the terraform code in the directory part 4. The code is in the setup.tf file and the get it to build the instance you run the following 3 commands.</p>

<pre><code>terraform init 

terraform plan

terraform apply
</code></pre>

<h2>Notes</h2>

<ul>
<li><p>The ip address is allocated to my account and it id = "eipalloc-07a144e8268e6616b"</p></li>
<li><p>The keyname is the name in the amazon system, not the local file.</p></li>
<li><p>The aws credentials are setup using awscli at the command line and stored in .aws/credentials</p></li>
</ul>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-01-AWS-Amazon-Web-Services-Cloud-computing-and-PHP-part3-using-Ansible</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-01-AWS-Amazon-Web-Services-Cloud-computing-and-PHP-part3-using-Ansible" />
    <title>AWS Amazon Web Services Cloud computing and PHP part 3 using Ansible</title>
    <published>2021-12-01T12:33:01+00:00</published>
    <updated>2021-12-01T12:33:01+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Using Ansible to setup the LAMP stack on a clean Debian AWS server....</summary>
    <content type="html"><![CDATA[
        <p>In parts 1 and 2 of this blog series, I wrote about setting up a LAMP stack by hand using ssh and logging into the server and install and configuring it all.</p>

<p>In my opinion, <a href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> is a better way to set this up. It uses a set of files locally to login to and setup the server in a repeatable way.</p>

<p>Once again I am going to use the Debian 10 AMI - ami-050949f5d3aede071 setup with a t2-micro instance on the free tier.</p>

<p>Please visit this repo at <a href="https://github.com/allotmentandy/aws">github.com/allotmentandy/aws</a> for the Ansible files to set this up.</p>

<p>I based this on <a href="https://github.com/kdpuvvadi/ansible-lamp">github.com/kdpuvvadi/ansible-lamp</a> repo as it worked well and is nicely structured.</p>

<p>Important files to setup</p>

<ul>
<li>inventory.ini - set the ip address of the aws debian server</li>
<li>vars/default.yml - set the passwords for the mysql root user, the name of the apache config and the port</li>
<li>tasks/packages - the packages to install, php, mysql, apache and ufw</li>
<li>README.md - notes on setting up the original ansible package.</li>
</ul>

<p>To run this code use this command where the key is set in the command</p>

<pre><code class="language-bash">  ansible-playbook main.yml --key-file /home/andy/.ssh/aws2021.pem  -e 'ansible_python_interpreter=/usr/bin/python3'
</code></pre>

<p>visit the ip address to see the apache test page. /info.php to see the php test page. and login to the mysql server to test the database connection.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-01-AWS-Amazon-Web-Services-Cloud-computing-and-PHP-part2</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-01-AWS-Amazon-Web-Services-Cloud-computing-and-PHP-part2" />
    <title>AWS Amazon Web Services Cloud computing and PHP (Part 2)</title>
    <published>2021-12-01T11:46:57+00:00</published>
    <updated>2021-12-01T11:46:57+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Part 2 - adding a Mysql database server to a debian EC2 instance...</summary>
    <content type="html"><![CDATA[
        <h3>Adding the Mysql DB and getting it running</h3>

<p>Installing mysql isnt as simple as the rest of the LAMP stack. It is necessary to run the mysql_secure_installation command to setup the mysql password and the Update command to allowed login from the website for apps like Adminer. <a href="https://dev.to/oscherler/changing-the-mysql-root-user-from-authsocket-to-password-authentication-using-ansible-3l5m">this article</a> is a good explaination to why.</p>

<pre><code># install mysql

sudo apt-get install -y default-mysql-server
sudo apt-get install -y php8.0-mysql php8.1-mysql

#set the password and setup mysql
sudo mysql_secure_installation

# questions asked
# Enter current password for root (enter for none): 
# Set root password? [Y/n] Y
# Remove anonymous users? [Y/n] Y   
# Disallow root login remotely? [Y/n] Y
# Remove test database and access to it? [Y/n] Y
# Reload privilege tables now? [Y/n] Y

#test connection with the new password 
sudo mysql -u root -p

# to allow login for adminer login to mysql and run
# UPDATE user SET plugin='mysql_native_password' WHERE User='root';

# install adminer
sudo wget "http://www.adminer.org/latest.php" -O /var/www/html/adminer.php
sudo chown -R root:root /var/www/html/adminer.php
sudo chmod 755 /var/www/html/adminer.php

sudo /etc/init.d/mysql restart

</code></pre>

<p>This allows the user to login from the website using adminer and administer the DB tables.</p>

<p>Please visit this repo at <a href="https://github.com/allotmentandy/aws">github.com/allotmentandy/aws</a> for shell scripts and files to run this code.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-12-01-AWS-Amazon-Web-Services-Cloud-computing-and-PHP</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-12-01-AWS-Amazon-Web-Services-Cloud-computing-and-PHP" />
    <title>AWS Amazon Web Services Cloud computing and PHP (Part 1)</title>
    <published>2021-12-01T09:46:57+00:00</published>
    <updated>2021-12-01T09:46:57+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">A start of a series of blogs on setting up AWS resources to host PHP websites...</summary>
    <content type="html"><![CDATA[
        <h3>AWS Amazon Web Services Cloud computing and PHP</h3>

<p>I my quest to learn more about cloud computing especially using PHP, I am spending the cold winter months developing skills. I am going to write blogs about investigating each of these</p>

<ul>
<li>EC2 Debian 10 LAMP server by hand</li>
<li>EC2 Docker Container</li>
<li>AWS Lambda</li>
<li>Amazon Lightsail</li>
<li>Using ansible and terraform to setup a lamp server</li>
<li>Using the AWS CLI</li>
</ul>

<h4>Using EC2 Debian 10 LAMP stack server by hand.</h4>

<p>Setting up an instance is pretty easy - i created a private key, downloaded it and connected the first time using</p>

<pre><code>ssh -i privatekey.pem  admin@ec2-13-40-50-116.eu-west-2.compute.amazonaws.com
</code></pre>

<p>Note the user is admin, as that is the default for debian</p>

<p>Here is a link to the default usernames for different systems</p>

<p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/TroubleshootingInstancesConnecting.html#TroubleshootingInstancesConnectingPuTTY">aws default users for ssh connections to linux distros</a></p>

<p>To run apt-get you need to use sudo</p>

<p>So to install apache</p>

<pre><code>sudo apt-get update
sudo apt-get upgrade

sudo apt-get install apache2

sudo a2enmod ssl
sudo a2enmod rewrite
sudo /etc/init.d/apache2 restart

# install firewall and setup

sudo apt install ufw
sudo ufw allow ssh
sudo ufw allow http
sudo ufw allow https

# to get the https version running

sudo apt install certbot
sudo apt-get install python-certbot-apache

sudo a2ensite default-ssl

sudo systemctl reload apache2

# installing php 8.0 and 8.1

sudo apt-get install lsb-release apt-transport-https ca-certificates
sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
sudo echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/php.list
sudo apt-get update

sudo apt install -y php8.0-{mysql,cli,common,snmp,ldap,curl,mbstring,zip,tidy,xml,opcache}
sudo apt install -y php8.1-{mysql,cli,common,snmp,ldap,curl,mbstring,zip,tidy,xml,opcache}

sudo update-alternatives --config php

sudo apt-get install php8.0-fpm libapache2-mod-php8.0
sudo apt-get install php8.1-fpm libapache2-mod-php8.1
sudo a2dismod php8.0
sudo a2enmod php8.1
sudo systemctl restart apache2

</code></pre>

<p>The default directory for the files is /var/www/html
Setting up a simple test.php file with the contents</p>

<pre><code>&lt;?php

phpinfo();
</code></pre>

<p>Gives the php info test page.</p>

<p>Next, lets install a mysql database to store some data.</p>

<p>Please visit this repo at <a href="https://github.com/allotmentandy/aws">github.com/allotmentandy/aws</a> for shell scripts and files to run this code.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-11-16-Looking-For-Allrounder-Role-Devops-SEO-Design-Development-Creative</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-11-16-Looking-For-Allrounder-Role-Devops-SEO-Design-Development-Creative" />
    <title>Looking For Allrounder Role Devops SEO Design Development Creative</title>
    <published>2021-11-16T00:00:00+00:00</published>
    <updated>2021-11-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I wanted to right a new post about the sort of job role I am looking for. In the past I have had a wide variety of roles from Creative Graphic Designer to Laravel Developer. So I wanted to outline the sort of roles I would be suitable for and to help......</summary>
    <content type="html"><![CDATA[
        <p>I wanted to right a new post about the sort of job role I am looking for. In the past I have had a wide variety of roles from Creative Graphic Designer to Laravel Developer. So I wanted to outline the sort of roles I would be suitable for and to help find a role thats uses a number of these:</p>

<ul>
<li>Laravel PHP development</li>
<li>Web Design with CSS, Photos, Graphics and Imagery</li>
<li>SEO to get the site higher in Search Engines such as Google</li>
<li>Devops and Server configuration using Ansible, Terraform on Google Cloud (GCP) and Amazon Web Services (AWS)</li>
<li>Creative Ideas to improve the business</li>
<li>Writing content for blogs and websites</li>
<li>Using Mapping technologies such as OpenStreetMap</li>
<li>Testing websites and code using a range of tools to ensure websites work as expected</li>
<li>Web Scraping, crawling and indexing content from across the internet.</li>
</ul>

<p>Some example jobs I would be good at</p>

<h3>Moving CSS to Tailwind CSS</h3>

<p>This site and a number of others I have been working on use Tailwind CSS and I would like to find a role to teleport an old fashioned website into the future.</p>

<h3>Writing content for SEO purposes</h3>

<p>I enjoy writing on a number of topics including technology, gardening, cooking and aviation. Perhaps you need some articles written about something</p>

<h3>Scripting to automate your life</h3>

<p>Another skill I have is writing scripts (bash, php etc.) to automate regular processes in your day-to-day work process. Instead of doing it by hand, perhaps i could write you a script to do it automatically</p>

<h3>Mapping projects</h3>

<p>I have recently been working on a mapping project using OpenStreetMap and have used Google Maps extensively in the past.</p>

<p>This is just a short idea of projects I could do for you.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-10-21-Taking-Devops-Full-Circle-With-Packer-AMI-images-For-AWS</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-10-21-Taking-Devops-Full-Circle-With-Packer-AMI-images-For-AWS" />
    <title>Taking Devops Full Circle With Packer AMI images For AWS</title>
    <published>2021-10-21T00:00:00+00:00</published>
    <updated>2021-10-21T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having spent the last year improving my skill base in the Devops arena, I feel like I have gone full circle with Packer. Packer is a tool from Hashicorp that creates server images which you can host on the cloud.

I have learnt to configure the cloud......</summary>
    <content type="html"><![CDATA[
        <p>Having spent the last year improving my skill base in the Devops arena, I feel like I have gone full circle with Packer. Packer is a tool from Hashicorp that creates server images which you can host on the cloud.</p>

<p>I have learnt to configure the cloud with terraform, then setup the tech stack with Ansible.</p>

<p>I have also learnt to Dockerise the entire system as a container</p>

<p>But creating Packer images seems like the most efficient method to build servers with all the tools above, which is then deployed as an image. I can still use Ansible to config it, with terraform to launch it.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-10-02-Laravel-Commands-Using-TailwindCSS-and-Termwind</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-10-02-Laravel-Commands-Using-TailwindCSS-and-Termwind" />
    <title>Laravel Commands Using Tailwind CSS and Termwind</title>
    <published>2021-10-02T00:00:00+00:00</published>
    <updated>2021-10-02T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I recently noticed termwind and as a big fan of command line scripts and also laravel, I had to have a play with it.



I have the source code on this gist

It is a demo of a number of features of using termwind to make the command line colorful....</summary>
    <content type="html"><![CDATA[
        <p>I recently noticed <a href="https://github.com/nunomaduro/termwind/tree/master/src">termwind</a> and as a big fan of command line scripts and also laravel, I had to have a play with it.</p>

<p><img src="/assets/img/termwind.png" alt="Image of termwind" /></p>

<p>I have the source code on this <a href="https://gist.github.com/allotmentandy/c1090e852c12aa6823a294f042567ad1">gist</a></p>

<p>It is a demo of a number of features of using termwind to make the command line colorful.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-06-15-Open-Ports-On-Debian-and-installing-ssh</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-06-15-Open-Ports-On-Debian-and-installing-ssh" />
    <title>Open Ports &amp; Installing SSH</title>
    <published>2021-06-15T10:29:57+00:00</published>
    <updated>2021-06-15T10:29:57+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">To connect my new Intel NUC computer to my laptop and android phone, I have used SSH with Filezilla as that is faster and easier than bluetooth and more ubiqitous. On my phone i have an app which i use to start and stop the ssh port connection. But not......</summary>
    <content type="html"><![CDATA[
        <p>To connect my new Intel NUC computer to my laptop and android phone, I have used SSH with Filezilla as that is faster and easier than bluetooth and more ubiqitous. On my phone i have an app which i use to start and stop the ssh port connection. But not sure this is as easy on the Debian boxes, so...</p>

<p>Firstly, i wanted to check what ports were open on the machine. <a href="https://vitux.com/find-open-ports-on-debian/" target="_blank">https://vitux.com/find-open-ports-on-debian/</a> gives a overview of the options, but installing nmap is my favourite tool for this and running this command gives the output of all open ports.</p>

<pre><code>apt-get install nmap

nmap -p- 127.0.0.1

</code></pre>

<p>Nmap provides the name of the commonly used port as the 'service', port 22 is ssh and it wasnt installed.</p>

<pre><code>Starting Nmap 7.70 ( https://nmap.org ) at 2021-06-15 09:18 BST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000058s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE
631/tcp  open  ipp
1716/tcp open  xmsg

Nmap done: 1 IP address (1 host up) scanned in 10.15 seconds
</code></pre>

<h3>Installing SSH</h3>

<p>Next, to install ssh I ran this command</p>

<pre><code>sudo apt-get install openssh-server
</code></pre>

<p>then to check on the status</p>

<pre><code>sudo systemctl status sshd
</code></pre>

<p>This allowed me to ssh into my machine and copy over a few files. Running the nmap command again and you can see it is now working.</p>

<pre><code>Starting Nmap 7.70 ( https://nmap.org ) at 2021-06-15 09:35 BST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000031s latency).
Not shown: 65532 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
631/tcp  open  ipp
1716/tcp open  xmsg

Nmap done: 1 IP address (1 host up) scanned in 10.12 seconds
</code></pre>

<p>to enable / disable ssh i run these commands</p>

<pre><code>systemctl enable ssh
systemctl disable ssh
</code></pre>

<p>Next, I will use Ansible to install Apache, PHP, Mysql/MariaDB and more tools ...</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-05-17-Openstreetmap-part3</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-05-17-Openstreetmap-part3" />
    <title>Openstreetmap / Overpass Part 3</title>
    <published>2021-05-17T00:00:00+00:00</published>
    <updated>2021-05-17T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I noticed that more entries were using the contact:website links for each of these 3 entities, so i added them to the overpass-turbo query.



This provided 17406 features with at least 1 of the 3 links, with 202 for twitter and 260 for facebook. Here is......</summary>
    <content type="html"><![CDATA[
        <p>I noticed that more entries were using the <strong>contact:website</strong> links for each of these 3 entities, so i added them to the <a href="https://overpass-turbo.eu/" target="_blank">overpass-turbo</a> query.</p>

<pre><code>node[~"^(website|twitter|facebook|contact:website|contact:twitter|contact:facebook)$"~"."]  ({{bbox}});
out;
</code></pre>

<p>This provided 17406 features with at least 1 of the 3 links, with 202 for twitter and 260 for facebook. Here is the list of the full contact details <a href="https://wiki.openstreetmap.org/wiki/Key:contact">https://wiki.openstreetmap.org/wiki/Key:contact</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-05-16-Openstreetmap-contd</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-05-16-Openstreetmap-contd" />
    <title>Openstreetmap / Overpass Part 2</title>
    <published>2021-05-16T00:00:00+00:00</published>
    <updated>2021-05-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Yesterday, I uploaded the demo map and got a buggy version of the OSM map working showing the data stored on a map. I wanted to explore what is actually stored in the system already so I got this query to extract multiple tags (website, twitter,......</summary>
    <content type="html"><![CDATA[
        <h3>Downloading the data for features in Greater London</h3>

<p>Yesterday, I uploaded the demo map and got a buggy version of the OSM map working showing the data stored on a map. I wanted to explore what is actually stored in the system already so I got this query to extract multiple tags (website, twitter, facebook) in one <a href="https://overpass-turbo.eu/" target="_blank">overpass-turbo</a> query.</p>

<pre><code>node[~"^(website|twitter|facebook)$"~"."]  ({{bbox}});
out;
</code></pre>

<p>This file was exported as .geojson and I then wrote a php script to extract those 3 elements and count them. using <a href="https://github.com/halaxa/json-machine" target="_blank">json machine</a></p>

<pre><code class="language-php">&lt;?php
use \JsonMachine\JsonMachine;

require 'vendor/autoload.php';

$counter = 0;
$features = JsonMachine::fromFile('websiteTwitterFacebook.geojson');

foreach ($features as $key=&gt;$value) {
    if ($key=="features"){
        foreach ($value as $feature){
            echo $feature['properties']['@id'];
            echo " ";
            if(isset($feature['properties']['website'])) {
                echo $feature['properties']['website'];
            }
            echo " ";
            if(isset($feature['properties']['twitter'])) {
                echo $feature['properties']['twitter'];
            }
            echo " ";
            if(isset($feature['properties']['facebook'])) {
                echo $feature['properties']['facebook'];
            }
            echo PHP_EOL;
            $counter++;
        }
    }
}
echo "total: ". $counter;
?&gt;
</code></pre>

<p>Total entries with any of the three elements was around 16,000, mainly with websites entries only. This data included some phone numbers and other things:</p>

<pre><code>+44 20 3912 9400
+44 20 7584 1363
+44 20 7584 8918
+44 20 7589 0046
+44 20 7589 8851
+44 20 7730 0085
+44 20 7937 5033
+44 20 8743 0336
+44 20 8749 9977
155
400rabbits.co.uk/
HTTP://EVERESTSPICE.CO.UK
Henry Mayhew
IDMestates.com
La Cantina Sociale
Www.popnrest.com
htpps://www.lowerladysden.co.uk
http://countdown.tfl.gov.uk/#|searchTerm=blackstock road|stopCode=49525
https://docs.google.com/spreadsheets/d/12cLkm_p2ovnebNhQm4NmuTV9A6N6FZgg1SpUZ8phuq0/edit?usp=sharing
leicestersquare@allbarone.co.uk
</code></pre>

<p>But apart from these and a few similar ones i removed from the list, it was mainly websites.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-05-15-Openstreetmap-overpass-mapping-idea</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-05-15-Openstreetmap-overpass-mapping-idea" />
    <title>Openstreetmap/Overpass Mapping Project</title>
    <published>2021-05-15T00:00:00+00:00</published>
    <updated>2021-05-15T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I am looking at re-launching my London website using Openstreetmap with overpass data.

Openstreetmap tags / map features

I have created a demo page to show the map features from the list above. Try entering these in the search box on the demo page......</summary>
    <content type="html"><![CDATA[
        <p>I am looking at re-launching my <strong>London</strong> website using Openstreetmap with overpass data.</p>

<p><a href="https://wiki.openstreetmap.org/wiki/Map_features" target="_blank">Openstreetmap tags / map features</a></p>

<p>I have created a <a href="/overpassMap" target="_blank">demo page</a> to show the map features from the list above. Try entering these in the search box on the <a href="/overpassMap" target="_blank">demo page</a></p>

<ul>
<li>shop=butchers</li>
<li>landuse=allotments</li>
<li>amenity=restaurant</li>
<li>sport=soccer</li>
<li>highway=bus_stop</li>
<li>name=Morrisons</li>
<li>shop</li>
<li>twitter</li>
<li>facebook</li>
<li>website</li>
</ul>

<p>What I would like to do is create 2 subpage templates which pull the query from the url</p>

<ul>
<li>local area eg. Chiswick  /location/chiswick</li>
<li>features eg. Butchers /shop/butchers</li>
</ul>

<p>At first i would like to start with a simple site, but structure it, so it is easy to add features in the future.</p>

<p>I had Laravel in mind as I am used to developing with that, but not sure the best way to get this mapping included.</p>

<h3>Questions</h3>

<ol>
<li>What mapping framework would you use to build this? I have looked into Leaflet.js for this demo.</li>
<li>Is there an easy way to output all tags that apply to the UK? eg. aerialway=t-bar isnt really relevant as there are no ski-resorts in London</li>
<li>How can I update the details for each business? whats the best way to get involved with the data here.</li>
<li>What is the difference between tags and map features. I wanted to show a friend an asian supermarket in hammersmith called <a href="https://www.openstreetmap.org/search?query=hammersmith#map=19/51.49335/-0.23940" target="_blank">Thai Smile</a> - was wondering what is the tags/info for this place. Is this all the data that is stored for <a href="https://www.openstreetmap.org/node/313617786">Thai Smile</a></li>
<li>I would like to see a map with all the tags / map features and ALL data for an area to see what is available. Would this be easier to do offline / locally?</li>
<li>Can I use tags on the <a href="/overpassMap" target="_blank">demo page</a> map?</li>
<li>What are the best tools i can easily install on debian linux? I installed <strong>merkaartor</strong> a map editor for OpenStreetMap.org, and this allowed me to see the data stored for each entry. But where is this info actually visible on a map? There are shops that say they have a bing:photograph, but where is this visible? This is the data I would like to access and use. I would also update it too if I can use this how I hope I can.</li>
</ol>

<hr />
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-04-16-Looking-for-work</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-04-16-Looking-for-work" />
    <title>Looking for work</title>
    <published>2021-04-16T00:00:00+00:00</published>
    <updated>2021-04-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Looking for work in Devops, Linux, Web development, Web Design mainly using Laravel, PHP, Ansible, Terraform, Tailwind CSS and Debian Linux....</summary>
    <content type="html"><![CDATA[
        <p>Over the lockdown period I have been learning and improving my skill set. Based in London (or remote) with years of experience in web development, web design and in IT in general.</p>

<h3>Tailwind CSS</h3>

<p>A modern CSS framwork which brings joy to the way webpages are designed. I have spent a lot of time working with both versions 1 and 2 of tailwind.</p>

<p>read more <a href="/blog/categories/tailwindcss">Tailwind CSS posts</a></p>

<h3>Linux</h3>

<p>I moved to using Debian Linux as my main computer 2 years ago, and have built my knowledge. As part of my focus on Devops, I have also experience with Centos, Ubuntu and other Linux systems (alongside Windows and Apple Mac)</p>

<p>read more <a href="/blog/categories/debian">Debian</a> posts</p>

<h3>DEVOPS - Cloud Server Support</h3>

<ul>
<li>Google Cloud - GCP management including setting up servers</li>
<li>Ansible - A great config management tool</li>
<li>Terraform - A great tool for infrastructure creation with code</li>
<li>Amazon Web Servics - AWS - The biggest cloud platform</li>
</ul>

<p>read more <a href="/blog/categories/ansible">Ansible</a> posts
read more <a href="/blog/categories/devops">Devops</a> posts</p>

<h3>Bash Scripting and Automation</h3>

<ul>
<li>Managing Linux servers with ansible and the Command Line</li>
<li>Web services, scraping and API integration</li>
</ul>

<p>read more <a href="/blog/categories/bash">Bash</a> posts</p>

<h3>PHP Laravel and Wordpress development</h3>

<ul>
<li>using Laravel since version 4.2 (currently version 8)</li>
<li>managed a number of Wordpress blogs over the past 20 years</li>
</ul>

<p>read more <a href="/blog/categories/laravel">Laravel</a> posts</p>

<h3>Testing Websites</h3>

<p>using
- Laravel Dusk - for front end testing
- PHPUnit - for code testing
- Selenium - for website testing.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-04-15-Upgrading-to-php-8</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-04-15-Upgrading-to-php-8" />
    <title>Upgrading to PHP 8</title>
    <published>2021-04-15T00:00:00+00:00</published>
    <updated>2021-04-15T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Upgrading PHP to version 8 to run Laravel Octane and test sites locally for compatability....</summary>
    <content type="html"><![CDATA[
        <p>With the launch of Laravel Octane, I decided it was time to update to PHP 8 on my debian box. This was the process, compiled from a number of webpages which seemed to have cut and paste the wget line wrongly. The php extensions are those needed for Laravel.</p>

<p>update-alternatives is a lovely little tool to select which php version to use.</p>

<pre><code>    apt-get install lsb-release apt-transport-https ca-certificates
    wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
    echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/php.list
    apt-get update
    apt-cache search php 8
    apt install -y php8.0-{mysql,cli,common,snmp,ldap,curl,mbstring,zip,tidy,xml,opcache}
    update-alternatives --config php
    php -v
</code></pre>

<p>However, this only worked at the command line, to get apache to work with php8.0 i also ran</p>

<pre><code>    apt-get install php8.0-fpm libapache2-mod-php8.0
    a2dismod php7.4
    a2enmod php8.0
    systemctl restart apache2
</code></pre>

<p>and viola! the phpinfo() was now version 8.0.3!</p>

<p>However, a tested a Laravel 5 app and it errored with a blank screen. So had to update composer to version 2 and run a composer upgrade like so</p>

<pre><code>    composer self-update --2
    composer upgrade 
</code></pre>

<p>What an improvement in speed for composer! I had to update these lines in the composer json to</p>

<pre><code>        "php": "^7.4|^8.0",
        "fzaninotto/faker": "^1.9.1",
        "phpunit/phpunit": "^9.3"    
</code></pre>

<p>I still have a laravel 5.5 app that i like to use, to downgrade back to php7.4</p>

<pre><code>a2dismod php8.0
a2enmod php7.4
systemctl restart apache2
</code></pre>

<p>and to re-enable php 8.0</p>

<pre><code>a2enmod php8.0
a2dismod php7.4
systemctl restart apache2
</code></pre>

<p>But there is a better way, edit the apache2-site-74.conf and add this to the virtual host conf</p>

<pre><code>        &lt;FilesMatch \.php$&gt;
                # Apache 2.4.10+ can proxy to unix socket
                SetHandler "proxy:unix:/var/run/php/php7.4-fpm.sock|fcgi://localhost/"
        &lt;/FilesMatch&gt;

</code></pre>

<p>and enable the proxy module</p>

<pre><code>a2enmod proxy_fcgi
systemctl restart apache2
</code></pre>

<p>and viola! both versions work, php8 is the default, with php7.4 enabled for the site.</p>

<p>Perfect!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-04-14-debian-commands-to-clean-up-after-apt-get</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-04-14-debian-commands-to-clean-up-after-apt-get" />
    <title>Debian commands to clean up after apt-get</title>
    <published>2021-04-14T00:00:00+00:00</published>
    <updated>2021-04-14T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Commands i run after installing or upgrading on my Debian linux box. I like to keep it clean and there is often GB&#039;s to salvage....</summary>
    <content type="html"><![CDATA[
        <p>I like to keep my Debian Linux machine clean and up-to-date. I regularly run the update to get the latest versions and security patches. (I have disabled the default auto-update as it open happened when i was on a limited interenet connection)</p>

<p>After running</p>

<pre><code>apt-get update
apt-get upgrade
OR
apt-get dist-upgrade
</code></pre>

<p>Regularly find that a lot of files are left behind. So i started a script to cleanup afterwards.</p>

<pre><code>apt-get clean
apt-get autoclean
apt-get autoremove
apt-get purge
</code></pre>

<p>using docker, there is also space to reclain using (WARNING: adding the -a at the end deletes all of them!)</p>

<pre><code>docker system prune 
</code></pre>

<p>Interested to hear from everyone about how else they clean up space after installing and upgrading their computers...</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-03-05-command-to-run-build-script-on-save</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-03-05-command-to-run-build-script-on-save" />
    <title>Script to run build script on save</title>
    <published>2021-03-05T00:00:00+00:00</published>
    <updated>2021-03-05T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Today I decided I wanted a script to auto build the site on each save of this jigsaw blog. I was playing with the css yesterday and liked the simplicity of the npm watch command, but wanted something similar for the build.sh script.

I have been meaning......</summary>
    <content type="html"><![CDATA[
        <p>Today I decided I wanted a script to auto build the site on each save of this jigsaw blog. I was playing with the css yesterday and liked the simplicity of the <em>npm watch</em> command, but wanted something similar for the build.sh script.</p>

<p>I have been meaning to use <em>entr</em> for a while <a href="http://eradman.com/entrproject/" target="_blank_">see entr docs</a> and this seemed perfect for the job.</p>

<pre><code class="language-sh">    #!/bin/bash

    find /var/www/jigsaw-blog/source/_posts/   | entr sh -c './build.sh';
</code></pre>

<p>One problem i found was the max_user_watches was set too low, so running the following command as root, increases the number of file nodes this is allowed to watch. And it worked perfectly after that.</p>

<pre><code class="language-sh">    echo 100000 | tee /proc/sys/fs/inotify/max_user_watches
</code></pre>

<p>Another problem i found is that it breaks if you rename a file, as it monitors for changes, but it cannot deal with that.</p>

<p>This is my build.sh script. It runs the local build but can also run with these flags too:</p>

<pre><code>--npm           runs the laravel mix webpack build
--production    generates the production build
</code></pre>

<p>It uses espeak to announce it is building (a bit like command and conquer!) and then xdotool to reload the firefox browser.</p>

<pre><code class="language-sh">#!/bin/bash -e

# espeak "Building"

for arg in "$@"
do
    if [ "$arg" == "--npm" ] 
    then
        echo "Running npm run production"
        espeak " running en pee em "
        npm run production
    fi
done

espeak "building Local"

 ./vendor/bin/jigsaw -vvv build 

for arg in "$@"
do
    if [ "$arg" == "--production" ] 
    then
        espeak "building production"
        ./vendor/bin/jigsaw build production -vvv
    fi
done

espeak "Finished"

# reload firefox in background
CURRENT_WID=$(xdotool getwindowfocus)
WID=$(xdotool search --name "Mozilla Firefox")
xdotool windowactivate $WID
xdotool key F5
# return to the editor (i prefer it to keep the browser at the front so comment this out!)
xdotool windowactivate $CURRENT_WID

</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2021-02-21-Tailwind-CSS</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2021-02-21-Tailwind-CSS" />
    <title>Tailwind CSS</title>
    <published>2021-02-21T00:00:00+00:00</published>
    <updated>2021-02-21T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">The original version of Tailwind CSS used jigsaw for the docs, the same project i use for this blog, which was lovely. However the latest version (2.0.3 at the time of writing) has migrated to next.js so it was time to investigate and install.......</summary>
    <content type="html"><![CDATA[
        <p>The original version of Tailwind CSS used jigsaw for the docs, the same project i use for this blog, which was lovely. However the latest version (2.0.3 at the time of writing) has migrated to next.js so it was time to investigate and install.</p>

<p><a href="https://github.com/tailwindlabs/tailwindcss.com">github.com/tailwindlabs/tailwindcss.com</a></p>

<p>I prefer to have apache serve all my pages locally, so i followed the instructions adding a</p>

<p><code>yarnpkg export</code></p>

<p>to create an html static site of the documentation into an 'out' directory which apache can serve, which all worked well (if a little slow to generate it all). But it all works locally, which i like.</p>

<h3>Awesome TailwindCSS</h3>

<p>As the Tailwind CSS project has grown and matured, a great <a href="https://github.com/aniftyco/awesome-tailwindcss">Awesome TailwindCSS</a> github page has grown and grown.</p>

<p>https://tail-animista.vercel.app/</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-11-15-Ansible-Ansible-Ansible-part-2</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-11-15-Ansible-Ansible-Ansible-part-2" />
    <title>Ansible Ansible Ansible - Part 2</title>
    <published>2020-11-15T00:00:00+00:00</published>
    <updated>2020-11-15T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Ansible resources online, Ansible cheatsheets and Ansible Videos I really enjoyed....</summary>
    <content type="html"><![CDATA[
        <p>The other day I wrote an post about the offline resources I use for learning, especially about Ansible which you can read here <a href="https://allotmentandy.github.io/blog/2020-11-08-Offline-documentation-on-debian" target="_blank_">Offline documentation on Debian</a> Zeal and Devdocs.io are very useful.</p>

<h3>Ansible Websites and Websites</h3>

<p>I have now been using and learning Ansible for a good few months and wanted to list all the resources I regularly use.</p>

<p><a href="https://www.ansible.com/" target="_blank_">www.ansible.com</a></p>

<p><a href="https://docs.ansible.com/ansible/2.9/user_guide/" target="_blank_">docs.ansible.com</a></p>

<p><a href="https://stackoverflow.com/questions/tagged/ansible" target="_blank_">Stack Overflow questions tagged with Ansible</a></p>

<h3>Ansible Videos</h3>

<p>I really like learning videos in the evening to find out more about a topic. Jeff is a great Ansible guru and this playlist has taught me a lot. His books are also superb resources for learning about the world of Ansible.</p>

<iframe id="ytplayer" type="text/html" width="640" height="360" src="https://www.youtube.com/embed/goclfp6a2IQ?autoplay=0&origin=http://example.com" frameborder="0"></iframe>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-11-14-Ansible-Ansible-Ansible-part-1</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-11-14-Ansible-Ansible-Ansible-part-1" />
    <title>Ansible Ansible Ansible - Part 1</title>
    <published>2020-11-14T00:00:00+00:00</published>
    <updated>2020-11-14T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">my first article in a series on Ansible, covering the Facts ansible can tell you about your machines and how I have been learning Ansible....</summary>
    <content type="html"><![CDATA[
        <p>Of all the Devops tools I have learnt this year, Ansible is my favourite. The ability to connect to different servers and perform different tasks in a way you can expect is superb. I have installed different flavour Linux Virtual Machines alongside my Raspberry Pi's and it connects to each one and does its thing as I expect.</p>

<p>The idea of automating everything, having it act in an expected and repeatable way is superb. I have written bash scripts that try to do this in the past, but fall over at scale and repeatability. Ansible is great for this.</p>

<p>In the process of learning ansible I have an inventory with 1 control node and 4 machines</p>

<pre><code>[x] localhost (debian 10) [Control node]
[x] virtual machine (centos 8)
[x] virtual machine (ubuntu 20)
[x] virtual machine (alpine linux 3.12)
[x] raspberry pi (raspbian)
</code></pre>

<p>With this as my personal cloud, i can connect with ansible via ssh and run a whole range of tasks including:</p>

<pre><code>[x] install and configure a webserver, mysql and install a laravel github repo
[x] run a git pull to update the repo
[x] update the OS and software
[x] install a docker container on a server 
[x] check the status of the machines 
</code></pre>

<p>Ansible provides a number of Facts for a machine which can be seen with this command:</p>

<pre><code>ansible localhost -m setup --tree /tmp/facts
</code></pre>

<p>it is a json file of around 600 lines of Facts including for my localhost machine:</p>

<pre><code>    "ansible_facts":
    {
        "ansible_os_family": "Debian",
        "ansible_architecture": "x86_64",
        "ansible_memtotal_mb": 7417,

    }
</code></pre>

<p>There is also extensive details about hardrives, IP addresses, python versions, users and the computer in general.</p>

<p>Similarly, Ansible provides details of the services running on the machine:</p>

<pre><code>ansible localhost -m service_facts --tree /tmp/services
</code></pre>

<p>it provides a 1000 line Json file, with details of the services running on the machine, here is an example of the result:</p>

<pre><code>    "ansible_facts":
    {
        "services":
            "apache2":
            {
                "name": "apache2",
                "source": "sysv",
                "state": "running"
            },
            "apache2.service":
            {
                "name": "apache2.service",
                "source": "systemd",
                "state": "running",
                "status": "enabled"
            },
    }
</code></pre>

<p>Also available is a list of package facts</p>

<pre><code>ansible localhost -m package_facts --tree /tmp/package
</code></pre>

<p>This resulted in a json file with over 20000 lines, with details of everything installed on the machine, here is a section from the result:</p>

<pre><code>    "ansible_facts":
    {
        "packages":
        {
            "apache2": [
            {
                "arch": "amd64",
                "category": "httpd",
                "name": "apache2",
                "origin": "Debian",
                "source": "apt",
                "version": "2.4.46-1"
            }],
            "zeal": [
            {
                "arch": "amd64",
                "category": "doc",
                "name": "zeal",
                "origin": "",
                "source": "apt",
                "version": "1:0.6.1-1+b1"
            }],
        }
    }
</code></pre>

<p>This provides a great deal of info about the machine, from which you could manage the the machines with conditionals like this.</p>

<pre><code>- hosts: localhost
  roles:
     - role: debian_stock_config
       when: ansible_facts['os_family'] == 'Debian'
</code></pre>

<p>One thing I really like about Ansible is it is pretty obvious what the code is doing, and logical in how it does it. All these commands in this first part are ad-hoc, as in they are single commands you run in the command line.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-11-08-Bash-fwf-ranger</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-11-08-Bash-fwf-ranger" />
    <title>Bash fwf ranger</title>
    <published>2020-11-08T00:00:00+00:00</published>
    <updated>2020-11-08T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I was recently looking for videos to help me improve my bash terminal skills and found this video by Marie-Helene Burle Fun tools to simplify your life in the command line

The two tools i really liked and have found really useful are &lt;code&gt;fzf&lt;/code&gt;......</summary>
    <content type="html"><![CDATA[
        <p>I was recently looking for videos to help me improve my bash terminal skills and found this video by Marie-Helene Burle <a href="https://www.youtube.com/watch?v=BFKT7aj-i80" target="_blank">Fun tools to simplify your life in the command line</a></p>

<p>The two tools i really liked and have found really useful are <code>fzf</code> and <code>ranger</code>.</p>

<h3>fzf</h3>

<p>fzf is a fuzzy search for the terminal. To search for docs in the directory which contain ansible  run <code>ls | fzf</code> and i can type ansible and it shows the files that contain ansible.</p>

<p>To search for ansible only use:</p>

<pre><code>ls | fzf -e -q "ansible"
</code></pre>

<h3>ranger</h3>

<p><code>ranger</code> is a terminal file manager that is nice and quick and lets me navigate and view the file content.</p>

<p>both of these tools can be installed with</p>

<pre><code>apt-get install fzf ranger
</code></pre>

<p>I am always on the lookout for more tools that improve and speed up the workflow.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-11-08-Offline-documentation-on-debian</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-11-08-Offline-documentation-on-debian" />
    <title>Offline Documentation on Debian</title>
    <published>2020-11-08T00:00:00+00:00</published>
    <updated>2020-11-08T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">A lot of the time I work offline, learning, reading, watching and playing to learn more and more.

One thing i really like to use is offline tools to help me access info offline. However I am looking for info on a wide range of topics including devops,......</summary>
    <content type="html"><![CDATA[
        <p>A lot of the time I work offline, learning, reading, watching and playing to learn more and more.</p>

<p>One thing i really like to use is offline tools to help me access info offline. However I am looking for info on a wide range of topics including devops, webdev, frontend, backend and linux in general. There is no one super tool which covers everything so here is a list of my favourite souces.</p>

<h3>man</h3>

<p>The <code>man</code> command provides a great starting point to read the manpages for a command. eg. <code>man ansible</code> gives a good intro, but it isnt the most readable or user friendly.</p>

<h3>apropos</h3>

<p>Finding what <code>man apropos</code> pages are available is possible with <code>apropos ansible</code></p>

<h3>gman</h3>

<p>Alongside the command line tools above, <code>gman</code> is a neat GUI tool to show an index of the man pages on the system.</p>

<h3>tldr</h3>

<p>tldr is similar to the man pages above, but gives examples of usage. <code>tldr git</code> or <code>tldr ansible</code> all provide a neat list of the most common commands you want to use. You have to update the database of info with the <code>tldr --update</code> command</p>

<h3>eg</h3>

<p>In a similar vain to tldr above, eg, provides even more examples of how to use a command, with a bit more detail.</p>

<h3>Zeal</h3>

<p>Zeal is a GUI which allows one to download docs to read offline. It doesnt cover as much, for example it has the docs for Ansible, Docker and Laravel, but not Terraform</p>

<h3>devdocs.io</h3>

<p>devdocs.io is an offline website which allows you to download the docs to read offline. It does cover Terraform, Ansible, Laravel and more. I use it with Chrome with a plugin</p>

<hr />

<p>I would be interested in anymore tools people use for offline documentation, especially one that covers Tailwind CSS.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-08-25-bash-scripts-for-laravel-php-linux-devops</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-08-25-bash-scripts-for-laravel-php-linux-devops" />
    <title>Bash Scripts for Laravel PHP Linux Devops</title>
    <published>2020-08-25T00:00:00+00:00</published>
    <updated>2020-08-25T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Having spent the summer learning more of the Devops toolkit, I often come back to bash shell scripts to achieve something.



I wanted a little script to import the values of the .env file to use in the bash scripts. This works as i expect.





This is......</summary>
    <content type="html"><![CDATA[
        <p>Having spent the summer learning more of the Devops toolkit, I often come back to bash shell scripts to achieve something.</p>

<h3>importEnv.sh</h3>

<p>I wanted a little script to import the values of the .env file to use in the bash scripts. This works as i expect.</p>

<pre><code class="language-bash">#!/bin/bash

source /var/www/laravel/.env
echo $DB_USERNAME
</code></pre>

<h3>mysqlBackup</h3>

<p>This is a one liner to backup all the mysql databases.</p>

<pre><code>mysql -u root -p -N -e 'show databases' | while read dbname; do mysqldump -u root -p --complete-insert --routines --triggers --single-transaction "$dbname" &gt; "$dbname".sql; done

</code></pre>

<h3>deploy.sh</h3>

<p>Working with the jigsaw static site builder, i wrote this simple script to copy the production version of the site to another directory and deploy it to the github pages site.</p>

<pre><code class="language-bash">#!/bin/bash -e

echo "Deploying build_production to allotmentandy.github.io"
echo "---------"

cd build_production 
cp -r * /var/www/allotmentandy.github.io

cd /var/www/allotmentandy.github.io

git add .
git commit -m "update"
git push

echo 'finished'
</code></pre>

<h3>clearLaravelCaches.sh</h3>

<pre><code class="language-bash">#!/bin/bash

echo "This a bash script to run composer clear the caches)"
echo "--------------"
php -v
#echo "--------------"

cd /var/www/laravel

php artisan down

composer dump-autoload -o

php artisan view:clear
php artisan config:clear
php artisan cache:clear
php artisan route:clear
php artisan clear-compiled
php artisan config:cache
php artisan optimize

php artisan up
</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-07-27-moving-into-devops</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-07-27-moving-into-devops" />
    <title>Moving into Devops</title>
    <published>2020-07-27T00:00:00+00:00</published>
    <updated>2020-07-27T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">In my last contract role, I spent more time working with the Devops team than the frontend team. I really enjoyed it and now feel that this is a better path for me. I have been using the command line to build, manage and test servers for many many years......</summary>
    <content type="html"><![CDATA[
        <p>In my last contract role, I spent more time working with the Devops team than the frontend team. I really enjoyed it and now feel that this is a better path for me. I have been using the command line to build, manage and test servers for many many years and feel this is somewhere I can offer more to companies in the future.</p>

<p>I was on twitter and I found this article <a href="https://www.freecodecamp.org/news/alternative-career-paths/">about alternative career paths from freecodecamp</a> and the Devops idea was one most appealing to me.</p>

<p>I have spent a lot of the last few months learning more and more about linux and the Command line. Including learning Bash Scripting and Python.</p>

<h3>ssh</h3>

<p>create a ssh key and copy it to the raspberry pi:</p>

<pre><code>root@linuxtechi:~# ssh-keygen
root@linuxtechi:~# ssh-copy-id root@192.168.1.156
</code></pre>

<p>This allows you to ssh into the machine without a password.</p>

<h3>Bash Cheat sheet</h3>

<p>Back in the days as an Apple Mac user, i really like Applescript. With these little scripts you could get stuff done quickly and easily. Laravel also provides a need way to write command line scripts which allow me to download and process the data.</p>

<p>Bash scripting is similar, i now have scripts to create new posts for this blog, build the css/js with webpack, deploy the site to github and many more.</p>

<p>To help, I have added a <a href="/bash_shortcuts">Bash Cheat cheet</a> to this blog.</p>

<h3>Ansible</h3>

<p>Ansible is a tool to software provisioning, configuration management, and application-deployment tool. <a href="https://en.m.wikipedia.org/wiki/Ansible_(software)">wikipedia</a></p>

<p><a href="https://opensource.com/resources/what-ansible">opensource.com intro to ansible</a></p>

<p>I do like learning from videos and I found this series of videos 
<a href="https://www.youtube.com/playlist?list=PL2_OBreMn7FplshFCWYlaN2uS8et9RjNG">Ansible with Jeff Geerling</a></p>

<p>Cheatsheets</p>

<p><a href="https://github.com/germainlefebvre4/ansible-cheatsheet">github.com/germainlefebvre4/ansible-cheatsheet</a></p>

<p><a href="https://armoucar.github.io/ansible-cheatsheet/">armoucar.github.io/ansible-cheatsheet/</a></p>

<p>Now i can setup a hosts file like so:</p>

<pre><code>[raspberrypi]
192.168.1.166 ansible_ssh_user=pi hostname=raspberrypi

</code></pre>

<p>Once i set up the ssh login (see above), i can now test the server connection with</p>

<pre><code>ansible -i hosts -m ping raspberrypi
</code></pre>

<p>i have setup a new github repo which i run like this:</p>

<pre><code>ansible-playbook site.yml -i hosts
</code></pre>

<h3>Vagrant and Virtualbox</h3>

<p>With Laravel there is Homestead which provides an easy vagrant box with all the linux tools to run a website. I have also used Virtualbox for years to run debian boxes from around the time of Debian 6.</p>

<pre><code>vagrant up
vagrant halt
vagrant ssh
</code></pre>

<h3>Docker</h3>

<p>Docker takes the whole Vagrant VM forward and makes an entire container which you can deploy as the finished website. I have used it before in my last contract role and found it very powerful.</p>

<p><a href="https://www.youtube.com/watch?v=BvDXzyOP3NE">Kickass Laravel Development with Docker - David McKay - Laracon EU 2018 Amsterdam</a></p>

<h3>Jenkins</h3>

<p>Jenkins is a Continuous Integration and testing environment which allows you to test your code as it is pushed to Github.</p>

<p><a href="https://www.youtube.com/watch?v=kuBD3p20oyE">PHP UK Conference 2018 - Michael Heap - Zero to Jenkins: Automatic builds + deploys
</a></p>

<p>I am installing Jenkins on my Raspberry Pi using this tutorial from 
<a href="https://pimylifeup.com/jenkins-raspberry-pi/">https://pimylifeup.com/jenkins-raspberry-pi/</a></p>

<p><a href="http://jenkins-php.org/installation.html">jenkins-php.org</a></p>

<p><a href="https://github.com/amochohan/laravel-jenkins-ci-boilerplate">https://github.com/amochohan/laravel-jenkins-ci-boilerplate</a></p>

<p>To install jenkins add this to the playbook</p>

<pre><code>   tasks:
    - name: ensure the jenkins apt repository key is installed
      apt_key: url=https://pkg.jenkins.io/debian-stable/jenkins.io.key state=present
      become: yes

    - name: ensure the repository is configured
      apt_repository: repo='deb https://pkg.jenkins.io/debian-stable binary/' state=present
      become: yes

    - name: ensure jenkins is installed
      apt: name=jenkins update_cache=yes
      become: yes

    - name: ensure jenkins is running
      service: name=jenkins state=started
</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-07-16-general-thoughts</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-07-16-general-thoughts" />
    <title>General Thoughts about getting some work.</title>
    <published>2020-07-16T00:00:00+00:00</published>
    <updated>2020-07-16T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have been trying to get some work, so I tried nextdoor.co.uk and upwork.com, here is how it went....</summary>
    <content type="html"><![CDATA[
        <p>I have been trying a number of new things to try and get work.</p>

<p>Firstly i discovered <a href="http://www.nextdoor.co.uk">nextdoor.co.uk</a> a localised website for helping people communicate with each other. The site excited me at first and I managed to post a number of messages about potential jobs/work. The first one about IT work got one response, I elderly gentleman who wanted help 'in the future' with setting up a laptop, security and more. However, he has never got back to me and I dont hold out much hope that he will. The second post was offering gardening work, something I can do and enjoy. This too had one response, from a lady nearby. I wondered round, to find a tiny garden, but alas the women had no money to pay for the work and was just trying to get me to do it as a portfolio piece. Hmm. Further posts have gotten me nowhere except I guy that asked for a day or twos labour, and then cancelled the day before as his cousin was coming and would do it for free. Great.</p>

<p>Yesterday, I emailed / contacted around 10 local gardening firms about gardening work and have got zero replies. Great.</p>

<p>Yesterday I also looked at finding potential work on <a href="https://www.upwork.com">Upwork.com</a> A website for freelancers and companies to content for work. I have used this website before and also elance which they have taken over in the past. I preferred elance as it worked better without all the fancy javascript which doesn't quite work. Now though, Upwork has created a type of currency called 'connects' which you have to buy for the right to connect with potential jobs. I have used this site to hire programmers in the past, and the spam was very high.</p>

<p>So still trying to find work, any ideas?</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-06-25-laravel-starter-projects</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-06-25-laravel-starter-projects" />
    <title>Laravel starter projects</title>
    <published>2020-07-06T00:00:00+00:00</published>
    <updated>2020-07-06T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Looking at Laravel starter projects which offer more than a basic install including an admin system, login and more....</summary>
    <content type="html"><![CDATA[
        <p>Yesterday i wrote about how i was looking at wordpress and laravel starter projects to build a website directory. I installed a number of wordpress projects but non of them seemed to be what I am looking for.</p>

<p>So I started to look for a Laravel starter project that i can work with.</p>

<p>I am going to install each one and write a blog on the experience of each.</p>

<h4>https://github.com/laravel-frontend-presets/tailwindcss</h4>

<p>I was looking for something simple with just tailwind and laravel so i also found this:</p>

<p><a href="https://github.com/laravel-frontend-presets/tailwindcss">laravel frontend presets / tailwindcss</a></p>

<p>You start with a default laravel install and justs add the presets on top.</p>

<h4>Jeremy Kenedy / laravel-auth</h4>

<p>I have used this project in the past and found it great.</p>

<p><a href="https://github.com/jeremykenedy/laravel-auth" target="_blank">laravel-auth</a></p>

<h4>innocenzi / laravel-boilerplate</h4>

<p><a href="https://github.com/innocenzi/laravel-boilerplate" target="_blank">laravel-boilerplate</a></p>

<h4>nasirkhan / laravel-starter</h4>

<p><a href="https://github.com/nasirkhan/laravel-starter" target="_blank">nasirkhan/laravel-starter</a></p>

<h4>rappasoft / Laravel Boilerplate</h4>

<p><a href="https://github.com/rappasoft/laravel-boilerplate">Laravel Boilerplate</a></p>

<h4>laraship-laravel-directory</h4>

<p><a href="https://www.laraship.com/product/laraship-laravel-directory/" target="_blank">laraship laravel directory</a></p>

<p>Not really a starter project, more of a solution of what i am trying to offer.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-07-04-pdf-making-pdfs-extracting-pages-from-pdfs</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-07-04-pdf-making-pdfs-extracting-pages-from-pdfs" />
    <title>Playing with PDFs</title>
    <published>2020-07-04T00:00:00+00:00</published>
    <updated>2020-07-04T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have always loved reading, on my computer, phone, books, magazines and newspapers. I have collected a huge number of PDFs over the years. Here is how i work with them....</summary>
    <content type="html"><![CDATA[
        
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-06-25-getting-your-github-pages-sites-into-google</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-06-25-getting-your-github-pages-sites-into-google" />
    <title>Getting your Github Pages site into Google</title>
    <published>2020-06-25T20:52:00+00:00</published>
    <updated>2020-06-25T20:52:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">How I got Google to index / crawl my site by submitting it via the Google Search Console....</summary>
    <content type="html"><![CDATA[
        <p>I have been running this website for a few months and what started as an experiment I am rather enjoying as a place to write and play around with Code and more.</p>

<p>But one thing I checked yesterday, was how many pages were indexed by Google.</p>

<p>Google search for "site:http://allotmentandy.github.io/" and the answer was NONE - ZERO - ZILCH - NADA!!</p>

<p>But Google provided a handy link to its Google Search Console. So i managed to login to my Google account, added a meta tag to the layout template and managed to get Google to index the site. Today there are 8 pages in the Google index. Which is better.</p>

<p>Small wins each day! Of those 8 pages, 3 only have 'AllotmentAndy' as the title, The blog index page has 'AllotmentAndy - GitHub Pages' as the title and the others have 'AllotmentAndy - PAGE TITLE'</p>

<p>Will see how this changes over the next few days.</p>

<p>Would like to improve the Title tags for the static pages in the root. I have added some yaml to the top of the web safe fonts page to improve the title tag. Lets see how long it takes Google to notice!</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-06-24-relaunching-my-directory</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-06-24-relaunching-my-directory" />
    <title>Relaunching my directory</title>
    <published>2020-06-24T00:00:00+00:00</published>
    <updated>2020-06-24T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Back in 1998, i registered a url, londinium.com and built a website directory. Over the years, i built quite a nice website, with over 100,000 links to mainly London based information. However in 2015, it started to be bought down daily by DDOS attacks.......</summary>
    <content type="html"><![CDATA[
        <h3>Directory websites in Wordpress</h3>

<p>Back in 1998, i registered a url, londinium.com and built a website directory. Over the years, i built quite a nice website, with over 100,000 links to mainly London based information. However in 2015, it started to be bought down daily by DDOS attacks. It was also removed from google searches and the revenue went down towards zero. So i shut it down.</p>

<p>Since then, i have tried with a shopify online store, but that hasnt worked.</p>

<p>So i come back to the idea of a London directory website, but want to make it more useful.</p>

<p>So i am going to look at Wordpress plugins to re-launch londinium.</p>

<p>These are the wordpress directories i have looked at, to be far i wasnt too impressed with any of them.</p>

<h2>Wordpress Directories Plugins</h2>

<h4>Geo-directory</h4>

<p><a href="https://wpgeodirectory.com/" target="_blank">Geo-directory</a><br />
<a href="https://wordpress.org/plugins/geodirectory/" target="_blank">Geo-directory on Wordpress</a></p>

<h4>Business Directory</h4>

<p><a href="https://businessdirectoryplugin.com/" target="_blank">Business Directory</a><br />
<a href="https://wordpress.org/plugins/business-directory-plugin/" target="_blank">Business Directory on Wordpress</a></p>

<h4>Advanced Classifieds &amp; Directory Pro</h4>

<p><a href="https://pluginsware.com/" target="_blank">Pluginsware</a><br />
<a href="https://wordpress.org/plugins/advanced-classifieds-and-directory-pro/" target="_blank">Advanced Classifieds &amp; Directory Pro on Wordpress</a></p>

<h4>Hivepress</h4>

<p>This looked the most impressive on first glimpse, but the demo content wouldnt import and after a few tries i gave up.</p>

<p><a href="https://hivepress.io/" target="_blank">Hivepress</a><br />
<a href="https://wordpress.org/plugins/hivepress/" target="_blank">Hivepress on Wordpress</a></p>

<h4>Web Directory Free</h4>

<p><a href="https://www.salephpscripts.com/wordpress_directory/demo/" target="_blank">Web Directory Free</a><br />
<a href="[https://wordpress.org/plugins/web-directory-free/]" target="_blank">Web Directory Free on Wordpress</a></p>

<p>I would be interested in seeing websites that use any of these plugins and chat to users of these plugins, but it looks like I am going to have to build something myself.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-06-06-rss-feeds-debian</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-06-06-rss-feeds-debian" />
    <title>RSS Feeds with Debian Linux</title>
    <published>2020-06-06T10:29:57+00:00</published>
    <updated>2020-06-06T10:29:57+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I have always been a fan of RSS feeds going back years. In case you don&#039;t know, RSS feeds (and ATOM feeds) are text files that provide the latest pages from a website. I use them for News, website statuses and more.

I use a number of RSS feed readers on......</summary>
    <content type="html"><![CDATA[
        <p>I have always been a fan of RSS feeds going back years. In case you don't know, RSS feeds (and ATOM feeds) are text files that provide the latest pages from a website. I use them for News, website statuses and more.</p>

<p>I use a number of RSS feed readers on my Debian machine and wanted to highlight what I like about each one.</p>

<h3>QuiteRSS</h3>

<p>My main RSS feed reader, i like it, but it is a little slow to open and close. One small problem I have is that when i open it, it is always set to "ALWAYS ON TOP". Everytime I open QuiteRSS, i have to untick the "ALWAYS ON TOP" setting in the right click. I cannot find how this has been set in the settings/options panels. Maybe this is a feature I discovered in another window manager, as i used LXDE earlier. Any ideas how to unset this?</p>

<p>All round, i like QuiteRSS, it doesnt have a progress box to show downloads, something I would like to see as i often work with sporadic internet connections.</p>

<p>There is an ability to search within one feed, but thats not how I need to search.</p>

<p>One really annoying feature is if you click on the line between the news items in a feed, it decides to open in a browser. This also tends to open a new browser window, but as i am offline, it just gives an error page.</p>

<p>Another strange feature is that many articles are marked as read, even thou i havent had a chance to read the feeds. I tend to go to the wireless hotspot, download all the feeds and go back to my desk to read them. But they are often marked read.</p>

<p>I use QuiteRSS as my main feed reader, but am open to new ways. So i tried the following apps, but none quite did it for me!</p>

<h3>Liferea</h3>

<p>I like the way you can read the unread feeds across all the feeds in the app. This is how i have gone through the feeds, but it is a little unnerving when they disappear after you click on the next one. But i suppose this is now not unread!</p>

<p>I also liked the way there was a make folder option, QuiteRSS doesnt offer folders for the feeds, so they are all in one long list. The problem with Liferea is that any folder I make, doesn't actually appear.</p>

<h3>Akregator</h3>

<p>After finding a number of OPML files (rss backups) on github, I wanted to see what these feeds offered, but didnt want to clog up QuiteRSS or Liferea with other peoples feeds, so i used Akregator.</p>

<p>Akregator was quite minimal, but let me import 5 opml files with ease and read the feeds.</p>

<p>However, after shutting down Akregator (or so i thought) It seems to keep a background process running which created errors as i am offline a lot.</p>

<p>So now i dont use Akregator much as that background process wasnt what i wanted.</p>

<h3>Newsboat</h3>

<p>I installed a Command Line (CLI) to test out what RSS feeds were like from the command line. I imported my main opml file to give it a whirl, but on reopening the app after the first feed update, all the feeds were gone. So i gave up on that one.</p>

<h3>Conclusion</h3>

<p>I would be interested in any solutions to issues i have written about here. You can contact me via <a href="https://www.github.com/allotmentandy1">twitter</a>
If you can share your feeds via .OPML files I would love to see what you read.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-06-05-looking-for-work</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-06-05-looking-for-work" />
    <title>Looking for work</title>
    <published>2020-06-05T00:00:00+00:00</published>
    <updated>2020-06-05T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I am looking for work in London or remotely. I have years of experience in web development, web design and in IT in general. Also available in West London on an hourly basis to help you fix your IT problems, like wifi, virus removal, updates, installation and more......</summary>
    <content type="html"><![CDATA[
        
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-30-testing</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-30-testing" />
    <title>Testing</title>
    <published>2020-05-30T00:00:00+00:00</published>
    <updated>2020-05-30T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">There was a website a long time ago called the World Question Centre, where they asked famous people to ask one question. One of the respondents asked Why is music such a pleasure? I always loved this questions as I see it as perfect.

I have also used......</summary>
    <content type="html"><![CDATA[
        <h3>Why is music such a pleasure?</h3>

<p>There was a website a long time ago called the World Question Centre, where they asked famous people to ask one question. One of the respondents asked <em>Why is music such a pleasure?</em> I always loved this questions as I see it as perfect.</p>

<p>I have also used this question to test people. If I say this to you and you try to answer it, you have missed the point. The answer isnt in something in the ears and brain or any other reason. It is just a great question, it is not a test to answer. I am looking for people who say, <em>What a great question</em>.</p>

<p>IBM used to test people like this, if you were looking for work at IBM, they would take you to dinner to sillently test you. Once you got your food, if you put salt and pepper on before tasting it, you failed! They are looking for people who fit a high quality culture. I notice people putting on salt and pepper often and think of this.</p>

<p>There are a number of other questions i like to ask to test people and see what they are made of. For example, another question is, <em>Where does money come from, how is it made?</em></p>

<p>This sort of testing people is to route out people who do not think and just live in a bubble of ignorance. I am not trying to say I am right here, just it is a waste of time to engage with people who cannot question what they think they know. How can these help you improve if they do not improve themselves.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-23-idea-days-work-days</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-23-idea-days-work-days" />
    <title>Idea Days Work Days</title>
    <published>2020-05-23T00:00:00+00:00</published>
    <updated>2020-05-23T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Some days I can be really creative, other days I am to be really productive. It&#039;s a nice mix as one has to work out what to do, then do it. I like to experiment a lot, so there is a lot of research one can do.

Today I started an article on RSS viewers......</summary>
    <content type="html"><![CDATA[
        <p>Some days I can be really creative, other days I am to be really productive. It's a nice mix as one has to work out what to do, then do it. I like to experiment a lot, so there is a lot of research one can do.</p>

<p>Today I started an article on RSS viewers that are easy to install with Debian. I found a cool command line app called newsboat, which i have been using today.</p>

<p>On a personal note, i was given a nickname last year, WOODY, which was the name of the 3rd version of Debian! Lovely...</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-17-tailwind-css</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-17-tailwind-css" />
    <title>Tailwind CSS</title>
    <published>2020-05-17T11:42:57+00:00</published>
    <updated>2020-05-17T11:42:57+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">One thing i really liked about this Jigsaw static site generator is it comes with Tailwind Css and a working Laravel Mix / Webpack / PurgeCSS solution.

Tailwind CSS is much more like coding CSS / HTML about 20 years ago. But the difference being you can......</summary>
    <content type="html"><![CDATA[
        <p>One thing i really liked about this Jigsaw static site generator is it comes with Tailwind Css and a working Laravel Mix / Webpack / PurgeCSS solution.</p>

<p>Tailwind CSS is much more like coding CSS / HTML about 20 years ago. But the difference being you can do soo much with a core set of standard css options.</p>

<p>The advantage is that you just write the html with classes that make sense to the context of what you are doing with the html element.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-17-my-newPost-bash-script</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-17-my-newPost-bash-script" />
    <title>My New Post Bash Shell Script</title>
    <published>2020-05-17T10:46:57+00:00</published>
    <updated>2020-05-17T10:46:57+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I like to make shell scripts to make my life easier. this is my current newPost script. It isnt very comlicated, but gives me a simple blank post, quickly.

I would like it to format the $something in camel case with the dashs removed by spaces.

Also, I......</summary>
    <content type="html"><![CDATA[
        <p>I like to make shell scripts to make my life easier. this is my current newPost script. It isnt very comlicated, but gives me a simple blank post, quickly.</p>

<p>I would like it to format the $something in camel case with the dashs removed by spaces.</p>

<p>Also, I could add a line to open it in sublime</p>

<pre><code class="language-bash">#!/bin/bash

echo -n "New File Name:"
read something

echo "You Entered: $something"

FILE="source/_posts/$(date +%F)-$something.md"

touch $FILE

cat &gt; $FILE &lt;&lt; EOF
---
extends: _layouts.post
section: content
title: $something
date: $(date +%F)
description: 
cover_image: 
excerpt: 
categories: []
---
EOF

</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-17-highlight-js</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-17-highlight-js" />
    <title>Using highlight.js</title>
    <published>2020-05-17T02:02:02+00:00</published>
    <updated>2020-05-17T02:02:02+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Jigsaw comes with highlightjs to show code blocks in colour, here is a CSS, HTML and Bash output for the jigsaw command...</summary>
    <content type="html"><![CDATA[
        <p>Jigsaw comes with highlightjs to show code blocks in colour, here is a CSS, HTML and Bash output for the jigsaw command</p>

<h3>CSS</h3>

<pre><code class="language-css"><br />{
    body: 
}

</code></pre>

<h3>HTML</h3>

<pre><code class="language-html"><br />&lt;a href='#'&gt;link&lt;/a&gt;

</code></pre>

<h3>bash ./vendor/bin/jigsaw</h3>

<pre><code class="language-bash">Jigsaw 1.3.27

Usage:
  command [options] [arguments]

Options:
  -h, --help            Display this help message
  -q, --quiet           Do not output any message
  -V, --version         Display this application version
      --ansi            Force ANSI output
      --no-ansi         Disable ANSI output
  -n, --no-interaction  Do not ask any interactive question
  -v|vv|vvv, --verbose  Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug

Available commands:
  build  Build your site.
  help   Displays help for a command
  init   Scaffold a new Jigsaw project.
  list   Lists commands
  serve  Serve local site with php built-in server.

</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-17-internationalization_of_this_jigsaw_static_site</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-17-internationalization_of_this_jigsaw_static_site" />
    <title>Internationalization Of A Jigsaw Static Site</title>
    <published>2020-05-17T00:00:00+00:00</published>
    <updated>2020-05-17T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Alongside playing with code, i like to learn Portuguese. So i was wondering this morning the best way to make a Portuguese version of the site.

I would like a language switcher to swap between EN and PT at first. This would change the nav, footer and......</summary>
    <content type="html"><![CDATA[
        <p>Alongside playing with code, i like to learn Portuguese. So i was wondering this morning the best way to make a Portuguese version of the site.</p>

<p>I would like a language switcher to swap between EN and PT at first. This would change the nav, footer and buttons across the site. Perhaps there could be a posts_pt directory for tranlsated posts, which i would like to have auto-translated by some online gizmo (google)?</p>

<p>I wonder if this the way others have tackled this problem in the past.</p>

<p>Can javascript detect the locale? i need to search this next.</p>

<p>I have created an <a href="/about-pt/">/about_pt</a> page to experiment with this</p>

<p>https://lokalise.com/blog/localizing-apps-jquery/</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-17-blade</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-17-blade" />
    <title>Testing a blade.md template for a post</title>
    <published>2020-05-17T00:00:00+00:00</published>
    <updated>2020-05-17T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Trying to get a blade.md template to work as i expect....</summary>
    <content type="html"><![CDATA[
        
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-13-jigsaw-experiment</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-13-jigsaw-experiment" />
    <title>Jigsaw experiment with ~20,000 pages</title>
    <published>2020-05-13T00:00:00+00:00</published>
    <updated>2020-05-13T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I wanted to try and experiment to see how many pages i can make in jigsaw, how long it would take to build and also would the search take it.

My idea is to output markdown pages for the 20,000 private jets in my laravel54 package. i think it will be......</summary>
    <content type="html"><![CDATA[
        <p>I wanted to try and experiment to see how many pages i can make in jigsaw, how long it would take to build and also would the search take it.</p>

<p>My idea is to output markdown pages for the 20,000 private jets in my laravel54 package. i think it will be easiest to make a laravel command to output it, then copy them to the jigsaw _posts directory to build.</p>

<p>Will it be able to handle it?</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-09-jigsaw-ideas</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-09-jigsaw-ideas" />
    <title>Jigsaw Ideas</title>
    <published>2020-05-09T14:00:00+00:00</published>
    <updated>2020-05-09T14:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I am still enjoying jigsaw and have a couple of ideas to improve my site with it.



I really like the search provided out of the box with the jigsaw blog template. but I want to add the about page to the search.

The collection in the config.php file......</summary>
    <content type="html"><![CDATA[
        <p>I am still enjoying jigsaw and have a couple of ideas to improve my site with it.</p>

<h3>Adding about page to the search json</h3>

<p>I really like the search provided out of the box with the jigsaw blog template. but I want to add the about page to the search.</p>

<p>The collection in the config.php file needs to have the about page added.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-09-yesterday-i-cooked</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-09-yesterday-i-cooked" />
    <title>Yesterday I Cooked</title>
    <published>2020-05-09T00:00:00+00:00</published>
    <updated>2020-05-09T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Yesterday it was my turn to cook. I made a Focaccia. for lunch, a  2 pound loaf and a lemon maderia cake.

lunch was a smorgasbord of fresh salad with the nice focaccia.

Dinner was a large stir-fry of the first pak choi leaves with kale, chinese cabbage......</summary>
    <content type="html"><![CDATA[
        <p>Yesterday it was my turn to cook. I made a Focaccia. for lunch, a  2 pound loaf and a lemon maderia cake.</p>

<p>lunch was a smorgasbord of fresh salad with the nice focaccia.</p>

<p>Dinner was a large stir-fry of the first pak choi leaves with kale, chinese cabbage and mizuna.</p>

<p>It was all very nice</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-09-grr-duplicate-github-pages</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-09-grr-duplicate-github-pages" />
    <title>GRR, Duplicate Github Pages</title>
    <published>2020-05-09T00:00:00+00:00</published>
    <updated>2020-05-09T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">12.26pm

It took me all morning to fix this website deploy issue, there was an old old repo that was setup years ago as an experiment.

I deleted that repo and now it is working as expected....</summary>
    <content type="html"><![CDATA[
        <p>12.26pm</p>

<p>It took me all morning to fix this website deploy issue, there was an old old repo that was setup years ago as an experiment.</p>

<p>I deleted that repo and now it is working as expected.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-05-08-markdown</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-05-08-markdown" />
    <title>Markdown</title>
    <published>2020-05-08T00:00:00+00:00</published>
    <updated>2020-05-08T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">A list of examples of markdown in action...</summary>
    <content type="html"><![CDATA[
        <p>Markdown</p>

<p><a href="https://daringfireball.net/projects/markdown/syntax">Daring Fireball</a> The most comprehensive guide to markdown I have seen</p>

<p><a href="https://michelf.ca/projects/php-markdown/extra/#spe-attr">markdown extra</a></p>

<pre><code class="language-markdown"># Markdown syntax

https://guides.github.com/features/mastering-markdown/

**bold**

*italic*

Hello there `people`, how are you?

![Image of Angular](https://www.w3schools.com/angular/pic_angular.jpg)

[link to Google!](http://google.com)

&gt; Hello there people
&gt; How are you?

- [x] This is a complete item
- [ ] This is an incomplete item

Hello @damusix this is just some markdown examples!

emojis :sparkles: :camel: :boom:

https://www.webpagefx.com/tools/emoji-cheat-sheet/



# This is an `&lt;h1&gt;` tag
## This is an `&lt;h2&gt;` tag
###### This is an `&lt;h6&gt;` tag



*This text will be italic*
_This will also be italic_


**This text will be bold**
__This will also be bold__


_You **can** combine them_

###### Lists

* Item 1
* Item 2
  * Item 2a
  * Item 2b


1. Item 1
1. Item 2
1. Item 3
   1. Item 3a
   1. Item 3b


![An Image from this repo](/images/logo.png)
Format: ![Alt Text](url)


http://github.com - automatic!
[GitHub](http://github.com)





###### Checklists

- [x] @mentions, #refs, [links](google.com), **formatting**, and &lt;del&gt;del tags&lt;/del&gt; supported
- [x] list syntax required (any unordered or ordered list supported)
- [x] this is a complete item
- [ ] this is an incomplete item


###### Tables

First Header | Second Header
------------ | -------------
Content from cell 1 | Content from cell 2
Content in the first column | Content in the second column





Any URL (like http://www.github.com/) will be automatically converted into a clickable link.

Any word wrapped with two tildes (like ~~this~~) will appear crossed out.



###### numbered lists:

1. One
2. Two
3. Three

###### bullet points:

* Start a line with a star
* Profit!

###### dashes for lists

- Dashes work just as well
- And if you have sub points, put two spaces before the dash or star:
  - Like this
  - And this
</code></pre>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-04-30-laravel</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-04-30-laravel" />
    <title>Laravel</title>
    <published>2020-05-08T00:00:00+00:00</published>
    <updated>2020-05-08T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Laravel is a great PHP Framework which i have used for many years.

There are a number of Laravel projects I am enjoying using at the moment

Laravel Boilerplate

Laravel Auth

I am looking to create a dual language website in English and Portuguese to......</summary>
    <content type="html"><![CDATA[
        <p>Laravel is a great PHP Framework which i have used for many years.</p>

<p>There are a number of Laravel projects I am enjoying using at the moment</p>

<p><a href="https://github.com/rappasoft/laravel-boilerplate">Laravel Boilerplate</a></p>

<p><a href="https://github.com/jeremykenedy/laravel-auth/">Laravel Auth</a></p>

<p>I am looking to create a dual language website in English and Portuguese to help me learn portuguese and as a playground to learn about internationalization and multi-language websites.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-04-30</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-04-30" />
    <title>Cooking Day</title>
    <published>2020-04-30T00:00:00+00:00</published>
    <updated>2020-04-30T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Yesterday i made a tray of yeast following this recipe
WikiHow

This create 27 yeast blocks of around 0.6 ounces each. I left these drying
overnight and today i will make bread and freeze a load of these....</summary>
    <content type="html"><![CDATA[
        <p>Yesterday i made a tray of yeast following this recipe
<a href="https://www.wikihow.com/Create-Yeast-for-Baking">WikiHow</a></p>

<p>This create 27 yeast blocks of around 0.6 ounces each. I left these drying
overnight and today i will make bread and freeze a load of these.</p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-04-29</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-04-29" />
    <title>Jigsaw Templates</title>
    <published>2020-04-29T00:00:00+00:00</published>
    <updated>2020-04-29T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">Working on templates for this static site. The mix of markdown and HTML isnt
working.



[ ] Daily page - template for each day, with a shell script to create it

[ ] Code page - with examples of code blocks

[ ] Markdown Examples



[x] Build.sh - build......</summary>
    <content type="html"><![CDATA[
        <h3>7.35 am</h3>

<p>Working on templates for this static site. The mix of markdown and HTML isnt
working.</p>

<h4>Templates to make</h4>

<p>[ ] Daily page - template for each day, with a shell script to create it</p>

<p>[ ] Code page - with examples of code blocks</p>

<p>[ ] Markdown Examples</p>

<h4>Shell Scripts</h4>

<p>[x] Build.sh - build both the local and production sites</p>

<p>[ ] Deploy to github.io</p>

<p>[ ] Create daily post page</p>

<p><a href="https://allotmentandy.github.io/">AllotmentAndy.github.io</a></p>

<p><a href="https://www.github.com/allotmentandy">AllotmentAndy at Github</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-04-29-jigsaw-static-site-thoughts</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-04-29-jigsaw-static-site-thoughts" />
    <title>Jigsaw Static Site Thoughts</title>
    <published>2020-04-29T00:00:00+00:00</published>
    <updated>2020-04-29T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">I was looking for a project to help me do a few things. write a blog, store
reference material for things I am interested in, create a database of plants
I like to grow, learn about markdown &amp;amp; JSON and also expand my use of shell
scripts.

Having......</summary>
    <content type="html"><![CDATA[
        <p>I was looking for a project to help me do a few things. write a blog, store
reference material for things I am interested in, create a database of plants
I like to grow, learn about markdown &amp; JSON and also expand my use of shell
scripts.</p>

<p>Having been online for 25 years, I have gone from an all rounder managing CSS,
graphics, code and servers back to being an all rounder doing the same thing.
In the intervening years, I have worked with PHP, Codeigniter and now mainly
Laravel and have set up this system to allow me to entertain myself whilst
(re)learning CSS, Javascript, Markdown, JSON, Bash Scripting and Graphic
Design, something I have ignore for too long.</p>

<p>Having moved to using Debian Linux as my main daily machine, I have enjoyed
setting up a number of projects but wanted somewhere to combine and publish my
writing and experiments for all to see.</p>

<p>So although I had known about Jigsaw for years as a Laravel developer, i
recently took the plunge and installed it. I have tried a number of other
static site generators including Hugo and Jekyll but they didn't really click
with me for a number of reasons. Although I have 'played' with Ruby, Go and
Python, I tend to fall back to bash and PHP as the languages i like. I also
wanted something that wasn't huge, but powerful enough for me get stuff done
without a huge learning curve.</p>

<p>So Jigsaw uses the Laravel Blade syntax that I have used in many other
projects and comes with a neat quick start blog with a nifty search facility
from fuse.js which uses json. I created a site with a blog (_posts) and static
pages (_pages), but the search facility only indexed the blog. No problem, i
created a new collection in the generateIndex handle method and merged the 2
collections, then hey presto, it worked.</p>

<p>There are a number of features I liked 'out of the box' there was a RSS/ATOM
feed included. This is great as I am a big fan of the RSS feed concept.</p>

<p>The basic app also had a category system which I have included via an
autogenerated collection in the config file.</p>

<p>The Jigsaw blog system also uses Tailwind CSS, Webpack and Laravel Mix to
process the CSS and Js with the <code>npm run dev</code> and <code>npm run production</code>
commands.</p>

<p>I have really quite enjoyed the experience and will publish this all on
github.io and github.com/allotmentandy in the near future. Enjoying working
with CSS and next for the imagery.</p>

<p>Playing with the SVG image format is also on the to-do list.</p>

<h4>Observations</h4>

<p>[ ] fuse.js search json generator only takes the first 255 chars of the page
content.</p>

<p>[ ] the build process is very fast, taking about 0.2 seconds to build the
site.</p>

<p>[ ] Tailwind CSS is really nice once you get your head around it, it is like
CSS used to be.</p>

<p>[ ] I miss the 'php artisan' commands, i want a script to create a blog page
for today, with the date and time now, the filename i give it and a basic div.
like this <code>php artisan make:post 'title of post'</code> but i will make it in bash</p>

<p><a href="http://localhost:3000/blog/2020-04-29" title="Older Post: Templates, Markdown and
Shell Scripts for Jigsaw"> ← Templates, Markdown and Shell Scripts for Jigsaw
</a></p>
    ]]></content>
</entry>
            <entry>
    <id>https://allotmentandy.github.io/blog/2020-04-28-raining</id>
    <link type="text/html" rel="alternate" href="https://allotmentandy.github.io/blog/2020-04-28-raining" />
    <title>Rainy Day - Thoughts about Debian</title>
    <published>2020-04-28T00:00:00+00:00</published>
    <updated>2020-04-28T00:00:00+00:00</updated>
    <author>
        <name>Allotment Andy</name>
    </author>
    <summary type="html">8.15am in bed, it is raining, wondering what to do today.

I have been using Debian Linux for years, I guess about version 5. Recently I
found the 4.9 kernel caused the computer to lock / freeze completely, with an
upgrade to the 4.19 kernel even worse.......</summary>
    <content type="html"><![CDATA[
        <p>8.15am in bed, it is raining, wondering what to do today.</p>

<p>I have been using Debian Linux for years, I guess about version 5. Recently I
found the 4.9 kernel caused the computer to lock / freeze completely, with an
upgrade to the 4.19 kernel even worse. So I backed up my machine and installed
Debian testing! This fixed the freezing issue and the computer has not crashed
in weeks.</p>

<h2>Today i learnt</h2>

<p>to show all installed apps in debian with a description</p>

<pre><code>dpkg-query -l
</code></pre>

<h2>Jigsaw</h2>

<p>Building this website using the jigsaw static site, but as default the search
only worked for the _posts pages, so i added a new collection to the search
json and merged them together. now you can search all the pages. Must look
into the Fuse.js that is making it.</p>

<h3>Update - 23.05pm -</h3>

<p>Have had a good day, learning Markdown, Tailwind CSS, Jigsaw Static Site
development. Found some good docs on the internet to help me learn all this.</p>
    ]]></content>
</entry>
    </feed>
